{"version":3,"sources":["node_modules/browser-pack/_prelude.js","js/gui.js","js/jon-trombone.js","js/main.js","js/midi/midi-controller.js","js/midi/midi-drop-area.js","js/pink-trombone/components/audio-system.js","js/pink-trombone/components/glottis.js","js/pink-trombone/components/tract-ui.js","js/pink-trombone/components/tract.js","js/pink-trombone/math-extensions.js","js/pink-trombone/noise.js","js/pink-trombone/pink-trombone.js","js/utils/model-loader.js","js/utils/webgl-detect.js","node_modules/midiconvert/build/MidiConvert.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","GUI","controller","dat","console","warn","gui","jon","add","trombone","jonGUI","addFolder","listen","min","max","voiceGUI","AudioSystem","Glottis","tractGUI","Tract","step","TractUI","songGUI","midiController","_modelLoader","_pinkTrombone","_midiController","_midiDropArea","JonTrombone","container","_this","this","_classCallCheck","style","position","cursor","renderer","THREE","WebGLRenderer","alpha","setPixelRatio","window","devicePixelRatio","setSize","offsetWidth","offsetHeight","setClearColor","appendChild","domElement","aspect","camera","PerspectiveCamera","scene","Scene","clock","Clock","PinkTrombone","setTimeout","StartAudio","moveJaw","jawFlapSpeed","jawOpenOffset","MidiController","MidiDropArea","SetUpThree","SetUpScene","OnUpdate","undefined","OrbitControls","controls","target","set","update","_this2","light1","HemisphereLight","name","light2","DirectionalLight","ModelLoader","LoadJSON","object","rotation","y","Math","degToRad","jaw","skeleton","bones","find","obj","jawShutZ","z","getDelta","requestAnimationFrame","bind","playing","note","GetPitch","lastNote","loudness","SetLipsClosed","freq","MIDIToFrequency","midi","UIFrequency","time","getElapsedTime","percent","sin","render","_webglDetect","_jonTrombone","_gui","document","getElementById","Detector","HasWebGL","jonTrombone","Init","log","innerHTML","GetErrorHTML","classList","MidiConvert","currentTrack","baseFreq","path","callback","load","file","parse","trackIndex","arguments","GetSongProgress","tracks","notes","item","noteOn","noteOff","track","LoadSong","PlaySong","EnterSingMode","start","midiCode","pow","stop","ExitSingMode","oldAutoWobble","autoWobble","oldUseWhiteNoise","useWhiteNoise","oldVibratoFrequency","vibratoFrequency","oldFrequency","dropArea","createElement","top","left","width","height","MakeDroppable","files","reader","FileReader","onload","LoadSongDirect","result","readAsBinaryString","element","triggerCallback","dataTransfer","input","setAttribute","display","addEventListener","preventDefault","stopPropagation","remove","blockLength","blockTime","soundOn","AudioContext","webkitAudioContext","audioContext","sampleRate","scriptProcessor","createScriptProcessor","connect","destination","onaudioprocess","doScriptProcessor","whiteNoise","createWhiteNoiseNode","aspirateFilter","createBiquadFilter","type","frequency","value","Q","fricativeFilter","frameCount","myArrayBuffer","createBuffer","nowBuffering","getChannelData","random","source","createBufferSource","buffer","loop","event","inputArray1","inputBuffer","inputArray2","outArray","outputBuffer","j","N","lambda1","lambda2","glottalOutput","runStep","vocalOutput","lipOutput","noseOutput","finishBlock","disconnect","_noise","timeInWaveform","newFrequency","smoothFrequency","oldTenseness","newTenseness","UITenseness","totalTime","vibratoAmount","intensity","isTouched","touch","x","keyboardTop","keyboardLeft","keyboardWidth","keyboardHeight","semitones","marks","baseNote","output","setupWaveform","alive","UI","touchesWithMouse","local_y","local_x","clamp","semitone","cos","PI","lambda","noiseSource","timeStep","waveformLength","out","normalizedLFWaveform","aspiration","sqrt","getNoiseModulator","_noise2","default","simplex1","voiced","vibrato","alwaysVoice","tenseness","Rd","Ra","Rk","Rg","Ta","Tp","Te","epsilon","shift","exp","Delta","RHSIntegral","totalLowerIntegral","totalUpperIntegral","omega","E0","originX","originY","radius","scale","tongueIndex","tongueDiameter","innerTongueControlRadius","outerTongueControlRadius","tongueTouch","angleScale","angleOffset","noseOffset","gridOffset","index","setRestDiameter","diameter","targetDiameter","restDiameter","tongueLowerIndexBound","bladeStart","tongueUpperIndexBound","tipStart","tongueIndexCentre","xx","yy","angle","atan2","lipStart","fixedTongueDiameter","curve","progress","_i","interp","lerp","R","L","reflection","junctionOutputR","junctionOutputL","maxAmplitude","newDiameter","A","glottalReflection","lipReflection","lastObstruction","fade","movementSpeed","transients","velumTarget","floor","Float64Array","newReflection","noseLength","noseStart","noseR","noseL","noseJunctionOutputR","noseJunctionOutputL","noseReflection","noseDiameter","noseA","noseMaxAmplitude","d","newReflectionLeft","newReflectionRight","newReflectionNose","calculateReflections","calculateNoseReflections","deltaTime","amount","newLastObstruction","slowReturn","moveTowards","addTransient","reflectionLeft","reflectionRight","reflectionNose","sum","turbulenceNoise","updateAmplitudes","processTransients","addTurbulenceNoise","w","amplitude","abs","reshapeTract","trans","timeAlive","lifeTime","strength","exponent","push","splice","delta","thinness0","openness","noise0","noise1","number","current","amountUp","amountDown","gaussian","c","b","Grad","Noise","grad3","p","perm","Array","gradP","seed","Date","now","_seed","v","xin","yin","n0","n1","n2","i1","j1","F2","G2","x0","y0","x1","y1","x2","y2","gi0","gi1","gi2","t0","dot2","t1","t2","simplex2","singleton","Object","freeze","_audioSystem","_glottis","_tract","_tractUi","noiseFreq","noiseQ","init","muted","startSound","doMute","mute","unmute","SetMute","modelInfo","loadedCallback","onProgress","xhr","lengthComputable","percentComplete","loaded","total","round","onError","mtlLoader","MTLLoader","setPath","mtlFile","materials","preload","objLoader","OBJLoader","setMaterials","objFile","JSONLoader","geometry","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","skinning","err","return","mesh","SkinnedMesh","MultiMaterial","manager","LoadingManager","FBXLoader","WebGLRenderingContext","canvas","names","context","getContext","getParameter","message","define","amd","id","m","defineProperty","instrumentByPatchID","instrumentFamilyByID","Midi","decode","then","create","replace","bpm","PPQ","test","cbb","cb","c#","cx","dbb","db","d#","dx","ebb","eb","e#","ex","fbb","fb","f#","fx","gbb","gb","g","g#","gx","abb","ab","a#","ax","bbb","bb","b#","bx","exec","toLowerCase","parseInt","cleanName","ticksToSeconds","isString","isNumber","isPitch","midiToPitch","pitchToMidi","BinaryInsert","TypeError","enumerable","configurable","writable","key","prototype","2","4","5","7","8","10","64","65","66","67","68","84","get","hasOwnProperty","Control","header","ticksPerBeat","subtype","timeSignature","numerator","denominator","microsecondsPerBeat","parseHeader","filter","Uint32Array","Merge","__esModule","h","Promise","XMLHttpRequest","open","responseType","readyState","status","response","send","ArrayBuffer","Uint8Array","String","fromCharCode","apply","forEach","Track","text","noteNumber","velocity","controllerType","cc","instrument","patch","programNumber","File","ticks","addTrack","setTempo","encode","toBytes","charCodeAt","duration","map","slice","startTime","Note","controlChanges","instrumentNumber","match","findIndex","noteOns","addNoteOn","noteOffs","addNoteOff","indexOf","DEFAULT_VOLUME","DEFAULT_DURATION","DEFAULT_CHANNEL","midi_letter_pitches","midiPitchFromNote","substr","ensureMidiPitch","midi_pitches_letter","12","13","14","15","16","17","18","19","20","21","22","23","midi_flattened_notes","noteFromMidiPitch","mpqnFromBpm","unshift","bpmFromMpqn","codes2Str","str2Bytes","translateTickTime","channel","param1","setTime","setType","setChannel","setParam1","setParam2","param2","NOTE_OFF","NOTE_ON","AFTER_TOUCH","CONTROLLER","PROGRAM_CHANGE","CHANNEL_AFTERTOUCH","PITCH_BEND","setData","data","SEQUENCE","TEXT","COPYRIGHT","TRACK_NAME","INSTRUMENT","LYRIC","MARKER","CUE_POINT","CHANNEL_PREFIX","END_OF_TRACK","TEMPO","SMPTE","TIME_SIG","KEY_SIG","SEQ_EVENT","isArray","split","events","START_BYTES","END_BYTES","addEvent","addNote","addChord","chord","setInstrument","tempo","toString","concat","HDR_CHUNKID","HDR_CHUNK_SIZE","HDR_TYPE0","HDR_TYPE1","Util","Event","MetaEvent","read","readInt32","stream","readInt16","formatType","trackCount","eof","readVarInt","readInt8","frameRate","0","32","96","hour","sec","frame","subframe","metronome","thirtyseconds","webpackPolyfill","deprecate","paths","children"],"mappings":"CAAA,QAAAA,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAK,GAAA,GAAAC,OAAA,uBAAAN,EAAA,IAAA,MAAAK,GAAAE,KAAA,mBAAAF,EAAA,GAAAG,GAAAX,EAAAG,IAAAS,WAAAb,GAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,GAAAF,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAS,QAAA,IAAA,GAAAL,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAa,GAAA,SAAAT,EAAAU,EAAAJ,wZCCMK,gFAKUC,GACJ,GAAmB,mBAATC,KAEV,WADAC,SAAQC,KAAK,wDAIjB,IAAIC,GAAM,GAAIH,KAAIF,QAGdM,EAAML,CAEVI,GAAIE,IAAID,EAAIE,SAAU,aAEtB,IAAIC,GAASJ,EAAIK,UAAU,MAC3BD,GAAOF,IAAID,EAAK,WAAWK,SAC3BF,EAAOF,IAAID,EAAK,gBAAgBM,IAAI,GAAGC,IAAI,KAC3CJ,EAAOF,IAAID,EAAK,iBAAiBM,IAAI,GAAGC,IAAI,EAE5C,IAAIC,GAAWT,EAAIK,UAAU,QAC7BI,GAASP,IAAID,EAAIE,SAAU,cAC3BM,EAASP,IAAID,EAAIE,SAASO,YAAa,iBACvCD,EAASP,IAAID,EAAIE,SAASQ,QAAS,eAAeJ,IAAI,GAAGC,IAAI,GAC7DC,EAASP,IAAID,EAAIE,SAASQ,QAAS,iBAAiBJ,IAAI,GAAGC,IAAI,IAC/DC,EAASP,IAAID,EAAIE,SAASQ,QAAS,eAAeJ,IAAI,GAAGC,IAAI,KAC7DC,EAASP,IAAID,EAAIE,SAASQ,QAAS,YAAYJ,IAAI,GAAGC,IAAI,EAE1D,IAAII,GAAWZ,EAAIK,UAAU,QAC7BO,GAASV,IAAID,EAAIE,SAASU,MAAO,iBAAiBN,IAAI,GAAGC,IAAI,IAAIM,KAAK,GACtEF,EAASV,IAAID,EAAIE,SAASY,QAAS,UAAUR,IAAI,MAAOC,IAAI,GAC5DI,EAASV,IAAID,EAAIE,SAASY,QAAS,SAASR,IAAI,GAAGC,IAAI,IAAIM,KAAK,GAChEF,EAASV,IAAID,EAAIE,SAASY,QAAS,UAAUR,IAAI,GAAGC,IAAI,GAAGM,KAAK,EAEhE,IAAIE,GAAUhB,EAAIK,UAAU,OAC5BW,GAAQd,IAAID,EAAIgB,eAAgB,YAChCD,EAAQd,IAAID,EAAIgB,eAAgB,QAChCD,EAAQd,IAAID,EAAIgB,eAAgB,WAChCD,EAAQd,IAAID,EAAIgB,eAAgB,gBAAgBV,IAAI,GAAGC,IAAI,IAAIM,KAAK,GAAGR,SACvEU,EAAQd,IAAID,EAAIgB,eAAgB,YAAYV,IAAI,GAAGC,IAAI,gBAKtDb,IAAAA,ocChDTuB,EAAAlC,EAAA,2BACAmC,EAAAnC,EAAA,oCACAoC,EAAApC,EAAA,6BACAqC,EAAArC,EAAA,4BAEMsC,aAEF,QAAAA,GAAYC,GAAW,GAAAC,GAAAC,IAAAC,GAAAD,KAAAH,GACnBG,KAAKF,UAAYA,EACjBE,KAAKF,UAAUI,MAAMC,SAAW,WAChCH,KAAKF,UAAUI,MAAME,OAAS,UAG9BJ,KAAKK,SAAW,GAAIC,OAAMC,eAAiBC,OAAO,IAClDR,KAAKK,SAASI,cAAcC,OAAOC,kBACnCX,KAAKK,SAASO,QAAQZ,KAAKF,UAAUe,YAAab,KAAKF,UAAUgB,cACjEd,KAAKK,SAASU,cAAc,EAAU,GACtCf,KAAKF,UAAUkB,YAAYhB,KAAKK,SAASY,WAGzC,IAAIC,GAASlB,KAAKF,UAAUe,YAAcb,KAAKF,UAAUgB,YACzDd,MAAKmB,OAAS,GAAIb,OAAMc,kBAAmB,GAAIF,EAAQ,GAAK,KAC5DlB,KAAKqB,MAAQ,GAAIf,OAAMgB,MAMvBtB,KAAKuB,MAAQ,GAAIjB,OAAMkB,KAKvBxB,MAAKtB,SAAW,GAAAgB,GAAA+B,aAChBC,WAAW,WACP3B,EAAKrB,SAASiD,aACd5B,EAAK6B,SAAU,GAJA,KAiBnB5B,KAAK6B,aAAe,GACpB7B,KAAK8B,cAAgB,IACrB9B,KAAK4B,SAAU,EAEf5B,KAAKR,eAAiB,GAAAG,GAAAoC,eAAmB/B,KAC1B,IAAAJ,GAAAoC,aAAiBhC,KAIhCA,MAAKiC,aACLjC,KAAKkC,aAGLlC,KAAKmC,8DAOsBC,KAAxB9B,MAAM+B,eAELrC,KAAKsC,SAAW,GAAIhC,OAAM+B,cAAerC,KAAKmB,OAAQnB,KAAKK,SAASY,YACpEjB,KAAKsC,SAASC,OAAOC,IAAK,EAAG,EAAG,GAChCxC,KAAKsC,SAASG,UAEdpE,QAAQC,KAAK,sHAOR,GAAAoE,GAAA1C,IAGTA,MAAKmB,OAAOhB,SAASqC,IAAK,EAAG,EAAG,GAGhC,IAAIG,GAAS,GAAIrC,OAAMsC,gBAAgB,SAAU,QAAU,EAC3DD,GAAOE,KAAO,mBACdF,EAAOxC,SAASqC,IAAI,EAAG,EAAG,GAC1BxC,KAAKqB,MAAM5C,IAAIkE,EAEf,IAAIG,GAAS,GAAIxC,OAAMyC,iBAAiB,SAAU,EAClDD,GAAOD,KAAO,oBACdC,EAAO3C,SAASqC,IAAI,EAAG,EAAG,GAC1BxC,KAAKqB,MAAM5C,IAAIqE,GAGfrD,EAAAuD,YAAYC,SAAS,kCAAmC,SAACC,GACrDR,EAAKlE,IAAM0E,EACXR,EAAKrB,MAAM5C,IAAKiE,EAAKlE,KACrBkE,EAAKlE,IAAI2E,SAASC,EAAK9C,MAAM+C,KAAKC,SAAS,IAE3CZ,EAAKa,IAAMb,EAAKlE,IAAIgF,SAASC,MAAMC,KAAK,SAACC,GACrC,MAAmB,YAAZA,EAAId,OAEZH,EAAKa,MACJb,EAAKkB,SAAWlB,EAAKa,IAAIpD,SAAS0D,wCAW1B7D,KAAKuB,MAAMuC,UAG3B,IAFAC,sBAAuB/D,KAAKmC,SAAS6B,KAAKhE,OAEvCA,KAAKR,eAAeyE,QAAQ,CAE3B,GAAIC,GAAOlE,KAAKR,eAAe2E,UAC/B,IAAGD,GAAQlE,KAAKoE,SAAS,CAGrB,OAAYhC,KAAT8B,EAEClE,KAAKtB,SAASQ,QAAQmF,SAAW,EAEjCrE,KAAKuD,IAAIpD,SAAS0D,EAAI7D,KAAK4D,SAC3B5D,KAAKtB,SAASY,QAAQgF,cAAc,OACjC,CAEHtE,KAAKtB,SAASQ,QAAQmF,SAAW,CAEjC,IAAIE,GAAOvE,KAAKR,eAAegF,gBAAgBN,EAAKO,KAEpDzE,MAAKtB,SAASQ,QAAQwF,YAAcH,EAEpCvE,KAAKuD,IAAIpD,SAAS0D,EAAI7D,KAAK4D,SAAW5D,KAAK8B,cAC3C9B,KAAKtB,SAASY,QAAQgF,cAAc,GAGxCtE,KAAKoE,SAAWF,GAKxB,GAAGlE,KAAKuD,KAAOvD,KAAK4B,UAAY5B,KAAKR,eAAeyE,QAAQ,CACxD,GAAIU,GAAO3E,KAAKuB,MAAMqD,iBAGlBC,GAAWxB,KAAKyB,IAAIH,EAAO3E,KAAK6B,cAAgB,GAAO,CAC3D7B,MAAKuD,IAAIpD,SAAS0D,EAAI7D,KAAK4D,SAAYiB,EAAU7E,KAAK8B,cAGtD9B,KAAKtB,SAASY,QAAQgF,cAAc,EAAMO,GAI9C7E,KAAKK,SAAS0E,OAAO/E,KAAKqB,MAAOrB,KAAKmB,mBAKrCtB,YAAAA,mKCxKT,IAAAmF,GAAAzH,EAAA,2BACA0H,EAAA1H,EAAA,qBACA2H,EAAA3H,EAAA,YAMIuC,EAAYqF,SAASC,eAAe,yBAExC,IAAMJ,EAAAK,SAASC,WAMX,CACA,GAAIC,GAAc,GAAAN,GAAApF,YAAgBC,EAClCoF,GAAAhH,IAAIsH,KAAKD,OANTlH,SAAQoH,IAAI,2CACZ3F,EAAU4F,UAAYV,EAAAK,SAASM,eAC/B7F,EAAU8F,UAAUnH,IAAI,wfCdxBoH,EAActI,EAAQ,eAapBwE,aAEF,QAAAA,GAAY5D,GAAY8B,EAAAD,KAAA+B,GACpB/B,KAAK7B,WAAaA,EAElB6B,KAAKyE,KAAO,KAEZzE,KAAKiE,SAAU,EACfjE,KAAK8F,aAAe,EAEpB9F,KAAK+F,SAAW,IAEhB/F,KAAKuB,MAAQ,GAAIjB,OAAMkB,OAAM,8CAMxBwE,EAAMC,GAAS,GAAAlG,GAAAC,IACpBA,MAAKyE,KAAO,KACZoB,EAAYK,KAAKF,EAAM,SAACvB,GACpBpG,QAAQoH,IAAI,gBACZ1F,EAAK0E,KAAOA,EACZpG,QAAQoH,IAAI1F,EAAK0E,MACdwB,GAAUA,EAASxB,4CAIf0B,GACXnG,KAAKyE,KAAOoB,EAAYO,MAAMD,GAC9B9H,QAAQoH,IAAI,gBACZpH,QAAQoH,IAAIzF,KAAKyE,yCAMmB,GAA/B4B,GAA+BC,UAAAvI,OAAA,OAAAqE,KAAAkE,UAAA,GAAAA,UAAA,GAAlBtG,KAAK8F,aACnBnB,EAAO3E,KAAKuG,iBAMhB,OAHAF,GAAahD,KAAKvE,IAAIuH,EAAYrG,KAAKyE,KAAK+B,OAAOzI,OAAS,GAC5DsI,EAAahD,KAAKtE,IAAIsH,EAAY,GAE3BrG,KAAKyE,KAAK+B,OAAOH,GAAYI,MAAM/C,KAAK,SAACgD,GAC5C,MAAOA,GAAKC,QAAUhC,GAAQA,GAAQ+B,EAAKE,6CAIhC,GAAAlE,GAAA1C,KAAV6G,EAAUP,UAAAvI,OAAA,OAAAqE,KAAAkE,UAAA,GAAAA,UAAA,GAAF,CAGb,KAAItG,KAAKyE,KAKL,MAJApG,SAAQoH,IAAI,0BACZzF,MAAK8G,SAAS,wCAAyC,WACnDpE,EAAKqE,YAMb/G,MAAKgH,gBAELhH,KAAK8F,aAAee,EACpB7G,KAAKuB,MAAM0F,QACXjH,KAAKiE,SAAU,4CAKf,MAAOjE,MAAKuB,MAAMqD,yDAONsC,GACZ,MAAOlH,MAAK+F,SAAW1C,KAAK8D,IAAI,GAAID,EAAW,IAAM,sCAOrDlH,KAAKuB,MAAQ,GAAIjB,OAAMkB,qCAOvBxB,KAAKuB,MAAM6F,OACXpH,KAAKiE,SAAU,EACfjE,KAAKqH,uDAOLrH,KAAKsH,cAAgBtH,KAAK7B,WAAWO,SAAS6I,WAC9CvH,KAAK7B,WAAWO,SAAS6I,YAAa,EAEtCvH,KAAKwH,iBAAmBxH,KAAK7B,WAAWO,SAASO,YAAYwI,cAC7DzH,KAAK7B,WAAWO,SAASO,YAAYwI,eAAgB,EAErDzH,KAAK0H,oBAAsB1H,KAAK7B,WAAWO,SAASQ,QAAQyI,iBAC5D3H,KAAK7B,WAAWO,SAASQ,QAAQyI,iBAAmB,EAEpD3H,KAAK4H,aAAe5H,KAAK7B,WAAWO,SAASQ,QAAQwF,mDAOrD1E,KAAK7B,WAAWO,SAAS6I,WAAavH,KAAKsH,cAC3CtH,KAAK7B,WAAWO,SAASO,YAAYwI,cAAgBzH,KAAKwH,iBAC1DxH,KAAK7B,WAAWO,SAASQ,QAAQyI,iBAAmB3H,KAAK0H,oBACzD1H,KAAK7B,WAAWO,SAASQ,QAAQwF,YAAc1E,KAAK4H,wBAKnD7F,eAAAA,+bCtIIC,wBACT,QAAAA,GAAY7D,GAAW,GAAA4B,GAAAC,IAAAC,GAAAD,KAAAgC,GACnBhC,KAAK7B,WAAaA,EAElB6B,KAAK6H,SAAW1C,SAAS2C,cAAc,OAEvC9H,KAAK6H,SAAS3H,MAAMC,SAAW,WAC/BH,KAAK6H,SAAS3H,MAAM6H,IAAM,IAC1B/H,KAAK6H,SAAS3H,MAAM8H,KAAO,IAC3BhI,KAAK6H,SAAS3H,MAAM+H,MAAQ,OAC5BjI,KAAK6H,SAAS3H,MAAMgI,OAAS,OAE7BlI,KAAKmI,cAAcnI,KAAK6H,SAAU,SAACO,GAExC,GAAIC,GAAS,GAAIC,WACjBD,GAAOE,OAAS,SAACxL,GAChBgD,EAAK5B,WAAWqB,eAAegJ,eAAeH,EAAOI,SAEtDJ,EAAOK,mBAAmBN,EAAM,MAG3BpI,KAAK7B,WAAW2B,UAAUkB,YAAYhB,KAAK6H,uDAK3CxJ,QAAQoH,IAAI,kDAIFkD,EAAS1C,GAkCnB,QAAS2C,GAAgB7L,GACrB,GAAIqL,EACDrL,GAAE8L,aACLT,EAAQrL,EAAE8L,aAAaT,MACbrL,EAAEwF,SACZ6F,EAAQrL,EAAEwF,OAAO6F,OAEjBnC,EAASnI,KAAK,KAAMsK,GAvCxB,GAAIU,GAAQ3D,SAAS2C,cAAc,QACnCgB,GAAMC,aAAa,OAAQ,QAC3BD,EAAMC,aAAa,YAAY,GAC/BD,EAAM5I,MAAM8I,QAAU,OAEtBF,EAAMG,iBAAiB,SAAUL,GACjCD,EAAQ3H,YAAY8H,GAEpBH,EAAQM,iBAAiB,WAAY,SAASlM,GAC1CA,EAAEmM,iBACFnM,EAAEoM,kBACFR,EAAQ/C,UAAUnH,IAAI,cAG1BkK,EAAQM,iBAAiB,YAAa,SAASlM,GAC3CA,EAAEmM,iBACFnM,EAAEoM,kBACFR,EAAQ/C,UAAUwD,OAAO,cAG7BT,EAAQM,iBAAiB,OAAQ,SAASlM,GACtCA,EAAEmM,iBACFnM,EAAEoM,kBACFR,EAAQ/C,UAAUwD,OAAO,YACzBR,EAAgB7L,0YC5DtBkC,aAEF,QAAAA,GAAYP,GAAUuB,EAAAD,KAAAf,GAClBe,KAAKtB,SAAWA,EAEhBsB,KAAKqJ,YAAc,IACnBrJ,KAAKsJ,UAAY,EACjBtJ,KAAKuJ,SAAU,EAEfvJ,KAAKyH,eAAgB,2CAIrB/G,OAAO8I,aAAe9I,OAAO8I,cAAc9I,OAAO+I,mBAClDzJ,KAAK0J,aAAe,GAAIhJ,QAAO8I,aAC/BxJ,KAAKtB,SAASiL,WAAa3J,KAAK0J,aAAaC,WAE7C3J,KAAKsJ,UAAYtJ,KAAKqJ,YAAYrJ,KAAKtB,SAASiL,gDAKhD3J,KAAK4J,gBAAkB5J,KAAK0J,aAAaG,sBAAsB7J,KAAKqJ,YAAa,EAAG,GACpFrJ,KAAK4J,gBAAgBE,QAAQ9J,KAAK0J,aAAaK,aAC/C/J,KAAK4J,gBAAgBI,eAAiBhK,KAAKiK,kBAAkBjG,KAAKhE,KAElE,IAAIkK,GAAalK,KAAKmK,qBAAqB,EAAInK,KAAKtB,SAASiL,YAEzDS,EAAiBpK,KAAK0J,aAAaW,oBACvCD,GAAeE,KAAO,WACtBF,EAAeG,UAAUC,MAAQ,IACjCJ,EAAeK,EAAED,MAAQ,GACzBN,EAAWJ,QAAQM,GACnBA,EAAeN,QAAQ9J,KAAK4J,gBAE5B,IAAIc,GAAkB1K,KAAK0J,aAAaW,oBACxCK,GAAgBJ,KAAO,WACvBI,EAAgBH,UAAUC,MAAQ,IAClCE,EAAgBD,EAAED,MAAQ,GAC1BN,EAAWJ,QAAQY,GACnBA,EAAgBZ,QAAQ9J,KAAK4J,iBAE7BM,EAAWjD,MAAM,gDAQA0D,GAIjB,IAAK,GAHDC,GAAgB5K,KAAK0J,aAAamB,aAAa,EAAGF,EAAY3K,KAAKtB,SAASiL,YAE5EmB,EAAeF,EAAcG,eAAe,GACvCvN,EAAI,EAAGA,EAAImN,EAAYnN,IAE5BsN,EAAatN,GAAKwC,KAAKyH,cAAgBpE,KAAK2H,SAAW,CAG3D,IAAIC,GAASjL,KAAK0J,aAAawB,oBAI/B,OAHAD,GAAOE,OAASP,EAChBK,EAAOG,MAAO,EAEPH,4CAIOI,GAId,IAAK,GAHDC,GAAcD,EAAME,YAAYR,eAAe,GAC/CS,EAAcH,EAAME,YAAYR,eAAe,GAC/CU,EAAWJ,EAAMK,aAAaX,eAAe,GACxCY,EAAI,EAAGC,EAAIH,EAAS1N,OAAQ4N,EAAIC,EAAGD,IAC5C,CACI,GAAIE,GAAUF,EAAEC,EACZE,GAAWH,EAAE,IAAKC,EAClBG,EAAgB/L,KAAKtB,SAASQ,QAAQ8M,QAAQH,EAASP,EAAYK,IAEnEM,EAAc,CAElBjM,MAAKtB,SAASU,MAAM4M,QAAQD,EAAeP,EAAYG,GAAIE,GAC3DI,GAAejM,KAAKtB,SAASU,MAAM8M,UAAYlM,KAAKtB,SAASU,MAAM+M,WACnEnM,KAAKtB,SAASU,MAAM4M,QAAQD,EAAeP,EAAYG,GAAIG,GAC3DG,GAAejM,KAAKtB,SAASU,MAAM8M,UAAYlM,KAAKtB,SAASU,MAAM+M,WACnEV,EAASE,GAAmB,KAAdM,EAElBjM,KAAKtB,SAASQ,QAAQkN,cACtBpM,KAAKtB,SAASU,MAAMgN,6CAIpBpM,KAAK4J,gBAAgByC,8CAIrBrM,KAAK4J,gBAAgBE,QAAQ9J,KAAK0J,aAAaK,qBAKvDlM,GAAQoB,YAAcA,gcCnGtBqN,EAAA/O,EAAA,sEAEM2B,aAEF,QAAAA,GAAYR,GAAUuB,EAAAD,KAAAd,GAClBc,KAAKtB,SAAWA,EAEhBsB,KAAKuM,eAAiB,EACtBvM,KAAK4H,aAAe,IACpB5H,KAAKwM,aAAe,IACpBxM,KAAK0E,YAAc,IACnB1E,KAAKyM,gBAAkB,IACvBzM,KAAK0M,aAAe,GACpB1M,KAAK2M,aAAe,GACpB3M,KAAK4M,YAAc,GACnB5M,KAAK6M,UAAY,EACjB7M,KAAK8M,cAAgB,KACrB9M,KAAK2H,iBAAmB,EACxB3H,KAAK+M,UAAY,EACjB/M,KAAKqE,SAAW,EAChBrE,KAAKgN,WAAY,EACjBhN,KAAKiN,MAAQ,EACbjN,KAAKkN,EAAI,IACTlN,KAAKoD,EAAI,IAETpD,KAAKmN,YAAc,IACnBnN,KAAKoN,aAAe,EACpBpN,KAAKqN,cAAgB,IACrBrN,KAAKsN,eAAiB,IACtBtN,KAAKuN,UAAY,GACjBvN,KAAKwN,OAAS,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACxDxN,KAAKyN,SAAW,QAEhBzN,KAAK0N,gDAKL1N,KAAK2N,cAAc,2CAMnB,GAFkB,GAAd3N,KAAKiN,OAAejN,KAAKiN,MAAMW,QAAO5N,KAAKiN,MAAQ,GAErC,GAAdjN,KAAKiN,MAEL,IAAK,GAAItB,GAAE,EAAGA,EAAEkC,GAAGC,iBAAiB/P,OAAQ4N,IAC5C,CACI,GAAIsB,GAAQY,GAAGC,iBAAiBnC,EAC3BsB,GAAMW,QACPX,EAAM7J,EAAEpD,KAAKmN,cACjBnN,KAAKiN,MAAQA,IAIrB,GAAkB,GAAdjN,KAAKiN,MACT,CACI,GAAIc,GAAU/N,KAAKiN,MAAM7J,EAAKpD,KAAKmN,YAAY,GAC3Ca,EAAUhO,KAAKiN,MAAMC,EAAIlN,KAAKoN,YAClCW,GAAU1K,KAAK4K,MAAMF,EAAS,EAAG/N,KAAKsN,eAAe,GACrD,IAAIY,GAAWlO,KAAKuN,UAAYS,EAAUhO,KAAKqN,cAAgB,EAC/DnO,GAAQwF,YAAc1E,KAAKyN,SAAWpK,KAAK8D,IAAI,EAAG+G,EAAS,IAClC,GAArBhP,EAAQ6N,YAAgB7N,EAAQuN,gBAAkBvN,EAAQwF,YAE9D,IAAI1H,GAAIqG,KAAK4K,MAAM,EAAEF,GAAW/N,KAAKsN,eAAe,IAAK,EAAG,EAC5DpO,GAAQ0N,YAAc,EAAEvJ,KAAK8K,IAAInR,EAAEqG,KAAK+K,GAAG,IAC3ClP,EAAQmF,SAAWhB,KAAK8D,IAAIjI,EAAQ0N,YAAa,KACjD5M,KAAKkN,EAAIlN,KAAKiN,MAAMC,EACpBlN,KAAKoD,EAAI2K,EAAU/N,KAAKmN,YAAY,GAExCjO,EAAQ8N,UAA2B,GAAdhN,KAAKiN,sCAGtBoB,EAAQC,GACZ,GAAIC,GAAW,EAAMvO,KAAKtB,SAASiL,UACnC3J,MAAKuM,gBAAkBgC,EACvBvO,KAAK6M,WAAa0B,EACdvO,KAAKuM,eAAiBvM,KAAKwO,iBAE3BxO,KAAKuM,gBAAkBvM,KAAKwO,eAC5BxO,KAAK2N,cAAcU,GAEvB,IAAII,GAAMzO,KAAK0O,qBAAqB1O,KAAKuM,eAAevM,KAAKwO,gBACzDG,EAAa3O,KAAK+M,WAAW,EAAI1J,KAAKuL,KAAK5O,KAAK4M,cAAc5M,KAAK6O,oBAAoBP,CAG3F,OAFAK,IAAc,GAAM,IAAOG,EAAAC,QAAMC,SAA0B,KAAjBhP,KAAK6M,WAC/C4B,GAAOE,8CAKP,GAAIM,GAAS,GAAI,GAAI5L,KAAKtE,IAAI,EAAEsE,KAAKyB,IAAY,EAARzB,KAAK+K,GAAKpO,KAAKuM,eAAevM,KAAKwO,gBAE5E,OAAOxO,MAAK4M,YAAa5M,KAAK+M,UAAYkC,EAAiD,IAAvC,EAAEjP,KAAK4M,YAAa5M,KAAK+M,iDAI7E,GAAImC,GAAU,CACdA,IAAWlP,KAAK8M,cAAgBzJ,KAAKyB,IAAI,EAAEzB,KAAK+K,GAAKpO,KAAK6M,UAAW7M,KAAK2H,kBAC1EuH,GAAW,IAAOJ,EAAAC,QAAMC,SAA0B,KAAjBhP,KAAK6M,WACtCqC,GAAW,IAAOJ,EAAAC,QAAMC,SAA0B,KAAjBhP,KAAK6M,WAClC7M,KAAKtB,SAAS6I,aAEd2H,GAAW,GAAMJ,EAAAC,QAAMC,SAA0B,IAAjBhP,KAAK6M,WACrCqC,GAAW,GAAMJ,EAAAC,QAAMC,SAA0B,GAAjBhP,KAAK6M,YAErC7M,KAAK0E,YAAY1E,KAAKyM,kBACtBzM,KAAKyM,gBAAkBpJ,KAAKvE,IAA2B,IAAvBkB,KAAKyM,gBAAuBzM,KAAK0E,cACjE1E,KAAK0E,YAAY1E,KAAKyM,kBACtBzM,KAAKyM,gBAAkBpJ,KAAKtE,IAAIiB,KAAKyM,gBAAkB,IAAKzM,KAAK0E,cACrE1E,KAAK4H,aAAe5H,KAAKwM,aACzBxM,KAAKwM,aAAexM,KAAKyM,iBAAmB,EAAEyC,GAC9ClP,KAAK0M,aAAe1M,KAAK2M,aACzB3M,KAAK2M,aAAe3M,KAAK4M,YACnB,GAAIkC,EAAAC,QAAMC,SAAwB,IAAfhP,KAAK6M,WAAgB,IAAKiC,EAAAC,QAAMC,SAAwB,IAAfhP,KAAK6M,YAClE7M,KAAKgN,WAAahN,KAAKtB,SAASyQ,cAAanP,KAAK2M,eAAiB,EAAE3M,KAAK4M,cAAc,EAAE5M,KAAK+M,aAEhG/M,KAAKgN,WAAahN,KAAKtB,SAASyQ,eAChCnP,KAAK+M,WAAa,KAEtB/M,KAAK+M,UAAY1J,KAAK4K,MAAMjO,KAAK+M,UAAW,EAAG,yCAGrCsB,GACVrO,KAAKuK,UAAYvK,KAAK4H,cAAc,EAAEyG,GAAUrO,KAAKwM,aAAa6B,CAClE,IAAIe,GAAYpP,KAAK0M,cAAc,EAAE2B,GAAUrO,KAAK2M,aAAa0B,CACjErO,MAAKqP,GAAK,GAAG,EAAED,GACfpP,KAAKwO,eAAiB,EAAIxO,KAAKuK,SAE/B,IAAI8E,GAAKrP,KAAKqP,EACVA,GAAG,KAAKA,EAAK,IACbA,EAAG,MAAKA,EAAK,IAEjB,IAAIC,GAAa,KAAMD,EAAb,IACNE,EAAK,KAAQ,KAAMF,EACnBG,EAAMD,EAAG,GAAI,GAAI,IAAIA,IAAK,IAAKF,EAAGC,GAAI,GAAI,IAAIC,IAE9CE,EAAKH,EACLI,EAAK,GAAK,EAAEF,GACZG,EAAKD,EAAKA,EAAGH,EAEbK,EAAU,EAAEH,EACZI,EAAQxM,KAAKyM,KAAKF,GAAW,EAAED,IAC/BI,EAAQ,EAAIF,EAEZG,EAAe,EAAEJ,GAAUC,EAAQ,IAAM,EAAEF,GAAIE,CACnDG,IAA0BD,CAE1B,IAAIE,KAAwBN,EAAGD,GAAI,EAAIM,EACnCE,GAAsBD,EAEtBE,EAAQ9M,KAAK+K,GAAGsB,EAChBvS,EAAIkG,KAAKyB,IAAIqL,EAAMR,GACnBvM,GAAKC,KAAK+K,GAAGjR,EAAE+S,GAAyB,EAAHR,GACrC7L,EAAIR,KAAKoC,IAAIrC,GACb5C,EAAQqD,GAAG6L,EAAG,EAAIC,GAClBS,GAAM,GAAKjT,EAAEkG,KAAKyM,IAAItP,EAAMmP,GAChC3P,MAAKQ,MAAQA,EACbR,KAAKoQ,GAAKA,EACVpQ,KAAK4P,QAAUA,EACf5P,KAAK6P,MAAQA,EACb7P,KAAK+P,MAAQA,EACb/P,KAAK2P,GAAGA,EACR3P,KAAKmQ,MAAQA,+CAIInT,GAIjB,MAHIA,GAAEgD,KAAK2P,GAAI3P,KAAK0N,SAAWrK,KAAKyM,KAAK9P,KAAK4P,SAAW5S,EAAEgD,KAAK2P,KAAO3P,KAAK6P,OAAO7P,KAAK+P,MACnF/P,KAAK0N,OAAS1N,KAAKoQ,GAAK/M,KAAKyM,IAAI9P,KAAKQ,MAAMxD,GAAKqG,KAAKyB,IAAI9E,KAAKmQ,MAAQnT,GAErEgD,KAAK0N,OAAS1N,KAAK+M,UAAY/M,KAAKqE,oBAI1CnF,QAAAA,+bC9KHI,aAGF,QAAAA,GAAYZ,GAAUuB,EAAAD,KAAAV,GAClBU,KAAKtB,SAAWA,EAEhBsB,KAAKqQ,QAAU,IACfrQ,KAAKsQ,QAAU,IACftQ,KAAKuQ,OAAS,IACdvQ,KAAKwQ,MAAQ,GACbxQ,KAAKyQ,YAAc,KACnBzQ,KAAK0Q,eAAiB,KACtB1Q,KAAK2Q,yBAA2B,KAChC3Q,KAAK4Q,yBAA2B,IAChC5Q,KAAK6Q,YAAc,EACnB7Q,KAAK8Q,WAAa,IAClB9Q,KAAK+Q,aAAe,IACpB/Q,KAAKgR,WAAa,GAClBhR,KAAKiR,WAAa,IAGlBjR,KAAKuC,OAAS,GACdvC,KAAKkR,MAAQ,GACblR,KAAKuQ,OAAS,2CAId,GAAInR,GAAQY,KAAKtB,SAASU,KAE1BY,MAAKmR,iBACL,KAAK,GAAI3T,GAAE,EAAGA,EAAE4B,EAAMnC,EAAGO,IAErB4B,EAAMgS,SAAS5T,GAAK4B,EAAMiS,eAAe7T,GAAK4B,EAAMkS,aAAa9T,EAGrEwC,MAAKuR,sBAAwBnS,EAAMoS,WAAW,EAC9CxR,KAAKyR,sBAAwBrS,EAAMsS,SAAS,EAC5C1R,KAAK2R,kBAAoB,IAAK3R,KAAKuR,sBAAsBvR,KAAKyR,wDAGzDvE,EAAE9J,GAKP,IAJA,GAAIhE,GAAQY,KAAKtB,SAASU,MAEtBwS,EAAK1E,EAAElN,KAAKqQ,QAAawB,EAAKzO,EAAEpD,KAAKsQ,QACrCwB,EAAQzO,KAAK0O,MAAMF,EAAID,GACpBE,EAAO,GAAGA,GAAS,EAAEzO,KAAK+K,EACjC,QAAQ/K,KAAK+K,GAAK0D,EAAQ9R,KAAK+Q,cAAc3R,EAAM4S,SAAS,IAAMhS,KAAK8Q,WAAWzN,KAAK+K,wCAG/ElB,EAAE9J,GACV,GAAIwO,GAAK1E,EAAElN,KAAKqQ,QAAawB,EAAKzO,EAAEpD,KAAKsQ,OACzC,QAAQtQ,KAAKuQ,OAAOlN,KAAKuL,KAAKgD,EAAGA,EAAKC,EAAGA,IAAK7R,KAAKwQ,gDAMnD,IAAK,GAFDpR,GAAQY,KAAKtB,SAASU,MAEjB5B,EAAE4B,EAAMoS,WAAYhU,EAAE4B,EAAM4S,SAAUxU,IAC/C,CACI,GAAIR,GAAI,IAAMqG,KAAK+K,IAAIpO,KAAKyQ,YAAcjT,IAAI4B,EAAMsS,SAAWtS,EAAMoS,YACjES,EAAsB,GAAGjS,KAAK0Q,eAAe,GAAG,IAChDwB,GAAS,IAAID,EAAoBjS,KAAKiR,YAAY5N,KAAK8K,IAAInR,EAC3DQ,IAAK4B,EAAMoS,WAAW,GAAKhU,GAAK4B,EAAM4S,SAAS,IAAGE,GAAS,IAC3D1U,GAAK4B,EAAMoS,YAAchU,GAAK4B,EAAM4S,SAAS,IAAGE,GAAS,KAC7D9S,EAAMkS,aAAa9T,GAAK,IAAM0U,yCAQxBC,GAEV,GAAI/S,GAAQY,KAAKtB,SAASU,KAE1BY,MAAKmR,iBACL,KAAK,GAAI3T,GAAE,EAAGA,EAAE4B,EAAMnC,EAAGO,IAAK4B,EAAMiS,eAAe7T,GAAK4B,EAAMkS,aAAa9T,EAK3E,KAAI,GAAI4U,GAAGpS,KAAKkR,MAAQlR,KAAKuQ,OAAQ6B,GAAKpS,KAAKkR,MAAQlR,KAAKuQ,OAAQ6B,IAChE,KAAIA,EAAIhT,EAAMiS,eAAetT,QAAUqU,EAAI,GAA3C,CACA,GAAIC,GAAShP,KAAKiP,KAAKlT,EAAMkS,aAAac,GAAIpS,KAAKuC,OAAQ4P,EAC3D/S,GAAMiS,eAAee,GAAKC,cAO7B/S,QAAAA,+aC5FHF,aAEF,QAAAA,GAAYV,GAAUuB,EAAAD,KAAAZ,GAClBY,KAAKtB,SAAWA,EAEhBsB,KAAK/C,EAAI,GACT+C,KAAKwR,WAAa,GAClBxR,KAAK0R,SAAW,GAChB1R,KAAKgS,SAAW,GAChBhS,KAAKuS,KACLvS,KAAKwS,KACLxS,KAAKyS,cACLzS,KAAK0S,mBACL1S,KAAK2S,mBACL3S,KAAK4S,gBACL5S,KAAKoR,YACLpR,KAAKsR,gBACLtR,KAAKqR,kBACLrR,KAAK6S,eACL7S,KAAK8S,KACL9S,KAAK+S,kBAAoB,IACzB/S,KAAKgT,eAAiB,IACtBhT,KAAKiT,iBAAmB,EACxBjT,KAAKkT,KAAO,EACZlT,KAAKmT,cAAgB,GACrBnT,KAAKoT,cACLpT,KAAKkM,UAAY,EACjBlM,KAAKmM,WAAa,EAClBnM,KAAKqT,YAAc,6CAInBrT,KAAKwR,WAAanO,KAAKiQ,MAAMtT,KAAKwR,WAAWxR,KAAK/C,EAAE,IACpD+C,KAAK0R,SAAWrO,KAAKiQ,MAAMtT,KAAK0R,SAAS1R,KAAK/C,EAAE,IAChD+C,KAAKgS,SAAW3O,KAAKiQ,MAAMtT,KAAKgS,SAAShS,KAAK/C,EAAE,IAChD+C,KAAKoR,SAAW,GAAImC,cAAavT,KAAK/C,GACtC+C,KAAKsR,aAAe,GAAIiC,cAAavT,KAAK/C,GAC1C+C,KAAKqR,eAAiB,GAAIkC,cAAavT,KAAK/C,GAC5C+C,KAAK6S,YAAc,GAAIU,cAAavT,KAAK/C,EACzC,KAAK,GAAIO,GAAE,EAAGA,EAAEwC,KAAK/C,EAAGO,IACxB,CACI,GAAI4T,GAAW,CACQA,GAAnB5T,EAAE,EAAEwC,KAAK/C,EAAE,GAAG,GAAgB,GACzBO,EAAE,GAAGwC,KAAK/C,EAAE,GAAe,IACpB,IAChB+C,KAAKoR,SAAS5T,GAAKwC,KAAKsR,aAAa9T,GAAKwC,KAAKqR,eAAe7T,GAAKwC,KAAK6S,YAAYrV,GAAK4T,EAE7FpR,KAAKuS,EAAI,GAAIgB,cAAavT,KAAK/C,GAC/B+C,KAAKwS,EAAI,GAAIe,cAAavT,KAAK/C,GAC/B+C,KAAKyS,WAAa,GAAIc,cAAavT,KAAK/C,EAAE,GAC1C+C,KAAKwT,cAAgB,GAAID,cAAavT,KAAK/C,EAAE,GAC7C+C,KAAK0S,gBAAkB,GAAIa,cAAavT,KAAK/C,EAAE,GAC/C+C,KAAK2S,gBAAkB,GAAIY,cAAavT,KAAK/C,EAAE,GAC/C+C,KAAK8S,EAAG,GAAIS,cAAavT,KAAK/C,GAC9B+C,KAAK4S,aAAe,GAAIW,cAAavT,KAAK/C,GAE1C+C,KAAKyT,WAAapQ,KAAKiQ,MAAM,GAAGtT,KAAK/C,EAAE,IACvC+C,KAAK0T,UAAY1T,KAAK/C,EAAE+C,KAAKyT,WAAa,EAC1CzT,KAAK2T,MAAQ,GAAIJ,cAAavT,KAAKyT,YACnCzT,KAAK4T,MAAQ,GAAIL,cAAavT,KAAKyT,YACnCzT,KAAK6T,oBAAsB,GAAIN,cAAavT,KAAKyT,WAAW,GAC5DzT,KAAK8T,oBAAsB,GAAIP,cAAavT,KAAKyT,WAAW,GAC5DzT,KAAK+T,eAAiB,GAAIR,cAAavT,KAAKyT,WAAW,GACvDzT,KAAKgU,aAAe,GAAIT,cAAavT,KAAKyT,YAC1CzT,KAAKiU,MAAQ,GAAIV,cAAavT,KAAKyT,YACnCzT,KAAKkU,iBAAmB,GAAIX,cAAavT,KAAKyT,WAC9C,KAAK,GAAIjW,GAAE,EAAGA,EAAEwC,KAAKyT,WAAYjW,IACjC,CACI,GAAI4T,GACA+C,EAAO3W,EAAEwC,KAAKyT,WAAV,CACCrC,GAAL+C,EAAE,EAAc,GAAI,IAAIA,EACZ,GAAI,KAAK,EAAEA,GAC3B/C,EAAW/N,KAAKvE,IAAIsS,EAAU,KAC9BpR,KAAKgU,aAAaxW,GAAK4T,EAE3BpR,KAAKoU,kBAAoBpU,KAAKqU,mBAAqBrU,KAAKsU,kBAAoB,EAC5EtU,KAAKuU,uBACLvU,KAAKwU,2BACLxU,KAAKgU,aAAa,GAAKhU,KAAKqT,iDAGnBoB,GAGT,IAAK,GAFDC,GAASD,EAAYzU,KAAKmT,cAC1BwB,GAAsB,EACjBnX,EAAE,EAAGA,EAAEwC,KAAK/C,EAAGO,IACxB,CACI,GAAI4T,GAAWpR,KAAKoR,SAAS5T,GACzB6T,EAAiBrR,KAAKqR,eAAe7T,EACrC4T,IAAY,IAAGuD,EAAqBnX,EACxC,IAAIoX,EACkBA,GAAlBpX,EAAEwC,KAAK0T,UAAwB,GAC1BlW,GAAKwC,KAAK0R,SAAuB,EACxB,GAAI,IAAKlU,EAAEwC,KAAK0T,YAAY1T,KAAK0R,SAAS1R,KAAK0T,WACjE1T,KAAKoR,SAAS5T,GAAK6F,KAAKwR,YAAYzD,EAAUC,EAAgBuD,EAAWF,EAAQ,EAAEA,GAEnF1U,KAAKiT,iBAAiB,IAA4B,GAAvB0B,GAA4B3U,KAAKiU,MAAM,GAAG,KAErEjU,KAAK8U,aAAa9U,KAAKiT,iBAE3BjT,KAAKiT,gBAAkB0B,EAEvBD,EAASD,EAAYzU,KAAKmT,cAC1BnT,KAAKgU,aAAa,GAAK3Q,KAAKwR,YAAY7U,KAAKgU,aAAa,GAAIhU,KAAKqT,YACpD,IAAPqB,EAAoB,GAAPA,GACrB1U,KAAKiU,MAAM,GAAKjU,KAAKgU,aAAa,GAAGhU,KAAKgU,aAAa,kDAIvD,IAAK,GAAIxW,GAAE,EAAGA,EAAEwC,KAAK/C,EAAGO,IAEpBwC,KAAK8S,EAAEtV,GAAKwC,KAAKoR,SAAS5T,GAAGwC,KAAKoR,SAAS5T,EAE/C,KAAK,GAAIA,GAAE,EAAGA,EAAEwC,KAAK/C,EAAGO,IAEpBwC,KAAKyS,WAAWjV,GAAKwC,KAAKwT,cAAchW,GACvB,GAAbwC,KAAK8S,EAAEtV,GAASwC,KAAKwT,cAAchW,GAAK,KACvCwC,KAAKwT,cAAchW,IAAMwC,KAAK8S,EAAEtV,EAAE,GAAGwC,KAAK8S,EAAEtV,KAAOwC,KAAK8S,EAAEtV,EAAE,GAAGwC,KAAK8S,EAAEtV,GAK/EwC,MAAK+U,eAAiB/U,KAAKoU,kBAC3BpU,KAAKgV,gBAAkBhV,KAAKqU,mBAC5BrU,KAAKiV,eAAiBjV,KAAKsU,iBAC3B,IAAIY,GAAMlV,KAAK8S,EAAE9S,KAAK0T,WAAW1T,KAAK8S,EAAE9S,KAAK0T,UAAU,GAAG1T,KAAKiU,MAAM,EACrEjU,MAAKoU,mBAAqB,EAAEpU,KAAK8S,EAAE9S,KAAK0T,WAAWwB,GAAKA,EACxDlV,KAAKqU,oBAAsB,EAAErU,KAAK8S,EAAE9S,KAAK0T,UAAU,GAAGwB,GAAKA,EAC3DlV,KAAKsU,mBAAqB,EAAEtU,KAAKiU,MAAM,GAAGiB,GAAKA,qDAI/C,IAAK,GAAI1X,GAAE,EAAGA,EAAEwC,KAAKyT,WAAYjW,IAE7BwC,KAAKiU,MAAMzW,GAAKwC,KAAKgU,aAAaxW,GAAGwC,KAAKgU,aAAaxW,EAE3D,KAAK,GAAIA,GAAE,EAAGA,EAAEwC,KAAKyT,WAAYjW,IAE7BwC,KAAK+T,eAAevW,IAAMwC,KAAKiU,MAAMzW,EAAE,GAAGwC,KAAKiU,MAAMzW,KAAOwC,KAAKiU,MAAMzW,EAAE,GAAGwC,KAAKiU,MAAMzW,oCAIvFuO,EAAeoJ,EAAiB9G,GACpC,GAAI+G,GAAoB/R,KAAK2H,SAAS,EAGtChL,MAAKqV,oBACLrV,KAAKsV,mBAAmBH,GAGxBnV,KAAK0S,gBAAgB,GAAK1S,KAAKwS,EAAE,GAAKxS,KAAK+S,kBAAoBhH,EAC/D/L,KAAK2S,gBAAgB3S,KAAK/C,GAAK+C,KAAKuS,EAAEvS,KAAK/C,EAAE,GAAK+C,KAAKgT,aAEvD,KAAK,GAAIxV,GAAE,EAAGA,EAAEwC,KAAK/C,EAAGO,IACxB,CACI,GAAIN,GAAI8C,KAAKyS,WAAWjV,IAAM,EAAE6Q,GAAUrO,KAAKwT,cAAchW,GAAG6Q,EAC5DkH,EAAIrY,GAAK8C,KAAKuS,EAAE/U,EAAE,GAAKwC,KAAKwS,EAAEhV,GAClCwC,MAAK0S,gBAAgBlV,GAAKwC,KAAKuS,EAAE/U,EAAE,GAAK+X,EACxCvV,KAAK2S,gBAAgBnV,GAAKwC,KAAKwS,EAAEhV,GAAK+X,EAI1C,GAAI/X,GAAIwC,KAAK0T,UACTxW,EAAI8C,KAAKoU,mBAAqB,EAAE/F,GAAUrO,KAAK+U,eAAe1G,CAClErO,MAAK2S,gBAAgBnV,GAAKN,EAAE8C,KAAKuS,EAAE/U,EAAE,IAAI,EAAEN,IAAI8C,KAAK4T,MAAM,GAAG5T,KAAKwS,EAAEhV,IACpEN,EAAI8C,KAAKqU,oBAAsB,EAAEhG,GAAUrO,KAAKgV,gBAAgB3G,EAChErO,KAAK0S,gBAAgBlV,GAAKN,EAAE8C,KAAKwS,EAAEhV,IAAI,EAAEN,IAAI8C,KAAKuS,EAAE/U,EAAE,GAAGwC,KAAK4T,MAAM,IACpE1W,EAAI8C,KAAKsU,mBAAqB,EAAEjG,GAAUrO,KAAKiV,eAAe5G,EAC9DrO,KAAK6T,oBAAoB,GAAK3W,EAAE8C,KAAK4T,MAAM,IAAI,EAAE1W,IAAI8C,KAAKwS,EAAEhV,GAAGwC,KAAKuS,EAAE/U,EAAE,GAExE,KAAK,GAAIA,GAAE,EAAGA,EAAEwC,KAAK/C,EAAGO,IAQpB,GANAwC,KAAKuS,EAAE/U,GAA6B,KAAxBwC,KAAK0S,gBAAgBlV,GACjCwC,KAAKwS,EAAEhV,GAA+B,KAA1BwC,KAAK2S,gBAAgBnV,EAAE,GAK/B4X,EACJ,CACI,GAAII,GAAYnS,KAAKoS,IAAIzV,KAAKuS,EAAE/U,GAAGwC,KAAKwS,EAAEhV,GACtCgY,GAAYxV,KAAK4S,aAAapV,GAAIwC,KAAK4S,aAAapV,GAAKgY,EACxDxV,KAAK4S,aAAapV,IAAM,KAIrCwC,KAAKkM,UAAYlM,KAAKuS,EAAEvS,KAAK/C,EAAE,GAG/B+C,KAAK8T,oBAAoB9T,KAAKyT,YAAczT,KAAK2T,MAAM3T,KAAKyT,WAAW,GAAKzT,KAAKgT,aAEjF,KAAK,GAAIxV,GAAE,EAAGA,EAAEwC,KAAKyT,WAAYjW,IACjC,CACI,GAAI+X,GAAIvV,KAAK+T,eAAevW,IAAMwC,KAAK2T,MAAMnW,EAAE,GAAKwC,KAAK4T,MAAMpW,GAC/DwC,MAAK6T,oBAAoBrW,GAAKwC,KAAK2T,MAAMnW,EAAE,GAAK+X,EAChDvV,KAAK8T,oBAAoBtW,GAAKwC,KAAK4T,MAAMpW,GAAK+X,EAGlD,IAAK,GAAI/X,GAAE,EAAGA,EAAEwC,KAAKyT,WAAYjW,IAQ7B,GANAwC,KAAK2T,MAAMnW,GAAKwC,KAAK6T,oBAAoBrW,GAAKwC,KAAKkT,KACnDlT,KAAK4T,MAAMpW,GAAKwC,KAAK8T,oBAAoBtW,EAAE,GAAKwC,KAAKkT,KAKjDkC,EACJ,CACI,GAAII,GAAYnS,KAAKoS,IAAIzV,KAAK2T,MAAMnW,GAAGwC,KAAK4T,MAAMpW,GAC9CgY,GAAYxV,KAAKkU,iBAAiB1W,GAAIwC,KAAKkU,iBAAiB1W,GAAKgY,EAChExV,KAAKkU,iBAAiB1W,IAAM,KAIzCwC,KAAKmM,WAAanM,KAAK2T,MAAM3T,KAAKyT,WAAW,yCAK7CzT,KAAK0V,aAAa1V,KAAKtB,SAASO,YAAYqK,WAC5CtJ,KAAKuU,4DAGIpU,GACT,GAAIwV,KACJA,GAAMxV,SAAWA,EACjBwV,EAAMC,UAAY,EAClBD,EAAME,SAAW,GACjBF,EAAMG,SAAW,GACjBH,EAAMI,SAAW,IACjB/V,KAAKoT,WAAW4C,KAAKL,+CAIrB,IAAK,GAAInY,GAAI,EAAGA,EAAIwC,KAAKoT,WAAWrV,OAAQP,IAC5C,CACI,GAAImY,GAAQ3V,KAAKoT,WAAW5V,GACxBgY,EAAYG,EAAMG,SAAWzS,KAAK8D,IAAI,GAAIwO,EAAMI,SAAWJ,EAAMC,UACrE5V,MAAKuS,EAAEoD,EAAMxV,WAAaqV,EAAU,EACpCxV,KAAKwS,EAAEmD,EAAMxV,WAAaqV,EAAU,EACpCG,EAAMC,WAAa,GAA8B,EAAzB5V,KAAKtB,SAASiL,YAE1C,IAAK,GAAInM,GAAEwC,KAAKoT,WAAWrV,OAAO,EAAGP,GAAG,EAAGA,IAC3C,CACI,GAAImY,GAAQ3V,KAAKoT,WAAW5V,EACxBmY,GAAMC,UAAYD,EAAME,UAExB7V,KAAKoT,WAAW6C,OAAOzY,EAAE,+CAKlB2X,sDAYOA,EAAiBjE,EAAOE,GAC9C,GAAI5T,GAAI6F,KAAKiQ,MAAMpC,GACfgF,EAAQhF,EAAQ1T,CACpB2X,IAAmBnV,KAAKtB,SAASQ,QAAQ2P,mBACzC,IAAIsH,GAAY9S,KAAK4K,MAAM,GAAG,GAAImD,GAAU,EAAE,GAC1CgF,EAAW/S,KAAK4K,MAAM,IAAImD,EAAS,IAAM,EAAG,GAC5CiF,EAASlB,GAAiB,EAAEe,GAAOC,EAAUC,EAC7CE,EAASnB,EAAgBe,EAAMC,EAAUC,CAC7CpW,MAAKuS,EAAE/U,EAAE,IAAM6Y,EAAO,EACtBrW,KAAKwS,EAAEhV,EAAE,IAAM6Y,EAAO,EACtBrW,KAAKuS,EAAE/U,EAAE,IAAM8Y,EAAO,EACtBtW,KAAKwS,EAAEhV,EAAE,IAAM8Y,EAAO,aAIrBlX,MAAAA,uCCtRTiE,MAAK4K,MAAQ,SAASsI,EAAQzX,EAAKC,GAC/B,MAAIwX,GAAOzX,EAAYA,EACdyX,EAAOxX,EAAYA,EAChBwX,GAGhBlT,KAAKwR,YAAc,SAAS2B,EAASjU,EAAQmS,GACzC,MAAI8B,GAAQjU,EAAec,KAAKvE,IAAI0X,EAAQ9B,EAAQnS,GACxCc,KAAKtE,IAAIyX,EAAQ9B,EAAQnS,IAGzCc,KAAKwR,YAAc,SAAS2B,EAASjU,EAAQkU,EAAUC,GACnD,MAAIF,GAAQjU,EAAec,KAAKvE,IAAI0X,EAAQC,EAAUlU,GAC1Cc,KAAKtE,IAAIyX,EAAQE,EAAYnU,IAG7Cc,KAAKsT,SAAW,WAEZ,IAAK,GADDxZ,GAAI,EACCyZ,EAAE,EAAGA,EAAE,GAAIA,IAAKzZ,GAAGkG,KAAK2H,QACjC,QAAQ7N,EAAE,GAAG,GAGjBkG,KAAKiP,KAAO,SAAShV,EAAGuZ,EAAG7Z,GACvB,MAAOM,IAAKuZ,EAAIvZ,GAAKN,ibCPnB8Z,aACF,QAAAA,GAAY5J,EAAG9J,EAAGS,GAAE5D,EAAAD,KAAA8W,GAChB9W,KAAKkN,EAAIA,EACTlN,KAAKoD,EAAIA,EACTpD,KAAK6D,EAAIA,yCAGRqJ,EAAG9J,GACJ,MAAOpD,MAAKkN,EAAEA,EAAIlN,KAAKoD,EAAEA,+BAGxB8J,EAAG9J,EAAGS,GACP,MAAO7D,MAAKkN,EAAEA,EAAIlN,KAAKoD,EAAEA,EAAIpD,KAAK6D,EAAEA,WAItCkT,aACF,QAAAA,KAAc9W,EAAAD,KAAA+W,GACV/W,KAAKgX,OAAS,GAAIF,GAAK,EAAE,EAAE,GAAG,GAAIA,IAAM,EAAE,EAAE,GAAG,GAAIA,GAAK,GAAG,EAAE,GAAG,GAAIA,IAAM,GAAG,EAAE,GACjE,GAAIA,GAAK,EAAE,EAAE,GAAG,GAAIA,IAAM,EAAE,EAAE,GAAG,GAAIA,GAAK,EAAE,GAAG,GAAG,GAAIA,IAAM,EAAE,GAAG,GACjE,GAAIA,GAAK,EAAE,EAAE,GAAG,GAAIA,GAAK,GAAG,EAAE,GAAG,GAAIA,GAAK,EAAE,GAAG,GAAG,GAAIA,GAAK,GAAG,GAAG,IAC/E9W,KAAKiX,GAAK,IAAI,IAAI,IAAI,GAAG,GAAG,GACxB,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,EAAE,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,GACzE,IAAK,EAAE,IAAI,IAAI,IAAI,IAAI,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,GACzE,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,IAAK,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,GAAG,IACxE,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IACxE,IAAI,IAAI,GAAI,GAAG,GAAG,GAAG,IAAK,EAAE,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAK,GAAG,GAAG,IAAI,IAAI,IACxE,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAK,EAAE,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IACxE,EAAE,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,GACzE,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAK,EAAE,GAAG,IAAI,IAAK,GAAG,IAAI,IAAI,IAAI,IAAI,IAAK,GAAG,IAAI,EAC1E,IAAI,GAAG,GAAG,IAAK,GAAG,GAAG,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAK,IAAI,IAAI,IAAI,IAAI,GAAG,IACxE,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAK,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IACxE,GAAG,IAAI,IAAK,GAAG,IAAI,IAAI,IAAI,IAAI,IAAK,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAK,EAAE,IAAI,IACxE,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,KAGxEjX,KAAKkX,KAAO,GAAIC,OAAM,KACtBnX,KAAKoX,MAAQ,GAAID,OAAM,KAEvBnX,KAAKqX,KAAKC,KAAKC,8CAGdC,GACEA,EAAO,GAAKA,EAAO,IAElBA,GAAQ,QAGZA,EAAOnU,KAAKiQ,MAAMkE,IACR,MACNA,GAAQA,GAAQ,EAGpB,KAAI,GAAIha,GAAI,EAAGA,EAAI,IAAKA,IAAK,CACzB,GAAIia,EAEAA,GADI,EAAJja,EACIwC,KAAKiX,EAAEzZ,GAAa,IAAPga,EAEbxX,KAAKiX,EAAEzZ,GAAOga,GAAM,EAAK,IAGjCxX,KAAKkX,KAAK1Z,GAAKwC,KAAKkX,KAAK1Z,EAAI,KAAOia,EACpCzX,KAAKoX,MAAM5Z,GAAKwC,KAAKoX,MAAM5Z,EAAI,KAAOwC,KAAKgX,MAAMS,EAAI,sCAKpDC,EAAKC,GAEV,GAMIC,GAAIC,EAAIC,EAURC,EAAIC,EAhBJC,EAAK,IAAK5U,KAAKuL,KAAK,GAAG,GACvBsJ,GAAM,EAAE7U,KAAKuL,KAAK,IAAI,EAOtBzR,GAAKua,EAAIC,GAAKM,EACdza,EAAI6F,KAAKiQ,MAAMoE,EAAIva,GACnBwO,EAAItI,KAAKiQ,MAAMqE,EAAIxa,GACnBH,GAAKQ,EAAEmO,GAAGuM,EACVC,EAAKT,EAAIla,EAAER,EACXob,EAAKT,EAAIhM,EAAE3O,CAIZmb,GAAGC,GACFL,EAAG,EAAGC,EAAG,IAETD,EAAG,EAAGC,EAAG,EAKb,IAAIK,GAAKF,EAAKJ,EAAKG,EACfI,EAAKF,EAAKJ,EAAKE,EACfK,EAAKJ,EAAK,EAAI,EAAID,EAClBM,EAAKJ,EAAK,EAAI,EAAIF,CAEtB1a,IAAK,IACLmO,GAAK,GACL,IAAI8M,GAAMzY,KAAKoX,MAAM5Z,EAAEwC,KAAKkX,KAAKvL,IAC7B+M,EAAM1Y,KAAKoX,MAAM5Z,EAAEua,EAAG/X,KAAKkX,KAAKvL,EAAEqM,IAClCW,EAAM3Y,KAAKoX,MAAM5Z,EAAE,EAAEwC,KAAKkX,KAAKvL,EAAE,IAEjCiN,EAAK,GAAMT,EAAGA,EAAGC,EAAGA,CACrBQ,GAAG,EACFhB,EAAK,GAELgB,GAAMA,EACNhB,EAAKgB,EAAKA,EAAKH,EAAII,KAAKV,EAAIC,GAEhC,IAAIU,GAAK,GAAMT,EAAGA,EAAGC,EAAGA,CACrBQ,GAAG,EACFjB,EAAK,GAELiB,GAAMA,EACNjB,EAAKiB,EAAKA,EAAKJ,EAAIG,KAAKR,EAAIC,GAEhC,IAAIS,GAAK,GAAMR,EAAGA,EAAGC,EAAGA,CASxB,OARGO,GAAG,EACFjB,EAAK,GAELiB,GAAMA,EACNjB,EAAKiB,EAAKA,EAAKJ,EAAIE,KAAKN,EAAIC,IAIzB,IAAMZ,EAAKC,EAAKC,oCAGlB5K,GACL,MAAOlN,MAAKgZ,SAAW,IAAF9L,EAAU,IAAFA,YAK/B+L,EAAY,GAAIlC,EACtBmC,QAAOC,OAAOF,aAECA,qcC5Jf1b,GAAA,uBAEA,IAAA6b,GAAA7b,EAAA,gCACA8b,EAAA9b,EAAA,2BACA+b,EAAA/b,EAAA,yBACAgc,EAAAhc,EAAA,4BAEMkE,aACF,QAAAA,KAAaxB,EAAAD,KAAAyB,GAETzB,KAAK2J,WAAa,EAClB3J,KAAK2E,KAAO,EACZ3E,KAAKmP,aAAc,EACnBnP,KAAKuH,YAAa,EAClBvH,KAAKwZ,UAAY,IACjBxZ,KAAKyZ,OAAS,GAEdzZ,KAAKf,YAAc,GAAAma,GAAAna,YAAgBe,MACnCA,KAAKf,YAAYya,OAEjB1Z,KAAKd,QAAU,GAAAma,GAAAna,QAAYc,MAC3BA,KAAKd,QAAQwa,OAEb1Z,KAAKZ,MAAQ,GAAAka,GAAAla,MAAUY,MACvBA,KAAKZ,MAAMsa,OAEX1Z,KAAKV,QAAU,GAAAia,GAAAja,QAAYU,MAC3BA,KAAKV,QAAQoa,sDAOb1Z,KAAK2Z,OAAQ,EACb3Z,KAAKf,YAAY2a,6CAGbC,GACJA,EAAS7Z,KAAKf,YAAY6a,OAAS9Z,KAAKf,YAAY8a,SACpD/Z,KAAK2Z,MAAQE,uCAIb7Z,KAAKga,SAASha,KAAK2Z,kBAKlBlY,aAAAA,6jBCjDHuB,mFAcaiX,EAAWC,GAEtB,GAAIC,GAAa,SAAUC,GACvB,GAAKA,EAAIC,iBAAmB,CACxB,GAAIC,GAAkBF,EAAIG,OAASH,EAAII,MAAQ,GAC/Cnc,SAAQoH,IAAKpC,KAAKoX,MAAOH,EAAiB,GAAM,kBAGpDI,EAAU,SAAUN,KAGpBO,EAAY,GAAIra,OAAMsa,SAC1BD,GAAUE,QAASZ,EAAUjU,MAE7B2U,EAAUzU,KAAM+T,EAAUa,QAAS,SAAEC,GACjCA,EAAUC,SACV,IAAIC,GAAY,GAAI3a,OAAM4a,SAC1BD,GAAUE,aAAcJ,GACxBE,EAAUJ,QAASZ,EAAUjU,MAC7BiV,EAAU/U,KAAM+T,EAAUmB,QAAS,SAAElY,GACjCgX,EAAehX,IAChBiX,EAAYO,sCAMP1U,EAAMkU,GAElB,GAAIC,GAAa,SAAUC,GACvB,GAAKA,EAAIC,iBAAmB,CACxB,GAAIC,GAAkBF,EAAIG,OAASH,EAAII,MAAQ,GAC/Cnc,SAAQoH,IAAKpC,KAAKoX,MAAOH,EAAiB,GAAM,kBAGpDI,EAAU,SAAUN,MAGX,GAAI9Z,OAAM+a,YAChBnV,KAAMF,EAAM,SAAEsV,EAAUP,GAAe,GAAAQ,IAAA,EAAAC,GAAA,EAAAC,MAAArZ,EAAA,KAE1C,IAAA,GAAAsZ,GAAAC,EAAeZ,EAAfa,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAyBG,EAAAlR,MACjBwR,UAAW,EAHuB,MAAAC,GAAAT,GAAA,EAAAC,EAAAQ,EAAA,QAAA,KAAAV,GAAAI,EAAAO,QAAAP,EAAAO,SAAA,QAAA,GAAAV,EAAA,KAAAC,IAK1C,GAAIU,GAAO,GAAI7b,OAAM8b,YAAad,EAAU,GAAIhb,OAAM+b,cAAetB,GACrEoB,GAAKtZ,KAAO,MACZqX,EAAeiC,IAChBhC,EAAYO,mCAGJ1U,EAAMkU,GACjB,GAAIoC,GAAU,GAAIhc,OAAMic,cACxBD,GAAQnC,WAAa,SAAUzT,EAAM6T,EAAQC,GACzCnc,QAAQoH,IAAKiB,EAAM6T,EAAQC,GAG/B,IAAIL,GAAa,SAAUC,GACvB,GAAKA,EAAIC,iBAAmB,CACxB,GAAIC,GAAkBF,EAAIG,OAASH,EAAII,MAAQ,GAC/Cnc,SAAQoH,IAAKpC,KAAKoX,MAAOH,EAAiB,GAAM,kBAGpDI,EAAU,SAAUN,IAGX,IAAI9Z,OAAMkc,UAAWF,GAC3BpW,KAAMF,EAAM,SAAE9C,GACjBgX,EAAehX,IAChBiX,EAAYO,cAKd1X,YAAAA;0PCvFHqC,sFAIE,GAAM3E,OAAO+b,sBAAuB,CAKhC,IAAI,GAJAC,GAASvX,SAAS2C,cAAc,UAC5B6U,GAAS,QAAS,qBAAsB,YAAa,aACzDC,GAAU,EAENpf,EAAE,EAAEA,EAAE,EAAEA,IACZ,IAEI,IADAof,EAAUF,EAAOG,WAAWF,EAAMnf,MACY,kBAAxBof,GAAQE,aAE1B,OAAO,EAEb,MAAM/f,IAIZ,OAAO,EAGX,OAAO,yCAGwB,GAAfggB,GAAezW,UAAAvI,OAAA,OAAAqE,KAAAkE,UAAA,GAAAA,UAAA,GAAL,IAM1B,OALc,OAAXyW,IACCA,EAAA,0PAIJ,oFAEiCA,EAFjC,4CASC1X,SAAAA,4BCzCT,SAAArI,EAAAD,GAAA,gBAAAc,IAAA,gBAAAI,GAAAA,EAAAJ,QAAAd,IAAA,kBAAAigB,SAAAA,OAAAC,IAAAD,UAAAjgB,GAAA,gBAAAc,GAAAA,EAAAgI,YAAA9I,IAAAC,EAAA6I,YAAA9I,KAAAiD,KAAA,WAAA,MAAA,UAAAhD,GAAA,QAAAD,GAAAG,GAAA,GAAAD,EAAAC,GAAA,MAAAD,GAAAC,GAAAW,OAAA,IAAAL,GAAAP,EAAAC,IAAAW,WAAAqf,GAAAhgB,EAAAqd,QAAA,EAAA,OAAAvd,GAAAE,GAAAY,KAAAN,EAAAK,QAAAL,EAAAA,EAAAK,QAAAd,GAAAS,EAAA+c,QAAA,EAAA/c,EAAAK,QAAA,GAAAZ,KAAA,OAAAF,GAAAogB,EAAAngB,EAAAD,EAAA6Z,EAAA3Z,EAAAF,EAAAka,EAAA,GAAAla,EAAA,KAAA,SAAAC,EAAAD,EAAAE,GAAA,YAAAic,QAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,GAAA,IAAAtN,GAAAD,EAAA,GAAAO,EAAAP,EAAA,GAAAK,GAAA+f,oBAAA7f,EAAA6f,oBAAAC,qBAAA9f,EAAA8f,qBAAAlX,MAAA,SAAApJ,GAAA,OAAA,GAAAE,GAAAqgB,MAAAC,OAAAxgB,IAAAkJ,KAAA,SAAAlJ,EAAAD,GAAA,GAAAE,IAAA,GAAAC,GAAAqgB,MAAArX,KAAAlJ,EAAA,OAAAD,IAAAE,EAAAwgB,KAAA1gB,GAAAE,GAAAygB,OAAA,WAAA,MAAA,IAAAxgB,GAAAqgB,MAAAxgB,GAAA,QAAAO,EAAAN,EAAAa,QAAAP,GAAA,SAAAN,EAAAD,GAAA,YAAA,SAAAE,GAAAD,GAAA,MAAAA,GAAA2gB,QAAA,UAAA,IAAA,QAAAzgB,GAAAF,EAAAD,GAAA,MAAA,IAAAA,EAAA6gB,KAAA5gB,EAAAD,EAAA8gB,KAAA,QAAArgB,GAAAR,GAAA,MAAA,gBAAAA,GAAA,QAAAM,GAAAN,GAAA,MAAA,gBAAAA,GAAA,QAAAI,GAAAJ,GAAA,OAAA,IAAA,KAAA,IAAA,KAAA,IAAA,IAAA,KAAA,IAAA,KAAA,IAAA,KAAA,KAAAA,EAAA,KAAAqG,KAAAiQ,MAAAtW,EAAA,IAAA,GAAA,GAAAG,GAAA,WAAA,GAAAH,GAAA,qCAAA,OAAA,UAAAD,GAAA,MAAAO,GAAAP,IAAAC,EAAA8gB,KAAA/gB,OAAAM,EAAA,WAAA,GAAAL,GAAA,sCAAAD,GAAAghB,KAAA,EAAAC,IAAA,EAAApH,EAAA,EAAAqH,KAAA,EAAAC,GAAA,EAAAC,IAAA,EAAAC,GAAA,EAAAjK,EAAA,EAAAkK,KAAA,EAAAC,GAAA,EAAAC,IAAA,EAAAC,GAAA,EAAAzhB,EAAA,EAAA0hB,KAAA,EAAAC,GAAA,EAAAC,IAAA,EAAAC,GAAA,EAAAnhB,EAAA,EAAAohB,KAAA,EAAAC,GAAA,EAAAC,IAAA,EAAAC,GAAA,EAAAC,EAAA,EAAAC,KAAA,EAAAC,GAAA,EAAAC,IAAA,EAAAC,GAAA,EAAA/hB,EAAA,EAAAgiB,KAAA,GAAAC,GAAA,GAAAC,IAAA,EAAAC,GAAA,GAAA5I,EAAA,GAAA6I,KAAA,GAAAC,GAAA,GAAA,OAAA,UAAA1iB,GAAA,GAAAC,GAAAF,EAAA4iB,KAAA3iB,GAAAO,EAAAN,EAAA,GAAAI,EAAAJ,EAAA,EAAA,OAAAH,GAAAS,EAAAqiB,eAAA,IAAAC,SAAAxiB,GAAA,MAAAN,GAAAa,SAAAkiB,UAAA9iB,EAAA+iB,eAAA9iB,EAAA+iB,SAAA3iB,EAAA4iB,SAAA1iB,EAAA2iB,QAAAhjB,EAAAijB,YAAAhjB,EAAAijB,YAAAhjB,IAAA,SAAAL,EAAAD,GAAA,YAAAmc,QAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,IAAAzN,EAAAsgB,qBAAA,uBAAA,wBAAA,uBAAA,mBAAA,mBAAA,mBAAA,cAAA,QAAA,UAAA,eAAA,YAAA,aAAA,UAAA,YAAA,gBAAA,WAAA,gBAAA,mBAAA,aAAA,eAAA,aAAA,YAAA,YAAA,kBAAA,0BAAA,0BAAA,yBAAA,0BAAA,0BAAA,oBAAA,oBAAA,mBAAA,gBAAA,yBAAA,uBAAA,gBAAA,cAAA,cAAA,eAAA,eAAA,SAAA,QAAA,QAAA,aAAA,kBAAA,oBAAA,kBAAA,UAAA,oBAAA,oBAAA,iBAAA,iBAAA,aAAA,aAAA,cAAA,gBAAA,UAAA,WAAA,OAAA,gBAAA,cAAA,gBAAA,eAAA,eAAA,cAAA,WAAA,YAAA,eAAA,OAAA,eAAA,UAAA,WAAA,UAAA,QAAA,WAAA,YAAA,eAAA,aAAA,UAAA,UAAA,kBAAA,oBAAA,oBAAA,iBAAA,mBAAA,iBAAA,kBAAA,uBAAA,kBAAA,eAAA,oBAAA,gBAAA,gBAAA,mBAAA,eAAA,gBAAA,cAAA,oBAAA,iBAAA,oBAAA,oBAAA,iBAAA,gBAAA,gBAAA,QAAA,QAAA,WAAA,OAAA,UAAA,WAAA,SAAA,SAAA,cAAA,QAAA,cAAA,YAAA,aAAA,cAAA,aAAA,iBAAA,oBAAA,eAAA,WAAA,aAAA,iBAAA,aAAA,WAAA,WAAAtgB,EAAAugB,sBAAA,QAAA,uBAAA,QAAA,SAAA,OAAA,UAAA,WAAA,QAAA,OAAA,OAAA,aAAA,YAAA,gBAAA,SAAA,aAAA,kBAAA,SAAAtgB,EAAAD,GAAA,YAAA,SAAAE,GAAAD,EAAAD,GAAA,GAAAE,GAAA,EAAAC,EAAAF,EAAAe,OAAAP,EAAAN,CAAA,IAAAA,EAAA,GAAAF,EAAAE,EAAA,GAAAyH,MAAA5H,EAAA,MAAAG,GAAA,CAAA,MAAAM,EAAAP,GAAA,CAAA,GAAAK,GAAA+F,KAAAiQ,MAAArW,GAAAO,EAAAP,GAAA,GAAAG,EAAAJ,EAAAM,GAAAH,EAAAH,EAAAM,EAAA,EAAA,IAAAF,EAAAuH,OAAA5H,EAAA,CAAA,IAAA,GAAAM,GAAAC,EAAAD,EAAAL,EAAAe,OAAAV,IAAA,CAAAL,EAAAK,GAAAsH,OAAA5H,IAAAO,EAAAD,GAAA,MAAAC,GAAA,GAAAF,EAAAuH,KAAA5H,GAAAI,EAAAwH,KAAA5H,EAAA,MAAAO,EAAAF,GAAAuH,KAAA5H,EAAAS,EAAAF,EAAAF,EAAAuH,KAAA5H,IAAAE,EAAAK,EAAA,GAAA,OAAA,EAAA,QAAAJ,GAAAF,EAAAD,GAAA,GAAAC,EAAAe,OAAA,CAAA,GAAAb,GAAAD,EAAAD,EAAAD,EAAA4H,KAAA3H,GAAAiZ,OAAA/Y,EAAA,EAAA,EAAAH,OAAAC,GAAAgZ,KAAAjZ,GAAAmc,OAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,IAAAzN,EAAAujB,aAAApjB,GAAA,SAAAF,EAAAD,GAAA,YAAA,SAAAE,GAAAD,EAAAD,GAAA,KAAAC,YAAAD,IAAA,KAAA,IAAAwjB,WAAA,qCAAArH,OAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,GAAA,IAAAtN,GAAA,WAAA,QAAAF,GAAAA,EAAAD,GAAA,IAAA,GAAAE,GAAA,EAAAA,EAAAF,EAAAgB,OAAAd,IAAA,CAAA,GAAAC,GAAAH,EAAAE,EAAAC,GAAAsjB,WAAAtjB,EAAAsjB,aAAA,EAAAtjB,EAAAujB,cAAA,EAAA,SAAAvjB,KAAAA,EAAAwjB,UAAA,GAAAxH,OAAAkE,eAAApgB,EAAAE,EAAAyjB,IAAAzjB,IAAA,MAAA,UAAAH,EAAAE,EAAAC,GAAA,MAAAD,IAAAD,EAAAD,EAAA6jB,UAAA3jB,GAAAC,GAAAF,EAAAD,EAAAG,GAAAH,MAAAS,GAAAQ,EAAA,kBAAA6iB,EAAA,SAAAC,EAAA,iBAAAC,EAAA,iBAAAC,EAAA,SAAAC,EAAA,UAAAC,GAAA,MAAAC,GAAA,UAAAC,GAAA,iBAAAC,GAAA,YAAAC,GAAA,YAAAC,GAAA,mBAAAC,GAAA,oBAAAlkB,EAAA,WAAA,QAAAN,GAAAD,EAAAG,EAAAM,GAAAP,EAAA+C,KAAAhD,GAAAgD,KAAAuW,OAAAxZ,EAAAiD,KAAA2E,KAAAzH,EAAA8C,KAAAwK,MAAAhN,EAAA,MAAAN,GAAAF,IAAA2jB,IAAA,OAAAc,IAAA,WAAA,MAAAjkB,GAAAkkB,eAAA1hB,KAAAuW,QAAA/Y,EAAAwC,KAAAuW,YAAA,OAAAvZ,IAAAD,GAAA4kB,QAAArkB,GAAA,SAAAN,EAAAD,GAAA,YAAA,SAAAE,GAAAD,GAAA,IAAA,GAAAD,IAAA8gB,IAAA7gB,EAAA4kB,OAAAC,cAAA5kB,EAAA,EAAAA,EAAAD,EAAAwJ,OAAAzI,OAAAd,IAAA,IAAA,GAAAC,GAAAF,EAAAwJ,OAAAvJ,GAAAO,EAAA,EAAAA,EAAAN,EAAAa,OAAAP,IAAA,CAAA,GAAAF,GAAAJ,EAAAM,EAAA,UAAAF,EAAAgN,OAAA,kBAAAhN,EAAAwkB,QAAA/kB,EAAAglB,eAAAzkB,EAAA0kB,UAAA1kB,EAAA2kB,aAAA,aAAA3kB,EAAAwkB,UAAA/kB,EAAA6gB,MAAA7gB,EAAA6gB,IAAA,IAAAtgB,EAAA4kB,uBAAA,MAAAnlB,GAAA6gB,IAAA7gB,EAAA6gB,KAAA,IAAA7gB,EAAAmc,OAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,IAAAzN,EAAAolB,YAAAllB,GAAA,SAAAD,EAAAD,GAAA,YAAA,SAAAE,GAAAD,EAAAD,GAAA,IAAA,GAAAE,GAAA,EAAAA,EAAAD,EAAAe,OAAAd,IAAA,CAAA,GAAAC,GAAAF,EAAAC,GAAAO,EAAAT,EAAAE,EAAA,IAAAC,EAAAa,OAAAP,EAAA,OAAA,EAAA,OAAA,EAAA,QAAAN,GAAAF,EAAAD,EAAAE,GAAA,IAAA,GAAAC,GAAA,EAAAM,EAAA,EAAA,EAAAF,EAAA,EAAAA,EAAAN,EAAAe,OAAAT,IAAA,CAAA,GAAAF,GAAAJ,EAAAM,GAAAH,EAAAJ,EAAAO,EAAAF,GAAAD,IAAAC,EAAAD,GAAAwH,KAAAnH,IAAAN,EAAAI,EAAAE,EAAAJ,EAAAD,GAAAwH,MAAA1H,EAAAC,GAAAF,EAAAE,GAAAH,EAAAG,KAAAH,EAAAG,IAAA,EAAA,QAAAM,KAAA,IAAA,GAAAR,GAAAsJ,UAAAvI,OAAAhB,EAAAoa,MAAAna,GAAAQ,EAAA,EAAAR,EAAAQ,EAAAA,IAAAT,EAAAS,GAAA8I,UAAA9I,EAAA,KAAA,GAAAF,GAAAP,EAAAqlB,OAAA,SAAAplB,EAAAD,GAAA,MAAAA,GAAA,GAAA,IAAAK,EAAA,GAAAilB,aAAA/kB,EAAAS,QAAAZ,EAAAJ,EAAAqlB,OAAA,SAAAplB,EAAAD,GAAA,MAAAA,GAAA,GAAA,IAAAE,EAAAK,EAAAF,IAAAF,EAAAI,EAAAF,EAAAD,GAAA+b,OAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,IAAAzN,EAAAulB,MAAA9kB,GAAA,SAAAR,EAAAD,EAAAE,GAAA,YAAA,SAAAC,GAAAF,GAAA,MAAAA,IAAAA,EAAAulB,WAAAvlB,GAAA+R,QAAA/R,GAAA,QAAAQ,GAAAR,EAAAD,GAAA,KAAAC,YAAAD,IAAA,KAAA,IAAAwjB,WAAA,qCAAArH,OAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,IAAAzN,EAAAwgB,SAAA,EAAA,IAAAjgB,GAAA,WAAA,QAAAN,GAAAA,EAAAD,GAAA,IAAA,GAAAE,GAAA,EAAAA,EAAAF,EAAAgB,OAAAd,IAAA,CAAA,GAAAC,GAAAH,EAAAE,EAAAC,GAAAsjB,WAAAtjB,EAAAsjB,aAAA,EAAAtjB,EAAAujB,cAAA,EAAA,SAAAvjB,KAAAA,EAAAwjB,UAAA,GAAAxH,OAAAkE,eAAApgB,EAAAE,EAAAyjB,IAAAzjB,IAAA,MAAA,UAAAH,EAAAE,EAAAC,GAAA,MAAAD,IAAAD,EAAAD,EAAA6jB,UAAA3jB,GAAAC,GAAAF,EAAAD,EAAAG,GAAAH,MAAAK,EAAAH,EAAA,IAAAE,EAAAD,EAAAE,GAAAC,EAAAJ,EAAA,IAAA2Z,EAAA1Z,EAAAG,GAAAmlB,EAAAvlB,EAAA,GAAAQ,EAAAP,EAAAslB,GAAArO,EAAAlX,EAAA,GAAAW,EAAAX,EAAA,GAAAga,EAAA,WAAA,QAAAja,KAAAQ,EAAAwC,KAAAhD,GAAAgD,KAAA4hB,QAAAhE,IAAA,IAAAmE,eAAA,EAAA,GAAAlE,IAAA,KAAA7d,KAAAwG,UAAA,MAAAlJ,GAAAN,IAAA2jB,IAAA,OAAAnW,MAAA,SAAAxN,GAAA,GAAAD,GAAAiD,KAAA/C,EAAAqJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,KAAApJ,EAAAoJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,KAAA,OAAA,IAAAmc,SAAA,SAAAjlB,EAAAF,GAAA,GAAAF,GAAA,GAAAslB,eAAAtlB,GAAAulB,KAAAzlB,EAAAF,GAAAI,EAAAwlB,aAAA,cAAAxlB,EAAA6L,iBAAA,OAAA,WAAA,IAAA7L,EAAAylB,YAAA,MAAAzlB,EAAA0lB,OAAAtlB,EAAAT,EAAAygB,OAAApgB,EAAA2lB,WAAAzlB,EAAAF,EAAA0lB,UAAA1lB,EAAA6L,iBAAA,QAAA3L,GAAAF,EAAA4lB,KAAA/lB,QAAA0jB,IAAA,SAAAnW,MAAA,SAAAxN,GAAA,GAAAD,GAAAiD,IAAA,IAAAhD,YAAAimB,aAAA,CAAA,GAAAhmB,GAAA,GAAAimB,YAAAlmB,EAAAA,GAAAmmB,OAAAC,aAAAC,MAAA,KAAApmB,GAAA,GAAAC,IAAA,EAAAC,EAAA,SAAAH,EAAA,OAAAgD,MAAA4hB,QAAA,EAAAhkB,EAAAukB,aAAAjlB,GAAA8C,KAAAwG,UAAAtJ,EAAAsJ,OAAA8c,QAAA,SAAAtmB,GAAA,GAAAC,GAAA,GAAAkX,GAAAoP,KAAAxmB,GAAAyJ,OAAAwP,KAAA/Y,EAAA,IAAAC,GAAA,CAAAF,GAAAsmB,QAAA,SAAAtmB,GAAAE,GAAAO,EAAA,QAAAuiB,eAAAhjB,EAAAyX,UAAA1X,EAAA6kB,QAAA,SAAA5kB,EAAAsN,MAAA,cAAAtN,EAAA8kB,QAAA7kB,EAAA4F,KAAApF,EAAA,QAAAsiB,UAAA/iB,EAAAwmB,MAAA,WAAAxmB,EAAA8kB,QAAA7kB,EAAA0J,OAAA3J,EAAAymB,WAAAvmB,EAAAF,EAAA0mB,SAAA,KAAA,YAAA1mB,EAAA8kB,QAAA7kB,EAAA2J,QAAA5J,EAAAymB,WAAAvmB,GAAA,eAAAF,EAAA8kB,SAAA9kB,EAAA2mB,eAAA1mB,EAAA2mB,GAAA5mB,EAAA2mB,eAAAzmB,EAAAF,EAAAwN,MAAA,KAAA,SAAAxN,EAAAsN,MAAA,mBAAAtN,EAAA8kB,QAAA7kB,EAAA4mB,WAAA7mB,EAAAwmB,KAAA,YAAAxmB,EAAAsN,MAAA,kBAAAtN,EAAA8kB,SAAA7kB,EAAA6mB,MAAA9mB,EAAA+mB,mBAAA/jB,QAAA2gB,IAAA,SAAAnW,MAAA,WAAA,GAAAxN,GAAAgD,KAAAjD,EAAA,GAAA6Z,GAAA,QAAAoN,MAAAC,MAAAjkB,KAAA4hB,OAAA/D,KAAA,OAAA7d,MAAAwG,OAAA8c,QAAA,SAAArmB,EAAAC,GAAA,GAAAM,GAAAT,EAAAmnB,UAAA1mB,GAAA2mB,SAAAnnB,EAAA4gB,KAAA3gB,EAAAmnB,OAAA5mB,EAAAR,EAAA4kB,UAAA7kB,EAAAsnB,aAAA1D,IAAA,UAAAnW,MAAA,WAAA,IAAA,GAAAxN,GAAAgD,KAAAokB,SAAArnB,EAAA,GAAAoa,OAAAna,EAAAe,QAAAd,EAAA,EAAAA,EAAAD,EAAAe,OAAAd,IAAAF,EAAAE,GAAAD,EAAAsnB,WAAArnB,EAAA,OAAAF,MAAA4jB,IAAA,QAAAnW,MAAA,SAAAxN,GAAA,GAAAD,GAAA,GAAAoX,GAAAoP,MAAAvmB,EAAA,OAAAgD,MAAAwG,OAAAwP,KAAAjZ,GAAAA,KAAA4jB,IAAA,MAAAnW,MAAA,SAAAxN,GAAA,MAAAS,GAAA,QAAAyiB,SAAAljB,GAAAgD,KAAAwG,OAAAxJ,GAAAgD,KAAAwG,OAAA9C,KAAA,SAAA3G,GAAA,MAAAA,GAAA8F,OAAA7F,OAAA2jB,IAAA,QAAAnW,MAAA,WAAA,GAAAzN,GAAAuJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,EAAArJ,EAAAqJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAAtG,KAAAukB,SAAArnB,EAAA,GAAAF,EAAA,OAAAE,GAAA0kB,OAAA5hB,KAAA4hB,OAAA1kB,EAAAsJ,OAAAxG,KAAAwG,OAAAge,IAAA,SAAAxnB,GAAA,MAAAA,GAAAynB,MAAA1nB,EAAAE,KAAAC,KAAAyjB,IAAA,YAAAc,IAAA,WAAA,GAAAzkB,GAAAgD,KAAAwG,OAAAge,IAAA,SAAAxnB,GAAA,MAAAA,GAAA0nB,WAAA,OAAArhB,MAAAvE,IAAAukB,MAAAhgB,KAAArG,MAAA2jB,IAAA,MAAAc,IAAA,WAAA,MAAAzhB,MAAA4hB,OAAAhE,KAAApb,IAAA,SAAAxF,GAAA,GAAAD,GAAAiD,KAAA4hB,OAAAhE,GAAA5d,MAAA4hB,OAAAhE,IAAA5gB,CAAA,IAAAC,GAAAF,EAAAC,CAAAgD,MAAAwG,OAAA8c,QAAA,SAAAtmB,GAAA,MAAAA,GAAAwT,MAAAvT,QAAA0jB,IAAA,gBAAAc,IAAA,WAAA,MAAAzhB,MAAA4hB,OAAAG,eAAAvf,IAAA,SAAAxF,GAAAgD,KAAA4hB,OAAAG,cAAAA,iBAAApB,IAAA,WAAAc,IAAA,WAAA,GAAAzkB,GAAAgD,KAAAwG,OAAAge,IAAA,SAAAxnB,GAAA,MAAAA,GAAAunB,UAAA,OAAAlhB,MAAAtE,IAAAskB,MAAAhgB,KAAArG,OAAAA,IAAAD,GAAAwgB,KAAAtG,GAAA,SAAAja,EAAAD,EAAAE,GAAA,YAAA,SAAAO,GAAAR,EAAAD,GAAA,KAAAC,YAAAD,IAAA,KAAA,IAAAwjB,WAAA,qCAAArH,OAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,IAAAzN,EAAA4nB,SAAA,EAAA,IAAArnB,GAAA,WAAA,QAAAN,GAAAA,EAAAD,GAAA,IAAA,GAAAE,GAAA,EAAAA,EAAAF,EAAAgB,OAAAd,IAAA,CAAA,GAAAC,GAAAH,EAAAE,EAAAC,GAAAsjB,WAAAtjB,EAAAsjB,aAAA,EAAAtjB,EAAAujB,cAAA,EAAA,SAAAvjB,KAAAA,EAAAwjB,UAAA,GAAAxH,OAAAkE,eAAApgB,EAAAE,EAAAyjB,IAAAzjB,IAAA,MAAA,UAAAH,EAAAE,EAAAC,GAAA,MAAAD,IAAAD,EAAAD,EAAA6jB,UAAA3jB,GAAAC,GAAAF,EAAAD,EAAAG,GAAAH,MAAAK,EAAAH,EAAA,GAAAE,EAAA,SAAAH,GAAA,MAAAA,IAAAA,EAAAulB,WAAAvlB,GAAA+R,QAAA/R,IAAAI,GAAAC,EAAA,WAAA,QAAAL,GAAAD,EAAAE,GAAA,GAAAC,GAAAoJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,EAAAhJ,EAAAgJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,CAAA,IAAA9I,EAAAwC,KAAAhD,GAAAgD,KAAAyE,KAAAtH,EAAA,QAAA+iB,SAAAnjB,GAAAiD,KAAAyE,KAAA1H,MAAA,CAAA,IAAAI,EAAA,QAAAgjB,QAAApjB,GAAA,KAAA,IAAAW,OAAA,6EAAAsC,MAAA6C,KAAA9F,EAAAiD,KAAA2E,KAAA1H,EAAA+C,KAAAukB,SAAArnB,EAAA8C,KAAA0jB,SAAApmB,EAAA,MAAAA,GAAAN,IAAA2jB,IAAA,QAAAnW,MAAA,SAAAxN,GAAA,MAAAG,GAAA,QAAA+iB,SAAAljB,GAAAgD,KAAAyE,OAAAzH,EAAAG,EAAA,QAAAgjB,QAAAnjB,GAAAgD,KAAA6C,KAAAgd,gBAAA7iB,EAAA6iB,kBAAA,MAAAc,IAAA,SAAAnW,MAAA,WAAA,OAAA3H,KAAA7C,KAAA6C,KAAA4B,KAAAzE,KAAAyE,KAAAE,KAAA3E,KAAA2E,KAAA+e,SAAA1jB,KAAA0jB,SAAAa,SAAAvkB,KAAAukB,aAAA5D,IAAA,OAAAc,IAAA,WAAA,MAAAtkB,GAAA,QAAAijB,YAAApgB,KAAAyE,OAAAjC,IAAA,SAAAxF,GAAAgD,KAAAyE,KAAAtH,EAAA,QAAAkjB,YAAArjB,MAAA2jB,IAAA,SAAAc,IAAA,WAAA,MAAAzhB,MAAA2E,MAAAnC,IAAA,SAAAxF,GAAAgD,KAAA2E,KAAA3H,KAAA2jB,IAAA,UAAAc,IAAA,WAAA,MAAAzhB,MAAA2E,KAAA3E,KAAAukB,UAAA/hB,IAAA,SAAAxF,GAAAgD,KAAAukB,SAAAvnB,EAAAgD,KAAA2E,SAAA3H,IAAAD,GAAA4nB,KAAAtnB,GAAA,SAAAL,EAAAD,EAAAE,GAAA,YAAA,SAAAC,GAAAF,EAAAD,GAAA,KAAAC,YAAAD,IAAA,KAAA,IAAAwjB,WAAA,qCAAArH,OAAAkE,eAAArgB,EAAA,cAAAyN,OAAA,IAAAzN,EAAAwmB,UAAA,EAAA,IAAA/lB,GAAA,WAAA,QAAAR,GAAAA,EAAAD,GAAA,IAAA,GAAAE,GAAA,EAAAA,EAAAF,EAAAgB,OAAAd,IAAA,CAAA,GAAAC,GAAAH,EAAAE,EAAAC,GAAAsjB,WAAAtjB,EAAAsjB,aAAA,EAAAtjB,EAAAujB,cAAA,EAAA,SAAAvjB,KAAAA,EAAAwjB,UAAA,GAAAxH,OAAAkE,eAAApgB,EAAAE,EAAAyjB,IAAAzjB,IAAA,MAAA,UAAAH,EAAAE,EAAAC,GAAA,MAAAD,IAAAD,EAAAD,EAAA6jB,UAAA3jB,GAAAC,GAAAF,EAAAD,EAAAG,GAAAH,MAAAO,EAAAL,EAAA,GAAAG,EAAAH,EAAA,GAAAE,EAAAF,EAAA,GAAAI,EAAAJ,EAAA,GAAA2Z,EAAA3Z,EAAA,GAAAulB,EAAA,WAAA,QAAAxlB,KAAA,GAAAD,GAAAuJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,GAAArJ,EAAAqJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,IAAA,CAAApJ,GAAA8C,KAAAhD,GAAAgD,KAAA6C,KAAA9F,EAAAiD,KAAAyG,SAAAzG,KAAA4kB,kBAAA5kB,KAAA6kB,iBAAA5nB,EAAA,MAAAO,GAAAR,IAAA2jB,IAAA,OAAAnW,MAAA,SAAAxN,EAAAC,GAAA,GAAAC,GAAAoJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,EAAA9I,EAAA8I,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,EAAAvJ,EAAA,GAAAM,GAAAsnB,KAAA3nB,EAAAC,EAAAC,EAAAM,EAAA,QAAA,EAAAF,EAAAgjB,cAAAtgB,KAAAyG,MAAA1J,GAAAiD,QAAA2gB,IAAA,SAAAnW,MAAA,SAAAxN,EAAAD,GAAA,GAAAE,GAAAqJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,EAAApJ,EAAA,GAAAG,GAAAsnB,KAAA3nB,EAAAD,EAAA,EAAAE,EAAA,QAAA,EAAAK,EAAAgjB,cAAAtgB,KAAAyG,MAAAvJ,GAAA8C,QAAA2gB,IAAA,UAAAnW,MAAA,SAAAxN,EAAAD,GAAA,IAAA,GAAAE,GAAA,EAAAA,EAAA+C,KAAAyG,MAAA1I,OAAAd,IAAA,CAAA,GAAAC,GAAA8C,KAAAyG,MAAAxJ,EAAA,IAAAC,EAAA4nB,MAAA9nB,IAAA,IAAAE,EAAAqnB,SAAA,CAAArnB,EAAA0J,QAAA7J,CAAA,QAAA,MAAAiD,SAAA2gB,IAAA,KAAAnW,MAAA,SAAAxN,EAAAD,EAAAG,GAAA8C,KAAA4kB,eAAAlD,eAAA1kB,KAAAgD,KAAA4kB,eAAA5nB,MAAA,IAAAC,GAAA,GAAAG,GAAAukB,QAAA3kB,EAAAD,EAAAG,EAAA,QAAA,EAAAI,EAAAgjB,cAAAtgB,KAAA4kB,eAAA5nB,GAAAC,GAAA+C,QAAA2gB,IAAA,QAAAnW,MAAA,SAAAxN,GAAA,MAAAgD,MAAA6kB,iBAAA7nB,EAAAgD,QAAA2gB,IAAA,QAAAnW,MAAA,SAAAxN,GAAA,MAAAgD,MAAAyG,MAAA6c,QAAA,SAAAvmB,GAAAA,EAAA4H,MAAA3H,EAAAD,EAAAwnB,UAAAvnB,IAAAgD,QAAA2gB,IAAA,QAAAnW,MAAA,WAAA,GAAAzN,GAAAuJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAA,EAAArJ,EAAAqJ,UAAAvI,OAAA,OAAA,KAAAuI,UAAA,GAAAA,UAAA,GAAAtG,KAAAukB,SAAArnB,EAAAmG,KAAAtE,IAAAiB,KAAAyG,MAAAse,UAAA,SAAA/nB,GAAA,MAAAA,GAAA2H,MAAA5H,IAAA,GAAAS,EAAAwC,KAAAyG,MAAAse,UAAA,SAAA/nB,GAAA,MAAAA,GAAA4J,SAAA3J,IAAA,EAAAK,EAAA,GAAAN,GAAAgD,KAAA6C,KAAA,OAAAvF,GAAAmJ,MAAAzG,KAAAyG,MAAAge,MAAAvnB,EAAAM,GAAAF,EAAAmJ,MAAA6c,QAAA,SAAAtmB,GAAA,MAAAA,GAAA2H,KAAA3H,EAAA2H,KAAA5H,IAAAO,KAAAqjB,IAAA,SAAAnW,MAAA,SAAAxN,EAAAD,GAAA,QAAAE,GAAAD,GAAA,GAAAD,GAAAsG,KAAAiQ,MAAApW,EAAAF,GAAAC,EAAAoG,KAAAtE,IAAAhC,EAAAS,EAAA,EAAA,OAAAA,GAAAT,EAAAE,EAAA,GAAAC,GAAAH,EAAA8gB,KAAA,GAAA9gB,EAAA6gB,KAAApgB,EAAA,GAAA,IAAAwC,KAAA6kB,kBAAA7nB,EAAA6mB,WAAA,EAAA7jB,KAAA6kB,mBAAA,EAAA1nB,EAAAmlB,OAAAtiB,KAAAglB,QAAA,SAAAjoB,GAAAC,EAAAioB,UAAA,EAAAloB,EAAA8F,KAAA5F,EAAAF,EAAA4H,MAAAtB,KAAAiQ,MAAA,IAAAvW,EAAA2mB,YAAA1jB,KAAAklB,SAAA,SAAAnoB,GAAAC,EAAAmoB,WAAA,EAAApoB,EAAA8F,KAAA5F,EAAAF,EAAA4H,YAAAgc,IAAA,UAAAc,IAAA,WAAA,GAAAzkB,KAAA,OAAAgD,MAAAyG,MAAA6c,QAAA,SAAAvmB,GAAAC,EAAAgZ,MAAArR,KAAA5H,EAAA4J,OAAAlC,KAAA1H,EAAA0H,KAAA5B,KAAA9F,EAAA8F,KAAA6gB,SAAA3mB,EAAA2mB,aAAA1mB,KAAA2jB,IAAA,WAAAc,IAAA,WAAA,GAAAzkB,KAAA,OAAAgD,MAAAyG,MAAA6c,QAAA,SAAAvmB,GAAAC,EAAAgZ,MAAArR,KAAA5H,EAAA6J,QAAAnC,KAAA1H,EAAA0H,KAAA5B,KAAA9F,EAAA8F,SAAA7F,KAAA2jB,IAAA,SAAAc,IAAA,WAAA,MAAAzhB,MAAAyG,MAAA1I,UAAA4iB,IAAA,YAAAc,IAAA,WAAA,GAAAzhB,KAAAyG,MAAA1I,OAAA,CAAA,MAAAiC,MAAAyG,MAAA,GAAAE,OAAA,MAAA,MAAAga,IAAA,WAAAc,IAAA,WAAA,GAAAzhB,KAAAyG,MAAA1I,OAAA,CAAA,MAAAiC,MAAAyG,MAAAzG,KAAAyG,MAAA1I,OAAA,GAAA6I,QAAA,MAAA,MAAA+Z,IAAA,aAAAc,IAAA,WAAA,MAAA7K,GAAAyG,oBAAArd,KAAA6kB,mBAAAriB,IAAA,SAAAxF,GAAA,GAAAD,GAAA6Z,EAAAyG,oBAAA+H,QAAApoB,IAAA,IAAAD,IAAAiD,KAAA6kB,iBAAA9nB,MAAA4jB,IAAA,mBAAAc,IAAA,WAAA,MAAA7K,GAAA0G,qBAAAja,KAAAiQ,MAAAtT,KAAA6kB,iBAAA,QAAA7nB,IAAAD,GAAAwmB,MAAAf,GAAA,SAAAxlB,EAAAD,EAAAE,IAAA,SAAAD,GAAA,GAAAC,OAAA,SAAAD,GAAA,GAAAD,GAAAC,EAAAqoB,eAAA,GAAApoB,GAAAD,EAAAsoB,iBAAA,IAAAtoB,EAAAuoB,gBAAA,GAAAC,qBAAAloB,EAAA,GAAAuZ,EAAA,GAAAD,EAAA,GAAAzC,EAAA,GAAApX,EAAA,GAAAU,EAAA,GAAAwhB,EAAA,IAAAwG,kBAAA,SAAAzoB,GAAA,GAAAD,GAAA,4BAAA6iB,KAAA5iB,GAAAE,EAAAH,EAAA,GAAA8iB,cAAAriB,EAAAT,EAAA,IAAA,EAAA,OAAA,IAAA+iB,SAAA/iB,EAAA,GAAA,IAAAE,EAAAuoB,oBAAAtoB,IAAA,KAAAM,EAAAkoB,OAAA,EAAA,GAAA,GAAA,GAAAloB,EAAAO,QAAA4nB,gBAAA,SAAA3oB,GAAA,MAAA,gBAAAA,IAAA,SAAA8gB,KAAA9gB,GAAAC,EAAAwoB,kBAAAzoB,GAAA8iB,SAAA9iB,EAAA,KAAA4oB,qBAAAC,GAAA,IAAAC,GAAA,KAAAC,GAAA,IAAAC,GAAA,KAAAC,GAAA,IAAAC,GAAA,IAAAC,GAAA,KAAAC,GAAA,IAAAC,GAAA,KAAAC,GAAA,IAAAC,GAAA,KAAAC,GAAA,KAAAC,sBAAAnH,KAAA,KAAArB,KAAA,KAAAI,KAAA,KAAAQ,KAAA,KAAAK,KAAA,MAAAwH,kBAAA,SAAA1pB,EAAAD,GAAA,GAAAG,GAAAM,EAAA,EAAAF,EAAAN,EAAAD,EAAAA,IAAA,CAAA,OAAAC,GAAA,KAAAQ,EAAA6F,KAAAiQ,MAAAtW,EAAA,IAAA,EAAAM,EAAAN,EAAA,GAAAQ,GAAAN,EAAAD,EAAA2oB,oBAAAtoB,GAAAP,GAAAG,EAAAkoB,QAAA,KAAA,IAAAloB,EAAAD,EAAAwpB,qBAAAvpB,IAAAA,EAAAM,GAAAmpB,YAAA,SAAA3pB,GAAA,GAAAD,GAAAsG,KAAAiQ,MAAA,IAAAtW,GAAAC,IAAA,IAAAA,EAAA2pB,QAAA,IAAA7pB,GAAAA,IAAA,QAAAA,EAAA,MAAAE,EAAAc,OAAA,GAAAd,EAAA+Y,KAAA,EAAA,OAAA/Y,IAAA4pB,YAAA,SAAA7pB,GAAA,GAAAD,GAAAC,CAAA,QAAA,KAAAA,EAAA,GAAA,CAAAD,EAAA,CAAA,KAAA,GAAAE,GAAA,EAAAC,EAAAF,EAAAe,OAAA,EAAAb,GAAA,IAAAD,IAAAC,EAAAH,GAAAC,EAAAC,IAAAC,EAAA,MAAAmG,MAAAiQ,MAAA,IAAAtW,IAAA8pB,UAAA,SAAA9pB,GAAA,MAAAmmB,QAAAC,aAAAC,MAAA,KAAArmB,IAAA+pB,UAAA,SAAA/pB,EAAAD,GAAA,GAAAA,EAAA,KAAAC,EAAAe,OAAA,EAAAhB,GAAAC,EAAA,IAAAA,CAAA,KAAA,GAAAC,MAAAC,EAAAF,EAAAe,OAAA,EAAAb,GAAA,EAAAA,GAAA,EAAA,CAAA,GAAAM,GAAA,IAAAN,EAAAF,EAAAE,GAAAF,EAAAE,EAAA,GAAAF,EAAAE,EAAAD,GAAA2pB,QAAA9G,SAAAtiB,EAAA,KAAA,MAAAP,IAAA+pB,kBAAA,SAAAhqB,GAAA,IAAA,GAAAD,GAAA,IAAAC,EAAAA,IAAA,GAAAD,IAAA,EAAAA,GAAA,IAAAC,EAAA,GAAA,KAAA,GAAAC,MAAAA,EAAA+Y,KAAA,IAAAjZ,GAAA,IAAAA,GAAAA,IAAA,CAAA,OAAAE,MAAAC,EAAA,SAAAF,GAAA,MAAAgD,YAAAhD,GAAA,OAAAA,EAAAsN,UAAA,KAAAtN,EAAAsN,MAAA,OAAAtN,EAAAiqB,aAAA,KAAAjqB,EAAAiqB,SAAA,OAAAjqB,EAAAkqB,YAAA,KAAAlqB,EAAAkqB,SAAAlnB,KAAAmnB,QAAAnqB,EAAA2H,MAAA3E,KAAAonB,QAAApqB,EAAAsN,MAAAtK,KAAAqnB,WAAArqB,EAAAiqB,SAAAjnB,KAAAsnB,UAAAtqB,EAAAkqB,QAAAlnB,KAAAunB,UAAAvqB,EAAAwqB,UAAA,GAAAtqB,GAAAF,GAAAE,GAAAuqB,SAAA,IAAAvqB,EAAAwqB,QAAA,IAAAxqB,EAAAyqB,YAAA,IAAAzqB,EAAA0qB,WAAA,IAAA1qB,EAAA2qB,eAAA,IAAA3qB,EAAA4qB,mBAAA,IAAA5qB,EAAA6qB,WAAA,IAAA7qB,EAAA0jB,UAAAuG,QAAA,SAAAnqB,GAAAgD,KAAA2E,KAAA1H,EAAA+pB,kBAAAhqB,GAAA,IAAAE,EAAA0jB,UAAAwG,QAAA,SAAApqB,GAAA,GAAAA,EAAAE,EAAAuqB,UAAAzqB,EAAAE,EAAA6qB,WAAA,KAAA,IAAArqB,OAAA,mCAAAV,EAAAgD,MAAAsK,KAAAtN,GAAAE,EAAA0jB,UAAAyG,WAAA,SAAArqB,GAAA,GAAA,EAAAA,GAAAA,EAAA,GAAA,KAAA,IAAAU,OAAA,4BAAAsC,MAAAinB,QAAAjqB,GAAAE,EAAA0jB,UAAA0G,UAAA,SAAAtqB,GAAAgD,KAAAknB,OAAAlqB,GAAAE,EAAA0jB,UAAA2G,UAAA,SAAAvqB,GAAAgD,KAAAwnB,OAAAxqB,GAAAE,EAAA0jB,UAAAyD,QAAA,WAAA,GAAArnB,MAAAD,EAAAiD,KAAAsK,KAAA,GAAAtK,KAAAinB,OAAA,OAAAjqB,GAAAgZ,KAAAqN,MAAArmB,EAAAgD,KAAA2E,MAAA3H,EAAAgZ,KAAAjZ,GAAAC,EAAAgZ,KAAAhW,KAAAknB,YAAA,KAAAlnB,KAAAwnB,QAAA,OAAAxnB,KAAAwnB,QAAAxqB,EAAAgZ,KAAAhW,KAAAwnB,QAAAxqB,EAAA,IAAAQ,GAAA,SAAAR,GAAA,IAAAgD,KAAA,MAAA,IAAAxC,GAAAR,EAAAgD,MAAAmnB,QAAAnqB,EAAA2H,MAAA3E,KAAAonB,QAAApqB,EAAAsN,MAAAtK,KAAAgoB,QAAAhrB,EAAAirB,MAAAzqB,GAAA0qB,SAAA,EAAA1qB,EAAA2qB,KAAA,EAAA3qB,EAAA4qB,UAAA,EAAA5qB,EAAA6qB,WAAA,EAAA7qB,EAAA8qB,WAAA,EAAA9qB,EAAA+qB,MAAA,EAAA/qB,EAAAgrB,OAAA,EAAAhrB,EAAAirB,UAAA,EAAAjrB,EAAAkrB,eAAA,GAAAlrB,EAAAmrB,aAAA,GAAAnrB,EAAAorB,MAAA,GAAAprB,EAAAqrB,MAAA,GAAArrB,EAAAsrB,SAAA,GAAAtrB,EAAAurB,QAAA,GAAAvrB,EAAAwrB,UAAA,IAAAxrB,EAAAojB,UAAAuG,QAAA,SAAAnqB,GAAAgD,KAAA2E,KAAA1H,EAAA+pB,kBAAAhqB,GAAA,IAAAQ,EAAAojB,UAAAwG,QAAA,SAAApqB,GAAAgD,KAAAsK,KAAAtN,GAAAQ,EAAAojB,UAAAoH,QAAA,SAAAhrB,GAAAgD,KAAAioB,KAAAjrB,GAAAQ,EAAAojB,UAAAyD,QAAA,WAAA,IAAArkB,KAAAsK,KAAA,KAAA,IAAA5M,OAAA,qCAAA,IAAAV,KAAA,IAAAA,EAAAgZ,KAAAqN,MAAArmB,EAAAgD,KAAA2E,MAAA3H,EAAAgZ,KAAA,IAAAhW,KAAAsK,MAAA6M,MAAA8R,QAAAjpB,KAAAioB,MAAAjrB,EAAAgZ,KAAAhW,KAAAioB,KAAAlqB,QAAAf,EAAAgZ,KAAAqN,MAAArmB,EAAAgD,KAAAioB,UAAA,IAAA,gBAAAjoB,MAAAioB,KAAAjrB,EAAAgZ,KAAA,EAAAhW,KAAAioB,UAAA,IAAA,OAAAjoB,KAAAioB,UAAA,KAAAjoB,KAAAioB,KAAA,CAAAjrB,EAAAgZ,KAAAhW,KAAAioB,KAAAlqB,OAAA,IAAAhB,GAAAiD,KAAAioB,KAAAiB,MAAA,IAAA1E,IAAA,SAAAxnB,GAAA,MAAAA,GAAAsnB,WAAA,IAAAtnB,GAAAgZ,KAAAqN,MAAArmB,EAAAD,OAAAC,GAAAgZ,KAAA,EAAA,OAAAhZ,GAAA,IAAAM,GAAA,SAAAN,GAAA,IAAAgD,KAAA,MAAA,IAAA1C,GAAAN,EAAA,IAAAD,GAAAC,KAAAgD,MAAAmpB,OAAApsB,EAAAosB,WAAA7rB,GAAA8rB,aAAA,GAAA,GAAA,IAAA,KAAA9rB,EAAA+rB,WAAA,EAAA,IAAA,GAAA,GAAA/rB,EAAAsjB,UAAA0I,SAAA,SAAAtsB,GAAA,MAAAgD,MAAAmpB,OAAAnT,KAAAhZ,GAAAgD,MAAA1C,EAAAsjB,UAAAqE,UAAA3nB,EAAAsjB,UAAAja,OAAA,SAAA3J,EAAAQ,EAAAF,EAAAF,GAAA,MAAA4C,MAAAmpB,OAAAnT,KAAA,GAAA9Y,IAAAoN,KAAApN,EAAAwqB,QAAAT,QAAAjqB,EAAAkqB,OAAAjqB,EAAA0oB,gBAAAnoB,GAAAgqB,OAAApqB,GAAAL,EAAA4H,KAAArH,GAAA,KAAA0C,MAAA1C,EAAAsjB,UAAAuE,WAAA7nB,EAAAsjB,UAAAha,QAAA,SAAA5J,EAAAQ,EAAAF,EAAAF,GAAA,MAAA4C,MAAAmpB,OAAAnT,KAAA,GAAA9Y,IAAAoN,KAAApN,EAAAuqB,SAAAR,QAAAjqB,EAAAkqB,OAAAjqB,EAAA0oB,gBAAAnoB,GAAAgqB,OAAApqB,GAAAL,EAAA4H,KAAArH,GAAA,KAAA0C,MAAA1C,EAAAsjB,UAAA2I,QAAAjsB,EAAAsjB,UAAA1c,KAAA,SAAAlH,EAAAD,EAAAE,EAAAC,EAAAM,GAAA,MAAAwC,MAAA2G,OAAA3J,EAAAD,EAAAG,EAAAM,GAAAP,GAAA+C,KAAA4G,QAAA5J,EAAAD,EAAAE,EAAAO,GAAAwC,MAAA1C,EAAAsjB,UAAA4I,SAAAlsB,EAAAsjB,UAAA6I,MAAA,SAAAzsB,EAAAD,EAAAE,EAAAC,GAAA,IAAAia,MAAA8R,QAAAlsB,KAAAA,EAAAgB,OAAA,KAAA,IAAAL,OAAA,oCAAA,OAAAX,GAAAumB,QAAA,SAAAvmB,GAAAiD,KAAA2G,OAAA3J,EAAAD,EAAA,EAAAG,IAAA8C,MAAAjD,EAAAumB,QAAA,SAAAvmB,EAAAG,GAAA,IAAAA,EAAA8C,KAAA4G,QAAA5J,EAAAD,EAAAE,GAAA+C,KAAA4G,QAAA5J,EAAAD,IAAAiD,MAAAA,MAAA1C,EAAAsjB,UAAA8I,cAAApsB,EAAAsjB,UAAAiD,WAAA,SAAA7mB,EAAAD,EAAAE,GAAA,MAAA+C,MAAAmpB,OAAAnT,KAAA,GAAA9Y,IAAAoN,KAAApN,EAAA2qB,eAAAZ,QAAAjqB,EAAAkqB,OAAAnqB,EAAA4H,KAAA1H,GAAA,KAAA+C,MAAA1C,EAAAsjB,UAAAuD,SAAA7mB,EAAAsjB,UAAA+I,MAAA,SAAA3sB,EAAAD,GAAA,MAAAiD,MAAAmpB,OAAAnT,KAAA,GAAAxY,IAAA8M,KAAA9M,EAAAorB,MAAAX,KAAAhrB,EAAA0pB,YAAA3pB,GAAA2H,KAAA5H,GAAA,KAAAiD,MAAA1C,EAAAsjB,UAAAyD,QAAA,WAAA,GAAArnB,GAAA,EAAAD,KAAAG,EAAAI,EAAA8rB,YAAA5rB,EAAAF,EAAA+rB,UAAAjsB,EAAA,SAAAH,GAAA,GAAAC,GAAAD,EAAAonB,SAAArnB,IAAAE,EAAAa,OAAAhB,EAAAiZ,KAAAqN,MAAAtmB,EAAAG,GAAA8C,MAAAmpB,OAAA7F,QAAAlmB,GAAAJ,GAAAQ,EAAAO,MAAA,IAAAZ,GAAAF,EAAA8pB,UAAA/pB,EAAA4sB,SAAA,IAAA,EAAA,OAAA1sB,GAAA2sB,OAAA1sB,EAAAJ,EAAAS,GAAA,IAAAJ,GAAA,SAAAJ,GAAA,IAAAgD,KAAA,MAAA,IAAA5C,GAAAJ,EAAA,IAAAD,GAAAC,KAAA,IAAAD,EAAAknB,MAAA,CAAA,GAAA,gBAAAlnB,GAAAknB,MAAA,KAAA,IAAAvmB,OAAA,mCAAA,IAAAX,EAAAknB,OAAA,GAAAlnB,EAAAknB,OAAA,OAAAlnB,EAAAknB,MAAA,GAAA,EAAA,KAAA,IAAAvmB,OAAA,0DAAAsC,KAAAikB,MAAAlnB,EAAAknB,OAAA,IAAAjkB,KAAAwG,OAAAzJ,EAAAyJ,WAAApJ,GAAA0sB,YAAA,OAAA1sB,EAAA2sB,eAAA,UAAA3sB,EAAA4sB,UAAA,OAAA5sB,EAAA6sB,UAAA,MAAA7sB,EAAAwjB,UAAAsD,SAAA,SAAAlnB,GAAA,MAAAA,IAAAgD,KAAAwG,OAAAwP,KAAAhZ,GAAAgD,OAAAhD,EAAA,GAAAM,GAAA0C,KAAAwG,OAAAwP,KAAAhZ,GAAAA,IAAAI,EAAAwjB,UAAAyD,QAAA,WAAA,GAAArnB,GAAAgD,KAAAwG,OAAAzI,OAAA6rB,SAAA,IAAA7sB,EAAAK,EAAA0sB,YAAA1sB,EAAA2sB,cAAA,OAAAhtB,IAAA+iB,SAAA9iB,EAAA,IAAA,EAAAI,EAAA6sB,UAAA7sB,EAAA4sB,UAAAjtB,GAAAE,EAAA6pB,UAAA7pB,EAAA8pB,UAAA/pB,EAAA,IAAAD,GAAAomB,OAAAC,aAAApjB,KAAAikB,MAAA,IAAAjkB,KAAAikB,MAAA,KAAAjkB,KAAAwG,OAAA8c,QAAA,SAAAtmB,GAAAD,GAAAE,EAAA6pB,UAAA9pB,EAAAqnB,aAAAtnB,GAAAC,EAAAktB,KAAAjtB,EAAAD,EAAAgnB,KAAA5mB,EAAAJ,EAAAumB,MAAAjmB,EAAAN,EAAAmtB,MAAAjtB,EAAAF,EAAAotB,UAAA5sB,GAAAP,OAAA,KAAAD,GAAA,OAAAA,EAAAA,EAAAa,QAAAZ,MAAA,KAAAF,GAAA,OAAAA,EAAAA,EAAAE,EAAA+C,KAAAud,KAAAtgB,IAAAa,KAAAf,EAAAE,EAAA,IAAAD,KAAA,SAAAA,EAAAD,GAAA,QAAAE,GAAAD,GAAA,QAAAD,GAAAC,GAAA,GAAAD,GAAAC,EAAAqtB,KAAA,GAAAptB,EAAAD,EAAAstB,WAAA,QAAApN,GAAAngB,EAAAgB,OAAAd,EAAAgrB,KAAAjrB,EAAAqtB,KAAAptB,IAAA,GAAAO,EAAA+sB,QAAArtB,EAAAF,EAAA,IAAAM,GAAAP,EAAAwtB,OAAA,IAAA,QAAAjtB,EAAA4f,IAAA,GAAA5f,EAAAS,OAAA,KAAA,kCAAA,IAAAX,GAAAF,EAAAI,EAAA2qB,MAAA9qB,EAAAC,EAAAotB,YAAAntB,EAAAD,EAAAotB,YAAA5T,EAAAxZ,EAAAotB,WAAA,IAAA,MAAA5T,EAAA,KAAA,+DAAAiL,cAAAjL,CAAA,KAAA,GAAA4L,IAAAiI,WAAAttB,EAAAutB,WAAArtB,EAAAwkB,aAAAA,cAAApkB,KAAA0W,EAAA,EAAAA,EAAAqO,EAAAkI,WAAAvW,IAAA,CAAA1W,EAAA0W,KAAA,IAAAvW,GAAAb,EAAAwtB,OAAA,IAAA,QAAA3sB,EAAAsf,GAAA,KAAA,yCAAAtf,EAAAsf,EAAA,KAAA,GAAAjG,GAAA/Z,EAAAU,EAAAqqB,OAAAhR,EAAA0T,OAAA,CAAA,GAAAxN,GAAA,SAAAngB,GAAA,GAAAD,KAAAA,GAAA0X,UAAAzX,EAAA4tB,YAAA,IAAA3tB,GAAAD,EAAA6tB,UAAA,IAAA,MAAA,IAAA5tB,GAAA,CAAA,GAAA,KAAAA,EAAA,CAAAF,EAAAuN,KAAA,MAAA,IAAApN,GAAAF,EAAA6tB,WAAAvtB,EAAAN,EAAA4tB,YAAA,QAAA1tB,GAAA,IAAA,GAAA,GAAAH,EAAA+kB,QAAA,iBAAA,GAAAxkB,EAAA,KAAA,sDAAAA,CAAA,OAAAP,GAAAwZ,OAAAvZ,EAAAwtB,YAAAztB,CAAA,KAAA,GAAA,MAAAA,GAAA+kB,QAAA,OAAA/kB,EAAAymB,KAAAxmB,EAAAqtB,KAAA/sB,GAAAP,CAAA,KAAA,GAAA,MAAAA,GAAA+kB,QAAA,kBAAA/kB,EAAAymB,KAAAxmB,EAAAqtB,KAAA/sB,GAAAP,CAAA,KAAA,GAAA,MAAAA,GAAA+kB,QAAA,YAAA/kB,EAAAymB,KAAAxmB,EAAAqtB,KAAA/sB,GAAAP,CAAA,KAAA,GAAA,MAAAA,GAAA+kB,QAAA,iBAAA/kB,EAAAymB,KAAAxmB,EAAAqtB,KAAA/sB,GAAAP,CAAA,KAAA,GAAA,MAAAA,GAAA+kB,QAAA,SAAA/kB,EAAAymB,KAAAxmB,EAAAqtB,KAAA/sB,GAAAP,CAAA,KAAA,GAAA,MAAAA,GAAA+kB,QAAA,SAAA/kB,EAAAymB,KAAAxmB,EAAAqtB,KAAA/sB,GAAAP,CAAA,KAAA,GAAA,MAAAA,GAAA+kB,QAAA,WAAA/kB,EAAAymB,KAAAxmB,EAAAqtB,KAAA/sB,GAAAP,CAAA,KAAA,IAAA,GAAAA,EAAA+kB,QAAA,oBAAA,GAAAxkB,EAAA,KAAA,yDAAAA,CAAA,OAAAP,GAAAkqB,QAAAjqB,EAAA6tB,WAAA9tB,CAAA,KAAA,IAAA,GAAAA,EAAA+kB,QAAA,aAAA,GAAAxkB,EAAA,KAAA,kDAAAA,CAAA,OAAAP,EAAA,KAAA,IAAA,GAAAA,EAAA+kB,QAAA,WAAA,GAAAxkB,EAAA,KAAA,gDAAAA,CAAA,OAAAP,GAAAmlB,qBAAAllB,EAAA6tB,YAAA,KAAA7tB,EAAA6tB,YAAA,GAAA7tB,EAAA6tB,WAAA9tB,CAAA,KAAA,IAAA,GAAAA,EAAA+kB,QAAA,cAAA,GAAAxkB,EAAA,KAAA,mDAAAA,CAAA,IAAAF,GAAAJ,EAAA6tB,UAAA,OAAA9tB,GAAA+tB,WAAAC,EAAA,GAAAC,GAAA,GAAA7J,GAAA,GAAA8J,GAAA,IAAA,GAAA7tB,GAAAL,EAAAmuB,KAAA,GAAA9tB,EAAAL,EAAA+B,IAAA9B,EAAA6tB,WAAA9tB,EAAAouB,IAAAnuB,EAAA6tB,WAAA9tB,EAAAquB,MAAApuB,EAAA6tB,WAAA9tB,EAAAsuB,SAAAruB,EAAA6tB,WAAA9tB,CAAA,KAAA,IAAA,GAAAA,EAAA+kB,QAAA,gBAAA,GAAAxkB,EAAA,KAAA,qDAAAA,CAAA,OAAAP,GAAAilB,UAAAhlB,EAAA6tB,WAAA9tB,EAAAklB,YAAA5e,KAAA8D,IAAA,EAAAnK,EAAA6tB,YAAA9tB,EAAAuuB,UAAAtuB,EAAA6tB,WAAA9tB,EAAAwuB,cAAAvuB,EAAA6tB,WAAA9tB,CAAA,KAAA,IAAA,GAAAA,EAAA+kB,QAAA,eAAA,GAAAxkB,EAAA,KAAA,oDAAAA,CAAA,OAAAP,GAAA4jB,IAAA3jB,EAAA6tB,UAAA,GAAA9tB,EAAAyT,MAAAxT,EAAA6tB,WAAA9tB,CAAA,KAAA,KAAA,MAAAA,GAAA+kB,QAAA,oBAAA/kB,EAAAkrB,KAAAjrB,EAAAqtB,KAAA/sB,GAAAP,CAAA,SAAA,MAAAA,GAAA+kB,QAAA,UAAA/kB,EAAAkrB,KAAAjrB,EAAAqtB,KAAA/sB,GAAAP,EAAA,MAAAA,GAAAkrB,KAAAjrB,EAAAqtB,KAAA/sB,GAAAP,EAAA,GAAA,KAAAE,EAAA,CAAAF,EAAAuN,KAAA,OAAA,IAAAhN,GAAAN,EAAA4tB,YAAA,OAAA7tB,GAAAkrB,KAAAjrB,EAAAqtB,KAAA/sB,GAAAP,EAAA,GAAA,KAAAE,EAAA,CAAAF,EAAAuN,KAAA,cAAA,IAAAhN,GAAAN,EAAA4tB,YAAA,OAAA7tB,GAAAkrB,KAAAjrB,EAAAqtB,KAAA/sB,GAAAP,EAAA,KAAA,sCAAAE,EAAA,GAAAE,EAAA,KAAA,IAAAF,IAAAE,EAAAF,EAAAA,EAAAO,IAAAL,EAAAH,EAAA6tB,WAAArtB,EAAAP,EAAA,IAAAI,GAAAJ,GAAA,CAAA,QAAAF,EAAAkqB,QAAA,GAAAhqB,EAAAF,EAAAuN,KAAA,UAAAjN,GAAA,IAAA,GAAA,MAAAN,GAAA+kB,QAAA,UAAA/kB,EAAA0mB,WAAAtmB,EAAAJ,EAAA2mB,SAAA1mB,EAAA6tB,WAAA9tB,CAAA,KAAA,GAAA,MAAAA,GAAA0mB,WAAAtmB,EAAAJ,EAAA2mB,SAAA1mB,EAAA6tB,WAAA,GAAA9tB,EAAA2mB,SAAA3mB,EAAA+kB,QAAA,UAAA/kB,EAAA+kB,QAAA,SAAA/kB,CAAA,KAAA,IAAA,MAAAA,GAAA+kB,QAAA,iBAAA/kB,EAAA0mB,WAAAtmB,EAAAJ,EAAA2X,OAAA1X,EAAA6tB,WAAA9tB,CAAA,KAAA,IAAA,MAAAA,GAAA+kB,QAAA,aAAA/kB,EAAA4mB,eAAAxmB,EAAAJ,EAAAyN,MAAAxN,EAAA6tB,WAAA9tB,CAAA,KAAA,IAAA,MAAAA,GAAA+kB,QAAA,gBAAA/kB,EAAAgnB,cAAA5mB,EAAAJ,CAAA,KAAA,IAAA,MAAAA,GAAA+kB,QAAA,oBAAA/kB,EAAA2X,OAAAvX,EAAAJ,CAAA,KAAA,IAAA,MAAAA,GAAA+kB,QAAA,YAAA/kB,EAAAyN,MAAArN,GAAAH,EAAA6tB,YAAA,GAAA9tB,CAAA,SAAA,KAAA,iCAAAM,IAAA4Z,EAAAxZ,GAAA0W,GAAA6B,KAAAmH,IAAA,OAAAyE,OAAAY,EAAAhc,OAAA/I,GAAA,QAAAP,GAAAF,GAAA,QAAAD,GAAAA,GAAA,GAAAE,GAAAD,EAAA0oB,OAAAvoB,EAAAJ,EAAA,OAAAI,IAAAJ,EAAAE,EAAA,QAAAA,KAAA,GAAAF,IAAAC,EAAAsnB,WAAAnnB,IAAA,KAAAH,EAAAsnB,WAAAnnB,EAAA,IAAA,KAAAH,EAAAsnB,WAAAnnB,EAAA,IAAA,GAAAH,EAAAsnB,WAAAnnB,EAAA,EAAA,OAAAA,IAAA,EAAAJ,EAAA,QAAAG,KAAA,GAAAH,IAAAC,EAAAsnB,WAAAnnB,IAAA,GAAAH,EAAAsnB,WAAAnnB,EAAA,EAAA,OAAAA,IAAA,EAAAJ,EAAA,QAAAS,GAAAT,GAAA,GAAAE,GAAAD,EAAAsnB,WAAAnnB,EAAA,OAAAJ,IAAAE,EAAA,MAAAA,GAAA,KAAAE,GAAA,EAAAF,EAAA,QAAAK,KAAA,MAAAH,IAAAH,EAAAe,OAAA,QAAAX,KAAA,IAAA,GAAAJ,GAAA,IAAA,CAAA,GAAAD,GAAAS,GAAA,MAAA,IAAAT,GAAA,MAAAC,GAAAD,CAAAC,IAAA,IAAAD,EAAAC,IAAA,GAAA,GAAAG,GAAA,CAAA,QAAAwtB,IAAArtB,EAAA+sB,KAAAttB,EAAAutB,UAAArtB,EAAAutB,UAAAttB,EAAA2tB,SAAArtB,EAAAotB,WAAAxtB,GAAAJ,EAAAa,QAAA,SAAAb,GAAA,MAAAC,GAAAD,KAAA,SAAAA,EAAAD,GAAAC,EAAAa,QAAA,SAAAb,GAAA,MAAAA,GAAAwuB,kBAAAxuB,EAAAyuB,UAAA,aAAAzuB,EAAA0uB,SAAA1uB,EAAA2uB,YAAA3uB,EAAAwuB,gBAAA,GAAAxuB","file":"jon-trombone.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\nclass GUI {\n\n    /**\n     * Creates and attaches a GUI to the page if DAT.GUI is included.\n     */\n    static Init(controller){\n            if(typeof(dat) === \"undefined\"){\n            console.warn(\"No DAT.GUI instance found. Import on the page to use!\");\n            return;\n        }\n\n        var gui = new dat.GUI({\n        });\n\n        var jon = controller;\n\n        gui.add(jon.trombone, 'ToggleMute');\n\n        var jonGUI = gui.addFolder(\"Jon\");\n        jonGUI.add(jon, \"moveJaw\").listen();\n        jonGUI.add(jon, \"jawFlapSpeed\").min(0).max(100);\n        jonGUI.add(jon, \"jawOpenOffset\").min(0).max(1);\n\n        var voiceGUI = gui.addFolder(\"Voice\");\n        voiceGUI.add(jon.trombone, 'autoWobble');\n        voiceGUI.add(jon.trombone.AudioSystem, 'useWhiteNoise');\n        voiceGUI.add(jon.trombone.Glottis, 'UITenseness').min(0).max(1);\n        voiceGUI.add(jon.trombone.Glottis, 'vibratoAmount').min(0).max(0.5);\n        voiceGUI.add(jon.trombone.Glottis, 'UIFrequency').min(1).max(1000);\n        voiceGUI.add(jon.trombone.Glottis, 'loudness').min(0).max(1);\n\n        var tractGUI = gui.addFolder(\"Tract\");\n        tractGUI.add(jon.trombone.Tract, 'movementSpeed').min(1).max(30).step(1);\n        tractGUI.add(jon.trombone.TractUI, 'target').min(0.001).max(1);\n        tractGUI.add(jon.trombone.TractUI, 'index').min(0).max(43).step(1);\n        tractGUI.add(jon.trombone.TractUI, 'radius').min(0).max(5).step(1);\n\n        var songGUI = gui.addFolder(\"midi\");\n        songGUI.add(jon.midiController, 'PlaySong');\n        songGUI.add(jon.midiController, 'Stop');\n        songGUI.add(jon.midiController, 'Restart');\n        songGUI.add(jon.midiController, 'currentTrack').min(0).max(20).step(1).listen();\n        songGUI.add(jon.midiController, 'baseFreq').min(1).max(2000);\n    }\n\n}\n\nexport { GUI };","import { ModelLoader } from \"./utils/model-loader.js\";\nimport { PinkTrombone } from \"./pink-trombone/pink-trombone.js\";\nimport { MidiController } from \"./midi/midi-controller.js\";\nimport { MidiDropArea } from \"./midi/midi-drop-area.js\";\n\nclass JonTrombone {\n\n    constructor(container) {\n        this.container = container;\n        this.container.style.position = \"relative\";\n        this.container.style.cursor = \"default\";\n\n        // Set up renderer and embed in container\n        this.renderer = new THREE.WebGLRenderer( { alpha: true } );\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(this.container.offsetWidth, this.container.offsetHeight);\n        this.renderer.setClearColor(0x000000, 0);\n        this.container.appendChild(this.renderer.domElement);\n\n        // Set up scene and view\n        let aspect = this.container.offsetWidth / this.container.offsetHeight;\n        this.camera = new THREE.PerspectiveCamera( 45, aspect, 0.1, 100 );\n        this.scene = new THREE.Scene();\n\n        // Export scene for three js inspector\n        //window.scene = this.scene;\n\n        // Set up clock for timing\n        this.clock = new THREE.Clock();\n\n        //window.scene = this.scene;\n\n        let startDelayMS = 1000;\n        this.trombone = new PinkTrombone();\n        setTimeout(()=> {\n            this.trombone.StartAudio();\n            this.moveJaw = true;\n        }, startDelayMS);\n\n        // Mute button for trombone\n        // let button = document.createElement(\"button\");\n        // button.innerHTML = \"Mute\";\n        // button.style.cssText = \"position: absolute; display: block; top: 0; left: 0;\";\n        // this.container.appendChild(button);\n        // button.addEventListener (\"click\", () => {\n        //     this.trombone.ToggleMute();\n        //     button.innerHTML = this.trombone.muted ? \"Unmute\" : \"Mute\";\n        // });\n\n        this.jawFlapSpeed = 20.0;\n        this.jawOpenOffset = 0.19;\n        this.moveJaw = false;\n\n        this.midiController = new MidiController(this);\n        let dropArea = new MidiDropArea(this);\n        \n        //this.Sing('../resources/midi/dragon-roost-island.mid');\n\n        this.SetUpThree();\n        this.SetUpScene();\n\n        // Start the update loop\n        this.OnUpdate();\n    }\n\n    /**\n     * Set up non-scene config for Three.js\n     */\n    SetUpThree() {\n        if(THREE.OrbitControls !== undefined){\n            // Add orbit controls\n            this.controls = new THREE.OrbitControls( this.camera, this.renderer.domElement );\n            this.controls.target.set( 0, 0, 0 );\n            this.controls.update();\n        } else {\n            console.warn(\"No THREE.OrbitControls detected. Include to allow interaction with the model.\");\n        }\n    }\n\n    /**\n     * Populates and configures objects within the scene.\n     */\n    SetUpScene() {\n\n        // Set camera position\n        this.camera.position.set( 0, 0, 0.5 );\n\n        // Lights\n        let light1 = new THREE.HemisphereLight(0xffffff, 0x444444, 1.0);\n        light1.name = \"Hemisphere Light\";\n        light1.position.set(0, 1, 0);\n        this.scene.add(light1);\n\n        let light2 = new THREE.DirectionalLight(0xffffff, 1.0);\n        light2.name = \"Directional Light\";\n        light2.position.set(0, 1, 0);\n        this.scene.add(light2);\n\n        // Load the Jon model and place it in the scene\n        ModelLoader.LoadJSON(\"../resources/jon/three/jon.json\", (object) => {\n            this.jon = object;\n            this.scene.add( this.jon );\n            this.jon.rotation.y = (THREE.Math.degToRad(15));\n\n            this.jaw = this.jon.skeleton.bones.find((obj) => {\n                return obj.name == \"Bone.006\";\n            });\n            if(this.jaw){\n                this.jawShutZ = this.jaw.position.z;\n            }\n        });\n\n\n    }\n\n    /**\n     * Called every frame. Continues indefinitely after being called once.\n     */\n    OnUpdate() {\n        let deltaTime = this.clock.getDelta();\n        requestAnimationFrame( this.OnUpdate.bind(this) );\n\n        if(this.midiController.playing){\n\n            let note = this.midiController.GetPitch();\n            if(note != this.lastNote){\n                //console.log(note);\n                // Do the note\n                if(note === undefined){\n                    // Note off\n                    this.trombone.Glottis.loudness = 0;\n                    // Close jaw\n                    this.jaw.position.z = this.jawShutZ;\n                    this.trombone.TractUI.SetLipsClosed(1);\n                } else {\n                    // Note on\n                    this.trombone.Glottis.loudness = 1;\n                    // Play frequency\n                    let freq = this.midiController.MIDIToFrequency(note.midi);\n                    //console.log(freq);\n                    this.trombone.Glottis.UIFrequency = freq;\n                    // Open jaw\n                    this.jaw.position.z = this.jawShutZ + this.jawOpenOffset;\n                    this.trombone.TractUI.SetLipsClosed(0);\n                }\n\n                this.lastNote = note;\n            }\n\n        }\n\n        if(this.jaw && this.moveJaw && !this.midiController.playing){\n            let time = this.clock.getElapsedTime();// % 60;\n\n            // Move the jaw\n            let percent = (Math.sin(time * this.jawFlapSpeed) + 1.0) / 2.0;\n            this.jaw.position.z = this.jawShutZ + (percent * this.jawOpenOffset);\n\n            // Make the audio match the jaw position\n            this.trombone.TractUI.SetLipsClosed(1.0 - percent);\n        }\n\n        // Render\n        this.renderer.render(this.scene, this.camera);\n    }\n\n}\n\nexport { JonTrombone };","import { Detector } from \"./utils/webgl-detect.js\";\nimport { JonTrombone } from \"./jon-trombone.js\";\nimport { GUI } from \"./gui.js\";\n\n// Optionally bundle three.js as part of the project\n//import THREELib from \"three-js\";\n//var THREE = THREELib(); // return THREE JS\n\nlet container = document.getElementById(\"jon-trombone-container\");\n\nif ( !Detector.HasWebGL() ) {\n    //exit(\"WebGL is not supported on this browser.\");\n    console.log(\"WebGL is not supported on this browser.\");\n    container.innerHTML = Detector.GetErrorHTML();\n    container.classList.add(\"no-webgl\");\n}\nelse{\n    let jonTrombone = new JonTrombone(container);\n    GUI.Init(jonTrombone);\n}","let MidiConvert = require('midiconvert');\n\n/**\n * Simple class for MIDI playback.\n * The paradigm here's a bit weird; it's up to an external\n * source to actually produce audio. This class just manages\n * a timer, which GetPitch() reads to produce the \"current\"\n * note information. \n * \n * As an example of usage, jon-trombone calls PlaySong() to\n * begin, and then every frame uses GetPitch() to figure out\n * what the current frequency to produce is.\n */\nclass MidiController {\n\n    constructor(controller) {\n        this.controller = controller;\n\n        this.midi = null;\n\n        this.playing = false;\n        this.currentTrack = 5;\n\n        this.baseFreq = 110; //110 is A2\n\n        this.clock = new THREE.Clock(false);\n    }\n\n    /**\n     * Loads and parses a MIDI file.\n     */\n    LoadSong(path, callback){\n        this.midi = null;\n        MidiConvert.load(path, (midi) => {\n            console.log(\"MIDI loaded.\");\n            this.midi = midi;\n            console.log(this.midi);\n            if(callback) callback(midi);\n        });\n    }\n\n    LoadSongDirect(file){\n        this.midi = MidiConvert.parse(file);\n        console.log(\"MIDI loaded.\");\n        console.log(this.midi);\n    }\n\n    /**\n     * Gets the pitch for the specified track at the current time in the song.\n     */\n    GetPitch(trackIndex = this.currentTrack){\n        let time = this.GetSongProgress();\n\n        // Constrain track specified to valid range\n        trackIndex = Math.min(trackIndex, this.midi.tracks.length - 1);\n        trackIndex = Math.max(trackIndex, 0);\n\n        return this.midi.tracks[trackIndex].notes.find((item) => {\n            return item.noteOn <= time && time <= item.noteOff;\n        });\n    }\n\n    PlaySong(track = 5){\n\n        // If no song is specified, load a song\n        if(!this.midi){\n            console.log(\"No MIDI is loaded.\");\n            this.LoadSong('../resources/midi/un-owen-was-her.mid', () => {\n                this.PlaySong();\n            });\n            return;\n        }\n\n        // Turn off some stuff so the singing kind of sounds okay\n        this.EnterSingMode();\n\n        this.currentTrack = track;\n        this.clock.start();\n        this.playing = true;\n\n    }\n\n    GetSongProgress(){\n        return this.clock.getElapsedTime();\n    }\n\n    /**\n     * Converts from a MIDI note code to its corresponding frequency.\n     * @param {*} midiCode \n     */\n    MIDIToFrequency(midiCode){\n        return this.baseFreq * Math.pow(2, (midiCode - 57) / 12);\n    }\n\n    /**\n     * Restarts the playback.\n     */\n    Restart(){\n        this.clock = new THREE.Clock();\n    }\n\n    /**\n     * Stops playback.\n     */\n    Stop() {\n        this.clock.stop();\n        this.playing = false;\n        this.ExitSingMode();\n    }\n\n    /**\n     * Sets up the trombone for singing.\n     */\n    EnterSingMode(){\n        this.oldAutoWobble = this.controller.trombone.autoWobble;\n        this.controller.trombone.autoWobble = false;\n\n        this.oldUseWhiteNoise = this.controller.trombone.AudioSystem.useWhiteNoise;\n        this.controller.trombone.AudioSystem.useWhiteNoise = false;\n\n        this.oldVibratoFrequency = this.controller.trombone.Glottis.vibratoFrequency;\n        this.controller.trombone.Glottis.vibratoFrequency = 0;\n\n        this.oldFrequency = this.controller.trombone.Glottis.UIFrequency;\n    }\n\n    /**\n     * Restores the trombone to the state it was in before singing.\n     */\n    ExitSingMode(){\n        this.controller.trombone.autoWobble = this.oldAutoWobble;\n        this.controller.trombone.AudioSystem.useWhiteNoise = this.oldUseWhiteNoise;\n        this.controller.trombone.Glottis.vibratoFrequency = this.oldVibratoFrequency;\n        this.controller.trombone.Glottis.UIFrequency = this.oldFrequency;\n    }\n\n}\n\nexport { MidiController };","\n/**\n * Drop-in drag and drop support for the MidiController\n */\nexport class MidiDropArea {\n    constructor(controller){\n        this.controller = controller;\n\n        this.dropArea = document.createElement(\"div\");\n\n        this.dropArea.style.position = \"absolute\";\n        this.dropArea.style.top = \"0\";\n        this.dropArea.style.left = \"0\";\n        this.dropArea.style.width = \"100%\";\n        this.dropArea.style.height = \"100%\";\n\n        this.MakeDroppable(this.dropArea, (files) => {\n            //read the file\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = (e) => {\n\t\t\t\tthis.controller.midiController.LoadSongDirect(reader.result);\n\t\t\t};\n\t\t\treader.readAsBinaryString(files[0]);\n        });\n\n        this.controller.container.appendChild(this.dropArea);\n\n    }\n\n    Callback(){\n        console.log(\"Callback\");\n    }\n\n    // From http://bitwiser.in/2015/08/08/creating-dropzone-for-drag-drop-file.html\n    MakeDroppable(element, callback) {\n\n        var input = document.createElement('input');\n        input.setAttribute('type', 'file');\n        input.setAttribute('multiple', true);\n        input.style.display = 'none';\n\n        input.addEventListener('change', triggerCallback);\n        element.appendChild(input);\n        \n        element.addEventListener('dragover', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            element.classList.add('dragover');\n        });\n\n        element.addEventListener('dragleave', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            element.classList.remove('dragover');\n        });\n\n        element.addEventListener('drop', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            element.classList.remove('dragover');\n            triggerCallback(e);\n        });\n        \n        // element.addEventListener('click', function() {\n        //     input.value = null;\n        //     input.click();\n        // });\n\n        function triggerCallback(e) {\n            var files;\n            if(e.dataTransfer) {\n            files = e.dataTransfer.files;\n            } else if(e.target) {\n            files = e.target.files;\n            }\n            callback.call(null, files);\n        }\n    }\n\n    \n}","class AudioSystem {  \n\n    constructor(trombone) {\n        this.trombone = trombone;\n\n        this.blockLength = 512;\n        this.blockTime = 1;\n        this.soundOn = false;\n\n        this.useWhiteNoise = true;\n    }\n\n    init() {\n        window.AudioContext = window.AudioContext||window.webkitAudioContext;\n        this.audioContext = new window.AudioContext();      \n        this.trombone.sampleRate = this.audioContext.sampleRate;\n        \n        this.blockTime = this.blockLength/this.trombone.sampleRate;\n    }\n    \n    startSound() {\n        //scriptProcessor may need a dummy input channel on iOS\n        this.scriptProcessor = this.audioContext.createScriptProcessor(this.blockLength, 2, 1);\n        this.scriptProcessor.connect(this.audioContext.destination); \n        this.scriptProcessor.onaudioprocess = this.doScriptProcessor.bind(this);\n    \n        var whiteNoise = this.createWhiteNoiseNode(2 * this.trombone.sampleRate); // 2 seconds of noise\n        \n        var aspirateFilter = this.audioContext.createBiquadFilter();\n        aspirateFilter.type = \"bandpass\";\n        aspirateFilter.frequency.value = 500;\n        aspirateFilter.Q.value = 0.5;\n        whiteNoise.connect(aspirateFilter);\n        aspirateFilter.connect(this.scriptProcessor);  \n        \n        var fricativeFilter = this.audioContext.createBiquadFilter();\n        fricativeFilter.type = \"bandpass\";\n        fricativeFilter.frequency.value = 1000;\n        fricativeFilter.Q.value = 0.5;\n        whiteNoise.connect(fricativeFilter);\n        fricativeFilter.connect(this.scriptProcessor);        \n        \n        whiteNoise.start(0);\n\n        // Generate white noise (test)\n        // var wn = this.createWhiteNoiseNode(2*this.trombone.sampleRate);\n        // wn.connect(this.audioContext.destination);\n        // wn.start(0);\n    }\n    \n    createWhiteNoiseNode(frameCount) {\n        var myArrayBuffer = this.audioContext.createBuffer(1, frameCount, this.trombone.sampleRate);\n\n        var nowBuffering = myArrayBuffer.getChannelData(0);\n        for (var i = 0; i < frameCount; i++) \n        {\n            nowBuffering[i] = this.useWhiteNoise ? Math.random() : 1.0;// gaussian();\n        }\n\n        var source = this.audioContext.createBufferSource();\n        source.buffer = myArrayBuffer;\n        source.loop = true;\n\n        return source;\n    }\n    \n    \n    doScriptProcessor(event) {\n        var inputArray1 = event.inputBuffer.getChannelData(0);\n        var inputArray2 = event.inputBuffer.getChannelData(1);\n        var outArray = event.outputBuffer.getChannelData(0);\n        for (var j = 0, N = outArray.length; j < N; j++)\n        {\n            var lambda1 = j/N;\n            var lambda2 = (j+0.5)/N;\n            var glottalOutput = this.trombone.Glottis.runStep(lambda1, inputArray1[j]); \n            \n            var vocalOutput = 0;\n            //Tract runs at twice the sample rate \n            this.trombone.Tract.runStep(glottalOutput, inputArray2[j], lambda1);\n            vocalOutput += this.trombone.Tract.lipOutput + this.trombone.Tract.noseOutput;\n            this.trombone.Tract.runStep(glottalOutput, inputArray2[j], lambda2);\n            vocalOutput += this.trombone.Tract.lipOutput + this.trombone.Tract.noseOutput;\n            outArray[j] = vocalOutput * 0.125;\n        }\n        this.trombone.Glottis.finishBlock();\n        this.trombone.Tract.finishBlock();\n    }\n    \n    mute() {\n        this.scriptProcessor.disconnect();\n    }\n    \n    unmute() {\n        this.scriptProcessor.connect(this.audioContext.destination); \n    }\n    \n}\n\nexports.AudioSystem = AudioSystem;","import noise from \"../noise.js\";\n\nclass Glottis {\n\n    constructor(trombone) {\n        this.trombone = trombone;\n\n        this.timeInWaveform = 0;\n        this.oldFrequency = 140;\n        this.newFrequency = 140;\n        this.UIFrequency = 140;\n        this.smoothFrequency = 140;\n        this.oldTenseness = 0.6;\n        this.newTenseness = 0.6;\n        this.UITenseness = 0.6;\n        this.totalTime = 0;\n        this.vibratoAmount = 0.005;\n        this.vibratoFrequency = 6;\n        this.intensity = 0;\n        this.loudness = 1;\n        this.isTouched = false;\n        this.touch = 0;\n        this.x = 240;\n        this.y = 530;\n\n        this.keyboardTop = 500;\n        this.keyboardLeft = 0;\n        this.keyboardWidth = 600;\n        this.keyboardHeight = 100;\n        this.semitones = 20;\n        this.marks = [0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0];\n        this.baseNote = 87.3071; //F\n\n        this.output;\n\n    }\n    \n    init() {\n        this.setupWaveform(0);\n    }\n    \n    handleTouches() {\n        if (this.touch != 0 && !this.touch.alive) this.touch = 0;\n        \n        if (this.touch == 0)\n        {        \n            for (var j=0; j<UI.touchesWithMouse.length; j++)  \n            {\n                var touch = UI.touchesWithMouse[j];\n                if (!touch.alive) continue;\n                if (touch.y<this.keyboardTop) continue;\n                this.touch = touch;\n            }    \n        }\n        \n        if (this.touch != 0)\n        {\n            var local_y = this.touch.y -  this.keyboardTop-10;\n            var local_x = this.touch.x - this.keyboardLeft;\n            local_y = Math.clamp(local_y, 0, this.keyboardHeight-26);\n            var semitone = this.semitones * local_x / this.keyboardWidth + 0.5;\n            Glottis.UIFrequency = this.baseNote * Math.pow(2, semitone/12);\n            if (Glottis.intensity == 0) Glottis.smoothFrequency = Glottis.UIFrequency;\n            //Glottis.UIRd = 3*local_y / (this.keyboardHeight-20);\n            var t = Math.clamp(1-local_y / (this.keyboardHeight-28), 0, 1);\n            Glottis.UITenseness = 1-Math.cos(t*Math.PI*0.5);\n            Glottis.loudness = Math.pow(Glottis.UITenseness, 0.25);\n            this.x = this.touch.x;\n            this.y = local_y + this.keyboardTop+10;\n        }\n        Glottis.isTouched = (this.touch != 0);\n    }\n        \n    runStep(lambda, noiseSource) {\n        var timeStep = 1.0 / this.trombone.sampleRate;\n        this.timeInWaveform += timeStep;\n        this.totalTime += timeStep;\n        if (this.timeInWaveform > this.waveformLength) \n        {\n            this.timeInWaveform -= this.waveformLength;\n            this.setupWaveform(lambda);\n        }\n        var out = this.normalizedLFWaveform(this.timeInWaveform/this.waveformLength);\n        var aspiration = this.intensity*(1.0-Math.sqrt(this.UITenseness))*this.getNoiseModulator()*noiseSource;\n        aspiration *= 0.2 + 0.02 * noise.simplex1(this.totalTime * 1.99);\n        out += aspiration;\n        return out;\n    }\n    \n    getNoiseModulator() {\n        var voiced = 0.1+0.2*Math.max(0,Math.sin(Math.PI*2*this.timeInWaveform/this.waveformLength));\n        //return 0.3;\n        return this.UITenseness* this.intensity * voiced + (1-this.UITenseness* this.intensity ) * 0.3;\n    }\n    \n    finishBlock() {\n        var vibrato = 0;\n        vibrato += this.vibratoAmount * Math.sin(2*Math.PI * this.totalTime *this.vibratoFrequency);          \n        vibrato += 0.02 * noise.simplex1(this.totalTime * 4.07);\n        vibrato += 0.04 * noise.simplex1(this.totalTime * 2.15);\n        if (this.trombone.autoWobble)\n        {\n            vibrato += 0.2 * noise.simplex1(this.totalTime * 0.98);\n            vibrato += 0.4 * noise.simplex1(this.totalTime * 0.5);\n        }\n        if (this.UIFrequency>this.smoothFrequency) \n            this.smoothFrequency = Math.min(this.smoothFrequency * 1.1, this.UIFrequency);\n        if (this.UIFrequency<this.smoothFrequency) \n            this.smoothFrequency = Math.max(this.smoothFrequency / 1.1, this.UIFrequency);\n        this.oldFrequency = this.newFrequency;\n        this.newFrequency = this.smoothFrequency * (1+vibrato);\n        this.oldTenseness = this.newTenseness;\n        this.newTenseness = this.UITenseness\n            + 0.1*noise.simplex1(this.totalTime*0.46)+0.05*noise.simplex1(this.totalTime*0.36);\n        if (!this.isTouched && this.trombone.alwaysVoice) this.newTenseness += (3-this.UITenseness)*(1-this.intensity);\n        \n        if (this.isTouched || this.trombone.alwaysVoice){\n            this.intensity += 0.13;\n        }\n        this.intensity = Math.clamp(this.intensity, 0, 1);\n    }\n    \n    setupWaveform(lambda) {\n        this.frequency = this.oldFrequency*(1-lambda) + this.newFrequency*lambda;\n        var tenseness = this.oldTenseness*(1-lambda) + this.newTenseness*lambda;\n        this.Rd = 3*(1-tenseness);\n        this.waveformLength = 1.0/this.frequency;\n        \n        var Rd = this.Rd;\n        if (Rd<0.5) Rd = 0.5;\n        if (Rd>2.7) Rd = 2.7;\n        // normalized to time = 1, Ee = 1\n        var Ra = -0.01 + 0.048*Rd;\n        var Rk = 0.224 + 0.118*Rd;\n        var Rg = (Rk/4)*(0.5+1.2*Rk)/(0.11*Rd-Ra*(0.5+1.2*Rk));\n        \n        var Ta = Ra;\n        var Tp = 1 / (2*Rg);\n        var Te = Tp + Tp*Rk; //\n        \n        var epsilon = 1/Ta;\n        var shift = Math.exp(-epsilon * (1-Te));\n        var Delta = 1 - shift; //divide by this to scale RHS\n           \n        var RHSIntegral = (1/epsilon)*(shift - 1) + (1-Te)*shift;\n        RHSIntegral = RHSIntegral/Delta;\n        \n        var totalLowerIntegral = - (Te-Tp)/2 + RHSIntegral;\n        var totalUpperIntegral = -totalLowerIntegral;\n        \n        var omega = Math.PI/Tp;\n        var s = Math.sin(omega*Te);\n        var y = -Math.PI*s*totalUpperIntegral / (Tp*2);\n        var z = Math.log(y);\n        var alpha = z/(Tp/2 - Te);\n        var E0 = -1 / (s*Math.exp(alpha*Te));\n        this.alpha = alpha;\n        this.E0 = E0;\n        this.epsilon = epsilon;\n        this.shift = shift;\n        this.Delta = Delta;\n        this.Te=Te;\n        this.omega = omega;\n    }\n    \n \n    normalizedLFWaveform(t) {     \n        if (t>this.Te) this.output = (-Math.exp(-this.epsilon * (t-this.Te)) + this.shift)/this.Delta;\n        else this.output = this.E0 * Math.exp(this.alpha*t) * Math.sin(this.omega * t);\n     \n        return this.output * this.intensity * this.loudness;\n    }\n}\n\nexport { Glottis };","class TractUI\n{\n\n    constructor(trombone) {\n        this.trombone = trombone;\n        \n        this.originX = 340; \n        this.originY = 449; \n        this.radius = 298; \n        this.scale = 60;\n        this.tongueIndex = 12.9;\n        this.tongueDiameter = 2.43;\n        this.innerTongueControlRadius = 2.05;\n        this.outerTongueControlRadius = 3.5;\n        this.tongueTouch = 0;\n        this.angleScale = 0.64;\n        this.angleOffset = -0.24;\n        this.noseOffset = 0.8;\n        this.gridOffset = 1.7;\n\n        // Jon's UI options\n        this.target = 0.1;\n        this.index = 42;\n        this.radius = 0;\n    }\n    \n    init() {\n        let Tract = this.trombone.Tract;\n\n        this.setRestDiameter();\n        for (var i=0; i<Tract.n; i++) \n        {\n            Tract.diameter[i] = Tract.targetDiameter[i] = Tract.restDiameter[i];\n        }\n\n        this.tongueLowerIndexBound = Tract.bladeStart+2;\n        this.tongueUpperIndexBound = Tract.tipStart-3;\n        this.tongueIndexCentre = 0.5*(this.tongueLowerIndexBound+this.tongueUpperIndexBound);\n    }\n        \n    getIndex(x,y) {\n        let Tract = this.trombone.Tract;\n\n        var xx = x-this.originX; var yy = y-this.originY;\n        var angle = Math.atan2(yy, xx);\n        while (angle> 0) angle -= 2*Math.PI;\n        return (Math.PI + angle - this.angleOffset)*(Tract.lipStart-1) / (this.angleScale*Math.PI);\n    }\n\n    getDiameter(x,y) {\n        var xx = x-this.originX; var yy = y-this.originY;\n        return (this.radius-Math.sqrt(xx*xx + yy*yy))/this.scale;\n    }\n    \n    setRestDiameter() {\n        let Tract = this.trombone.Tract;\n\n        for (var i=Tract.bladeStart; i<Tract.lipStart; i++)\n        {\n            var t = 1.1 * Math.PI*(this.tongueIndex - i)/(Tract.tipStart - Tract.bladeStart);\n            var fixedTongueDiameter = 2+(this.tongueDiameter-2)/1.5;\n            var curve = (1.5-fixedTongueDiameter+this.gridOffset)*Math.cos(t);\n            if (i == Tract.bladeStart-2 || i == Tract.lipStart-1) curve *= 0.8;\n            if (i == Tract.bladeStart || i == Tract.lipStart-2) curve *= 0.94;               \n            Tract.restDiameter[i] = 1.5 - curve;\n        }\n    }\n\n    /**\n     * Sets the lips of the modeled tract to be closed by the specified amount.\n     * @param {number} progress Percentage closed (number between 0 and 1)\n     */\n    SetLipsClosed(progress) {\n\n        let Tract = this.trombone.Tract;\n        \n        this.setRestDiameter();\n        for (var i=0; i<Tract.n; i++) Tract.targetDiameter[i] = Tract.restDiameter[i];    \n\n        // Disable this behavior if the mouth is closed a certain amount\n        //if (progress > 0.8 || progress < 0.1) return;\n        \n        for(let i= this.index - this.radius; i <= this.index + this.radius; i++){\n            if (i > Tract.targetDiameter.length || i < 0) continue;\n            let interp = Math.lerp(Tract.restDiameter[i], this.target, progress);\n            Tract.targetDiameter[i] = interp;\n        }\n    }\n\n\n}\n\nexport { TractUI };","class Tract {\n\n    constructor(trombone) {\n        this.trombone = trombone;\n\n        this.n = 44;\n        this.bladeStart = 10;\n        this.tipStart = 32;\n        this.lipStart = 39;\n        this.R = []; //component going right\n        this.L = []; //component going left\n        this.reflection = [];\n        this.junctionOutputR = [];\n        this.junctionOutputL = [];\n        this.maxAmplitude = [];\n        this.diameter = [];\n        this.restDiameter = [];\n        this.targetDiameter = [];\n        this.newDiameter = [];\n        this.A = [];\n        this.glottalReflection = 0.75;\n        this.lipReflection = -0.85;\n        this.lastObstruction = -1;\n        this.fade = 1.0; //0.9999,\n        this.movementSpeed = 15; //cm per second\n        this.transients = [];\n        this.lipOutput = 0;\n        this.noseOutput = 0;\n        this.velumTarget = 0.01;\n    }\n\n    init() {\n        this.bladeStart = Math.floor(this.bladeStart*this.n/44);\n        this.tipStart = Math.floor(this.tipStart*this.n/44);\n        this.lipStart = Math.floor(this.lipStart*this.n/44);        \n        this.diameter = new Float64Array(this.n);\n        this.restDiameter = new Float64Array(this.n);\n        this.targetDiameter = new Float64Array(this.n);\n        this.newDiameter = new Float64Array(this.n);\n        for (var i=0; i<this.n; i++)\n        {\n            var diameter = 0;\n            if (i<7*this.n/44-0.5) diameter = 0.6;\n            else if (i<12*this.n/44) diameter = 1.1;\n            else diameter = 1.5;\n            this.diameter[i] = this.restDiameter[i] = this.targetDiameter[i] = this.newDiameter[i] = diameter;\n        }\n        this.R = new Float64Array(this.n);\n        this.L = new Float64Array(this.n);\n        this.reflection = new Float64Array(this.n+1);\n        this.newReflection = new Float64Array(this.n+1);\n        this.junctionOutputR = new Float64Array(this.n+1);\n        this.junctionOutputL = new Float64Array(this.n+1);\n        this.A =new Float64Array(this.n);\n        this.maxAmplitude = new Float64Array(this.n);\n        \n        this.noseLength = Math.floor(28*this.n/44)\n        this.noseStart = this.n-this.noseLength + 1;\n        this.noseR = new Float64Array(this.noseLength);\n        this.noseL = new Float64Array(this.noseLength);\n        this.noseJunctionOutputR = new Float64Array(this.noseLength+1);\n        this.noseJunctionOutputL = new Float64Array(this.noseLength+1);        \n        this.noseReflection = new Float64Array(this.noseLength+1);\n        this.noseDiameter = new Float64Array(this.noseLength);\n        this.noseA = new Float64Array(this.noseLength);\n        this.noseMaxAmplitude = new Float64Array(this.noseLength);\n        for (var i=0; i<this.noseLength; i++)\n        {\n            var diameter;\n            var d = 2*(i/this.noseLength);\n            if (d<1) diameter = 0.4+1.6*d;\n            else diameter = 0.5+1.5*(2-d);\n            diameter = Math.min(diameter, 1.9);\n            this.noseDiameter[i] = diameter;\n        }       \n        this.newReflectionLeft = this.newReflectionRight = this.newReflectionNose = 0;\n        this.calculateReflections();        \n        this.calculateNoseReflections();\n        this.noseDiameter[0] = this.velumTarget;\n    }\n    \n    reshapeTract(deltaTime) {\n        var amount = deltaTime * this.movementSpeed; ;    \n        var newLastObstruction = -1;\n        for (var i=0; i<this.n; i++)\n        {\n            var diameter = this.diameter[i];\n            var targetDiameter = this.targetDiameter[i];\n            if (diameter <= 0) newLastObstruction = i;\n            var slowReturn; \n            if (i<this.noseStart) slowReturn = 0.6;\n            else if (i >= this.tipStart) slowReturn = 1.0; \n            else slowReturn = 0.6+0.4*(i-this.noseStart)/(this.tipStart-this.noseStart);\n            this.diameter[i] = Math.moveTowards(diameter, targetDiameter, slowReturn*amount, 2*amount);\n        }\n        if (this.lastObstruction>-1 && newLastObstruction == -1 && this.noseA[0]<0.05)\n        {\n            this.addTransient(this.lastObstruction);\n        }\n        this.lastObstruction = newLastObstruction;\n        \n        amount = deltaTime * this.movementSpeed; \n        this.noseDiameter[0] = Math.moveTowards(this.noseDiameter[0], this.velumTarget, \n                amount*0.25, amount*0.1);\n        this.noseA[0] = this.noseDiameter[0]*this.noseDiameter[0];        \n    }\n    \n    calculateReflections() {\n        for (var i=0; i<this.n; i++) \n        {\n            this.A[i] = this.diameter[i]*this.diameter[i]; //ignoring PI etc.\n        }\n        for (var i=1; i<this.n; i++)\n        {\n            this.reflection[i] = this.newReflection[i];\n            if (this.A[i] == 0) this.newReflection[i] = 0.999; //to prevent some bad behaviour if 0\n            else this.newReflection[i] = (this.A[i-1]-this.A[i]) / (this.A[i-1]+this.A[i]); \n        }\n        \n        //now at junction with nose\n\n        this.reflectionLeft = this.newReflectionLeft;\n        this.reflectionRight = this.newReflectionRight;\n        this.reflectionNose = this.newReflectionNose;\n        var sum = this.A[this.noseStart]+this.A[this.noseStart+1]+this.noseA[0];\n        this.newReflectionLeft = (2*this.A[this.noseStart]-sum)/sum;\n        this.newReflectionRight = (2*this.A[this.noseStart+1]-sum)/sum;   \n        this.newReflectionNose = (2*this.noseA[0]-sum)/sum;      \n    }\n\n    calculateNoseReflections() {\n        for (var i=0; i<this.noseLength; i++) \n        {\n            this.noseA[i] = this.noseDiameter[i]*this.noseDiameter[i]; \n        }\n        for (var i=1; i<this.noseLength; i++)\n        {\n            this.noseReflection[i] = (this.noseA[i-1]-this.noseA[i]) / (this.noseA[i-1]+this.noseA[i]); \n        }\n    }\n    \n    runStep(glottalOutput, turbulenceNoise, lambda) {\n        var updateAmplitudes = (Math.random()<0.1);\n    \n        //mouth\n        this.processTransients();\n        this.addTurbulenceNoise(turbulenceNoise);\n        \n        //this.glottalReflection = -0.8 + 1.6 * Glottis.newTenseness;\n        this.junctionOutputR[0] = this.L[0] * this.glottalReflection + glottalOutput;\n        this.junctionOutputL[this.n] = this.R[this.n-1] * this.lipReflection; \n        \n        for (var i=1; i<this.n; i++)\n        {\n            var r = this.reflection[i] * (1-lambda) + this.newReflection[i]*lambda;\n            var w = r * (this.R[i-1] + this.L[i]);\n            this.junctionOutputR[i] = this.R[i-1] - w;\n            this.junctionOutputL[i] = this.L[i] + w;\n        }    \n        \n        //now at junction with nose\n        var i = this.noseStart;\n        var r = this.newReflectionLeft * (1-lambda) + this.reflectionLeft*lambda;\n        this.junctionOutputL[i] = r*this.R[i-1]+(1+r)*(this.noseL[0]+this.L[i]);\n        r = this.newReflectionRight * (1-lambda) + this.reflectionRight*lambda;\n        this.junctionOutputR[i] = r*this.L[i]+(1+r)*(this.R[i-1]+this.noseL[0]);     \n        r = this.newReflectionNose * (1-lambda) + this.reflectionNose*lambda;\n        this.noseJunctionOutputR[0] = r*this.noseL[0]+(1+r)*(this.L[i]+this.R[i-1]);\n         \n        for (var i=0; i<this.n; i++)\n        {          \n            this.R[i] = this.junctionOutputR[i]*0.999;\n            this.L[i] = this.junctionOutputL[i+1]*0.999; \n            \n            //this.R[i] = Math.clamp(this.junctionOutputR[i] * this.fade, -1, 1);\n            //this.L[i] = Math.clamp(this.junctionOutputL[i+1] * this.fade, -1, 1);    \n            \n            if (updateAmplitudes)\n            {   \n                var amplitude = Math.abs(this.R[i]+this.L[i]);\n                if (amplitude > this.maxAmplitude[i]) this.maxAmplitude[i] = amplitude;\n                else this.maxAmplitude[i] *= 0.999;\n            }\n        }\n\n        this.lipOutput = this.R[this.n-1];\n        \n        //nose     \n        this.noseJunctionOutputL[this.noseLength] = this.noseR[this.noseLength-1] * this.lipReflection; \n        \n        for (var i=1; i<this.noseLength; i++)\n        {\n            var w = this.noseReflection[i] * (this.noseR[i-1] + this.noseL[i]);\n            this.noseJunctionOutputR[i] = this.noseR[i-1] - w;\n            this.noseJunctionOutputL[i] = this.noseL[i] + w;\n        }\n        \n        for (var i=0; i<this.noseLength; i++)\n        {\n            this.noseR[i] = this.noseJunctionOutputR[i] * this.fade;\n            this.noseL[i] = this.noseJunctionOutputL[i+1] * this.fade;   \n            \n            //this.noseR[i] = Math.clamp(this.noseJunctionOutputR[i] * this.fade, -1, 1);\n            //this.noseL[i] = Math.clamp(this.noseJunctionOutputL[i+1] * this.fade, -1, 1);    \n            \n            if (updateAmplitudes)\n            {\n                var amplitude = Math.abs(this.noseR[i]+this.noseL[i]);\n                if (amplitude > this.noseMaxAmplitude[i]) this.noseMaxAmplitude[i] = amplitude;\n                else this.noseMaxAmplitude[i] *= 0.999;\n            }\n        }\n\n        this.noseOutput = this.noseR[this.noseLength-1];\n       \n    }\n    \n    finishBlock() {         \n        this.reshapeTract(this.trombone.AudioSystem.blockTime);\n        this.calculateReflections();\n    }\n    \n    addTransient(position) {\n        var trans = {}\n        trans.position = position;\n        trans.timeAlive = 0;\n        trans.lifeTime = 0.2;\n        trans.strength = 0.3;\n        trans.exponent = 200;\n        this.transients.push(trans);\n    }\n    \n    processTransients() {\n        for (var i = 0; i < this.transients.length; i++)  \n        {\n            var trans = this.transients[i];\n            var amplitude = trans.strength * Math.pow(2, -trans.exponent * trans.timeAlive);\n            this.R[trans.position] += amplitude/2;\n            this.L[trans.position] += amplitude/2;\n            trans.timeAlive += 1.0/(this.trombone.sampleRate*2);\n        }\n        for (var i=this.transients.length-1; i>=0; i--)\n        {\n            var trans = this.transients[i];\n            if (trans.timeAlive > trans.lifeTime)\n            {\n                this.transients.splice(i,1);\n            }\n        }\n    }\n    \n    addTurbulenceNoise(turbulenceNoise) {\n        // for (var j=0; j<UI.touchesWithMouse.length; j++)\n        // {\n        //     var touch = UI.touchesWithMouse[j];\n        //     if (touch.index<2 || touch.index>Tract.n) continue;\n        //     if (touch.diameter<=0) continue;            \n        //     var intensity = touch.fricative_intensity;\n        //     if (intensity == 0) continue;\n        //     this.addTurbulenceNoiseAtIndex(0.66*turbulenceNoise*intensity, touch.index, touch.diameter);\n        // }\n    }\n    \n    addTurbulenceNoiseAtIndex(turbulenceNoise, index, diameter) {   \n        var i = Math.floor(index);\n        var delta = index - i;\n        turbulenceNoise *= this.trombone.Glottis.getNoiseModulator();\n        var thinness0 = Math.clamp(8*(0.7-diameter),0,1);\n        var openness = Math.clamp(30*(diameter-0.3), 0, 1);\n        var noise0 = turbulenceNoise*(1-delta)*thinness0*openness;\n        var noise1 = turbulenceNoise*delta*thinness0*openness;\n        this.R[i+1] += noise0/2;\n        this.L[i+1] += noise0/2;\n        this.R[i+2] += noise1/2;\n        this.L[i+2] += noise1/2;\n    }\n};\n\nexport { Tract };","Math.clamp = function(number, min, max) {\n    if (number<min) return min;\n    else if (number>max) return max;\n    else return number;\n}\n\nMath.moveTowards = function(current, target, amount) {\n    if (current<target) return Math.min(current+amount, target);\n    else return Math.max(current-amount, target);\n}\n\nMath.moveTowards = function(current, target, amountUp, amountDown) {\n    if (current<target) return Math.min(current+amountUp, target);\n    else return Math.max(current-amountDown, target);\n}\n\nMath.gaussian = function() {\n    var s = 0;\n    for (var c=0; c<16; c++) s+=Math.random();\n    return (s-8)/4;\n}\n\nMath.lerp = function(a, b, t) {\n    return a + (b - a) * t;\n}","/*\n * A speed-improved perlin and simplex noise algorithms for 2D.\n *\n * Based on example code by Stefan Gustavson (stegu@itn.liu.se).\n * Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\n * Better rank ordering method by Stefan Gustavson in 2012.\n * Converted to Javascript by Joseph Gentle.\n *\n * Version 2012-03-09\n *\n * This code was placed in the public domain by its original author,\n * Stefan Gustavson. You may use it as you see fit, but\n * attribution is appreciated.\n *\n */\n\nclass Grad {\n    constructor(x, y, z){\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    dot2(x, y){\n        return this.x*x + this.y*y;\n    }\n\n    dot3(x, y, z) {\n        return this.x*x + this.y*y + this.z*z;\n    };\n}\n\nclass Noise {\n    constructor() {\n        this.grad3 = [new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),\n                      new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),\n                      new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)];\n        this.p = [151,160,137,91,90,15,\n            131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,\n            190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,\n            88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,\n            77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,\n            102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,\n            135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,\n            5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,\n            223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,\n            129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,\n            251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,\n            49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,\n            138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];\n\n        // To remove the need for index wrapping, double the permutation table length\n        this.perm = new Array(512);\n        this.gradP = new Array(512);\n\n        this.seed(Date.now());\n    }\n\n    seed(seed) {\n        if(seed > 0 && seed < 1) {\n            // Scale the seed out\n            seed *= 65536;\n        }\n\n        seed = Math.floor(seed);\n        if(seed < 256) {\n            seed |= seed << 8;\n        }\n\n        for(var i = 0; i < 256; i++) {\n            var v;\n            if (i & 1) {\n                v = this.p[i] ^ (seed & 255);\n            } else {\n                v = this.p[i] ^ ((seed>>8) & 255);\n            }\n\n            this.perm[i] = this.perm[i + 256] = v;\n            this.gradP[i] = this.gradP[i + 256] = this.grad3[v % 12];\n        }\n    };\n\n    // 2D simplex noise\n    simplex2(xin, yin) {\n        // Skewing and unskewing factors for 2, 3, and 4 dimensions\n        var F2 = 0.5*(Math.sqrt(3)-1);\n        var G2 = (3-Math.sqrt(3))/6;\n\n        var F3 = 1/3;\n        var G3 = 1/6;\n\n        var n0, n1, n2; // Noise contributions from the three corners\n        // Skew the input space to determine which simplex cell we're in\n        var s = (xin+yin)*F2; // Hairy factor for 2D\n        var i = Math.floor(xin+s);\n        var j = Math.floor(yin+s);\n        var t = (i+j)*G2;\n        var x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\n        var y0 = yin-j+t;\n        // For the 2D case, the simplex shape is an equilateral triangle.\n        // Determine which simplex we are in.\n        var i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\n        if(x0>y0) { // lower triangle, XY order: (0,0)->(1,0)->(1,1)\n            i1=1; j1=0;\n        } else {    // upper triangle, YX order: (0,0)->(0,1)->(1,1)\n            i1=0; j1=1;\n        }\n        // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n        // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n        // c = (3-sqrt(3))/6\n        var x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n        var y1 = y0 - j1 + G2;\n        var x2 = x0 - 1 + 2 * G2; // Offsets for last corner in (x,y) unskewed coords\n        var y2 = y0 - 1 + 2 * G2;\n        // Work out the hashed gradient indices of the three simplex corners\n        i &= 255;\n        j &= 255;\n        var gi0 = this.gradP[i+this.perm[j]];\n        var gi1 = this.gradP[i+i1+this.perm[j+j1]];\n        var gi2 = this.gradP[i+1+this.perm[j+1]];\n        // Calculate the contribution from the three corners\n        var t0 = 0.5 - x0*x0-y0*y0;\n        if(t0<0) {\n            n0 = 0;\n        } else {\n            t0 *= t0;\n            n0 = t0 * t0 * gi0.dot2(x0, y0);  // (x,y) of grad3 used for 2D gradient\n        }\n        var t1 = 0.5 - x1*x1-y1*y1;\n        if(t1<0) {\n            n1 = 0;\n        } else {\n            t1 *= t1;\n            n1 = t1 * t1 * gi1.dot2(x1, y1);\n        }\n        var t2 = 0.5 - x2*x2-y2*y2;\n        if(t2<0) {\n            n2 = 0;\n        } else {\n            t2 *= t2;\n            n2 = t2 * t2 * gi2.dot2(x2, y2);\n        }\n        // Add contributions from each corner to get the final noise value.\n        // The result is scaled to return values in the interval [-1,1].\n        return 70 * (n0 + n1 + n2);\n    }\n    \n    simplex1(x){\n        return this.simplex2(x*1.2, -x*0.7);\n    }\n\n}\n\nconst singleton = new Noise();\nObject.freeze(singleton);\n\nexport default singleton;","import \"./math-extensions.js\";\n\nimport { AudioSystem } from \"./components/audio-system.js\";\nimport { Glottis } from \"./components/glottis.js\";\nimport { Tract } from \"./components/tract.js\";\nimport { TractUI } from \"./components/tract-ui.js\";\n\nclass PinkTrombone {\n    constructor(){\n\n        this.sampleRate = 0;\n        this.time = 0;\n        this.alwaysVoice = true;\n        this.autoWobble = true;\n        this.noiseFreq = 500;\n        this.noiseQ = 0.7;\n\n        this.AudioSystem = new AudioSystem(this);\n        this.AudioSystem.init();\n        \n        this.Glottis = new Glottis(this);\n        this.Glottis.init();\n\n        this.Tract = new Tract(this);\n        this.Tract.init();\n\n        this.TractUI = new TractUI(this);\n        this.TractUI.init();\n\n        //this.StartAudio();\n        //this.SetMute(true);\n    }\n\n    StartAudio() {\n        this.muted = false;\n        this.AudioSystem.startSound();\n    }\n\n    SetMute(doMute) {\n        doMute ? this.AudioSystem.mute() : this.AudioSystem.unmute();\n        this.muted = doMute;\n    }\n\n    ToggleMute() {\n        this.SetMute(!this.muted);\n    }\n\n}\n\nexport { PinkTrombone };","class ModelLoader {\n\n    /**\n     * Loads a model asynchronously. Expects an object containing\n     * the path to the object, the relative path of the OBJ file,\n     * and the relative path of the MTL file.\n     * \n     * An example:\n     * let modelInfo = {\n     *      path: \"../resources/obj/\",\n     *      objFile: \"test.obj\",\n     *      mtlFile: \"test.mtl\"\n     * }\n     */\n    static LoadOBJ(modelInfo, loadedCallback) {\n\n        var onProgress = function( xhr ) {\n            if ( xhr.lengthComputable ) {\n                var percentComplete = xhr.loaded / xhr.total * 100;\n                console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\n            }\n        };\n        var onError = function( xhr ) {\n        };\n\n        var mtlLoader = new THREE.MTLLoader();\n        mtlLoader.setPath( modelInfo.path );\n\n        mtlLoader.load( modelInfo.mtlFile, ( materials ) => {\n            materials.preload();\n            var objLoader = new THREE.OBJLoader();\n            objLoader.setMaterials( materials );\n            objLoader.setPath( modelInfo.path );\n            objLoader.load( modelInfo.objFile, ( object ) => {\n                loadedCallback(object);\n            }, onProgress, onError );\n            \n        });\n\n    }\n\n    static LoadJSON(path, loadedCallback) {\n\n        var onProgress = function( xhr ) {\n            if ( xhr.lengthComputable ) {\n                var percentComplete = xhr.loaded / xhr.total * 100;\n                console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\n            }\n        };\n        var onError = function( xhr ) {\n        };\n\n        var loader = new THREE.JSONLoader();\n        loader.load( path, ( geometry, materials ) => {\n            // Apply skinning to each material so the verts are affected by bone movement\n            for(let mat of materials){\n                mat.skinning = true;\n            }\n            let mesh = new THREE.SkinnedMesh( geometry, new THREE.MultiMaterial( materials ) );\n            mesh.name = \"Jon\";\n            loadedCallback(mesh);\n        }, onProgress, onError);\n    }\n\n    static LoadFBX(path, loadedCallback) {\n        let manager = new THREE.LoadingManager();\n        manager.onProgress = function( item, loaded, total ) {\n            console.log( item, loaded, total );\n        };\n\n        var onProgress = function( xhr ) {\n            if ( xhr.lengthComputable ) {\n                var percentComplete = xhr.loaded / xhr.total * 100;\n                console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\n            }\n        };\n        var onError = function( xhr ) {\n        };\n\n        var loader = new THREE.FBXLoader( manager );\n        loader.load( path, ( object ) => {\n            loadedCallback(object);\n        }, onProgress, onError );\n    }\n\n}\n\nexport { ModelLoader };","class Detector {\n\n    //http://stackoverflow.com/questions/11871077/proper-way-to-detect-webgl-support\n    static HasWebGL() {\n        if (!!window.WebGLRenderingContext) {\n            var canvas = document.createElement(\"canvas\"),\n                    names = [\"webgl\", \"experimental-webgl\", \"moz-webgl\", \"webkit-3d\"],\n                context = false;\n\n            for(var i=0;i<4;i++) {\n                try {\n                    context = canvas.getContext(names[i]);\n                    if (context && typeof context.getParameter == \"function\") {\n                        // WebGL is enabled\n                        return true;\n                    }\n                } catch(e) {}\n            }\n\n            // WebGL is supported, but disabled\n            return false;\n        }\n        // WebGL not supported\n        return false;\n    }\n\n    static GetErrorHTML(message = null){\n        if(message == null){\n            message = `Your graphics card does not seem to support \n                        <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\">WebGL</a>. <br>\n                        Find out how to get it <a href=\"http://get.webgl.org/\">here</a>.`;\n        }\n        return `\n        <div class=\"no-webgl-support\">\n        <p style=\"text-align: center;\">${message}</p>\n        </div>\n        `\n    }\n\n}\n\nexport { Detector };","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.MidiConvert=e():t.MidiConvert=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p=\"\",e(0)}([function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(7),i=n(2),a={instrumentByPatchID:i.instrumentByPatchID,instrumentFamilyByID:i.instrumentFamilyByID,parse:function(t){return(new r.Midi).decode(t)},load:function(t,e){var n=(new r.Midi).load(t);return e&&n.then(e),n},create:function(){return new r.Midi}};e[\"default\"]=a,t.exports=a},function(t,e){\"use strict\";function n(t){return t.replace(/\\u0000/g,\"\")}function r(t,e){return 60/e.bpm*(t/e.PPQ)}function i(t){return\"number\"==typeof t}function a(t){return\"string\"==typeof t}function o(t){var e=[\"C\",\"C#\",\"D\",\"D#\",\"E\",\"F\",\"F#\",\"G\",\"G#\",\"A\",\"A#\",\"B\"],n=Math.floor(t/12)-1,r=t%12;return e[r]+n}var s=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i;return function(e){return a(e)&&t.test(e)}}(),u=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,e={cbb:-2,cb:-1,c:0,\"c#\":1,cx:2,dbb:0,db:1,d:2,\"d#\":3,dx:4,ebb:2,eb:3,e:4,\"e#\":5,ex:6,fbb:3,fb:4,f:5,\"f#\":6,fx:7,gbb:5,gb:6,g:7,\"g#\":8,gx:9,abb:7,ab:8,a:9,\"a#\":10,ax:11,bbb:9,bb:10,b:11,\"b#\":12,bx:13};return function(n){var r=t.exec(n),i=r[1],a=r[2],o=e[i.toLowerCase()];return o+12*(parseInt(a)+1)}}();t.exports={cleanName:n,ticksToSeconds:r,isString:a,isNumber:i,isPitch:s,midiToPitch:o,pitchToMidi:u}},function(t,e){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});e.instrumentByPatchID=[\"acoustic grand piano\",\"bright acoustic piano\",\"electric grand piano\",\"honky-tonk piano\",\"electric piano 1\",\"electric piano 2\",\"harpsichord\",\"clavi\",\"celesta\",\"glockenspiel\",\"music box\",\"vibraphone\",\"marimba\",\"xylophone\",\"tubular bells\",\"dulcimer\",\"drawbar organ\",\"percussive organ\",\"rock organ\",\"church organ\",\"reed organ\",\"accordion\",\"harmonica\",\"tango accordion\",\"acoustic guitar (nylon)\",\"acoustic guitar (steel)\",\"electric guitar (jazz)\",\"electric guitar (clean)\",\"electric guitar (muted)\",\"overdriven guitar\",\"distortion guitar\",\"guitar harmonics\",\"acoustic bass\",\"electric bass (finger)\",\"electric bass (pick)\",\"fretless bass\",\"slap bass 1\",\"slap bass 2\",\"synth bass 1\",\"synth bass 2\",\"violin\",\"viola\",\"cello\",\"contrabass\",\"tremolo strings\",\"pizzicato strings\",\"orchestral harp\",\"timpani\",\"string ensemble 1\",\"string ensemble 2\",\"synthstrings 1\",\"synthstrings 2\",\"choir aahs\",\"voice oohs\",\"synth voice\",\"orchestra hit\",\"trumpet\",\"trombone\",\"tuba\",\"muted trumpet\",\"french horn\",\"brass section\",\"synthbrass 1\",\"synthbrass 2\",\"soprano sax\",\"alto sax\",\"tenor sax\",\"baritone sax\",\"oboe\",\"english horn\",\"bassoon\",\"clarinet\",\"piccolo\",\"flute\",\"recorder\",\"pan flute\",\"blown bottle\",\"shakuhachi\",\"whistle\",\"ocarina\",\"lead 1 (square)\",\"lead 2 (sawtooth)\",\"lead 3 (calliope)\",\"lead 4 (chiff)\",\"lead 5 (charang)\",\"lead 6 (voice)\",\"lead 7 (fifths)\",\"lead 8 (bass + lead)\",\"pad 1 (new age)\",\"pad 2 (warm)\",\"pad 3 (polysynth)\",\"pad 4 (choir)\",\"pad 5 (bowed)\",\"pad 6 (metallic)\",\"pad 7 (halo)\",\"pad 8 (sweep)\",\"fx 1 (rain)\",\"fx 2 (soundtrack)\",\"fx 3 (crystal)\",\"fx 4 (atmosphere)\",\"fx 5 (brightness)\",\"fx 6 (goblins)\",\"fx 7 (echoes)\",\"fx 8 (sci-fi)\",\"sitar\",\"banjo\",\"shamisen\",\"koto\",\"kalimba\",\"bag pipe\",\"fiddle\",\"shanai\",\"tinkle bell\",\"agogo\",\"steel drums\",\"woodblock\",\"taiko drum\",\"melodic tom\",\"synth drum\",\"reverse cymbal\",\"guitar fret noise\",\"breath noise\",\"seashore\",\"bird tweet\",\"telephone ring\",\"helicopter\",\"applause\",\"gunshot\"],e.instrumentFamilyByID=[\"piano\",\"chromatic percussion\",\"organ\",\"guitar\",\"bass\",\"strings\",\"ensemble\",\"brass\",\"reed\",\"pipe\",\"synth lead\",\"synth pad\",\"synth effects\",\"ethnic\",\"percussive\",\"sound effects\"]},function(t,e){\"use strict\";function n(t,e){var n=0,r=t.length,i=r;if(r>0&&t[r-1].time<=e)return r-1;for(;i>n;){var a=Math.floor(n+(i-n)/2),o=t[a],s=t[a+1];if(o.time===e){for(var u=a;u<t.length;u++){var c=t[u];c.time===e&&(a=u)}return a}if(o.time<e&&s.time>e)return a;o.time>e?i=a:o.time<e&&(n=a+1)}return-1}function r(t,e){if(t.length){var r=n(t,e.time);t.splice(r+1,0,e)}else t.push(e)}Object.defineProperty(e,\"__esModule\",{value:!0}),e.BinaryInsert=r},function(t,e){\"use strict\";function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i={1:\"modulationWheel\",2:\"breath\",4:\"footController\",5:\"portamentoTime\",7:\"volume\",8:\"balance\",10:\"pan\",64:\"sustain\",65:\"portamentoTime\",66:\"sostenuto\",67:\"softPedal\",68:\"legatoFootswitch\",84:\"portamentoContro\"},a=function(){function t(e,r,i){n(this,t),this.number=e,this.time=r,this.value=i}return r(t,[{key:\"name\",get:function(){return i.hasOwnProperty(this.number)?i[this.number]:void 0}}]),t}();e.Control=a},function(t,e){\"use strict\";function n(t){for(var e={PPQ:t.header.ticksPerBeat},n=0;n<t.tracks.length;n++)for(var r=t.tracks[n],i=0;i<r.length;i++){var a=r[i];\"meta\"===a.type&&(\"timeSignature\"===a.subtype?e.timeSignature=[a.numerator,a.denominator]:\"setTempo\"===a.subtype&&(e.bpm||(e.bpm=6e7/a.microsecondsPerBeat)))}return e.bpm=e.bpm||120,e}Object.defineProperty(e,\"__esModule\",{value:!0}),e.parseHeader=n},function(t,e){\"use strict\";function n(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(r.length>i)return!0}return!1}function r(t,e,n){for(var r=0,i=1/0,a=0;a<t.length;a++){var o=t[a],s=e[a];o[s]&&o[s].time<i&&(r=a,i=o[s].time)}n[r](t[r][e[r]]),e[r]+=1}function i(){for(var t=arguments.length,e=Array(t),i=0;t>i;i++)e[i]=arguments[i];for(var a=e.filter(function(t,e){return e%2===0}),o=new Uint32Array(a.length),s=e.filter(function(t,e){return e%2===1});n(a,o);)r(a,o,s)}Object.defineProperty(e,\"__esModule\",{value:!0}),e.Merge=i},function(t,e,n){\"use strict\";function r(t){return t&&t.__esModule?t:{\"default\":t}}function i(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0}),e.Midi=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(11),s=r(o),u=n(10),c=r(u),h=n(1),f=r(h),d=n(9),l=n(5),p=function(){function t(){i(this,t),this.header={bpm:120,timeSignature:[4,4],PPQ:480},this.tracks=[]}return a(t,[{key:\"load\",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"GET\";return new Promise(function(i,a){var o=new XMLHttpRequest;o.open(r,t),o.responseType=\"arraybuffer\",o.addEventListener(\"load\",function(){4===o.readyState&&200===o.status?i(e.decode(o.response)):a(o.status)}),o.addEventListener(\"error\",a),o.send(n)})}},{key:\"decode\",value:function(t){var e=this;if(t instanceof ArrayBuffer){var n=new Uint8Array(t);t=String.fromCharCode.apply(null,n)}var r=(0,s[\"default\"])(t);return this.header=(0,l.parseHeader)(r),this.tracks=[],r.tracks.forEach(function(t){var n=new d.Track;e.tracks.push(n);var r=0;t.forEach(function(t){r+=f[\"default\"].ticksToSeconds(t.deltaTime,e.header),\"meta\"===t.type&&\"trackName\"===t.subtype?n.name=f[\"default\"].cleanName(t.text):\"noteOn\"===t.subtype?n.noteOn(t.noteNumber,r,t.velocity/127):\"noteOff\"===t.subtype?n.noteOff(t.noteNumber,r):\"controller\"===t.subtype&&t.controllerType?n.cc(t.controllerType,r,t.value/127):\"meta\"===t.type&&\"instrumentName\"===t.subtype?n.instrument=t.text:\"channel\"===t.type&&\"programChange\"===t.subtype&&n.patch(t.programNumber)})}),this}},{key:\"encode\",value:function(){var t=this,e=new c[\"default\"].File({ticks:this.header.PPQ});return this.tracks.forEach(function(n,r){var i=e.addTrack();i.setTempo(t.bpm),n.encode(i,t.header)}),e.toBytes()}},{key:\"toArray\",value:function(){for(var t=this.encode(),e=new Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}},{key:\"track\",value:function e(t){var e=new d.Track(t);return this.tracks.push(e),e}},{key:\"get\",value:function(t){return f[\"default\"].isNumber(t)?this.tracks[t]:this.tracks.find(function(e){return e.name===t})}},{key:\"slice\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration,r=new t;return r.header=this.header,r.tracks=this.tracks.map(function(t){return t.slice(e,n)}),r}},{key:\"startTime\",get:function(){var t=this.tracks.map(function(t){return t.startTime});return Math.min.apply(Math,t)}},{key:\"bpm\",get:function(){return this.header.bpm},set:function(t){var e=this.header.bpm;this.header.bpm=t;var n=e/t;this.tracks.forEach(function(t){return t.scale(n)})}},{key:\"timeSignature\",get:function(){return this.header.timeSignature},set:function(t){this.header.timeSignature=timeSignature}},{key:\"duration\",get:function(){var t=this.tracks.map(function(t){return t.duration});return Math.max.apply(Math,t)}}]),t}();e.Midi=p},function(t,e,n){\"use strict\";function r(t){return t&&t.__esModule?t:{\"default\":t}}function i(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0}),e.Note=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),s=r(o),u=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(i(this,t),this.midi,s[\"default\"].isNumber(e))this.midi=e;else{if(!s[\"default\"].isPitch(e))throw new Error(\"the midi value must either be in Pitch Notation (e.g. C#4) or a midi value\");this.name=e}this.time=n,this.duration=r,this.velocity=a}return a(t,[{key:\"match\",value:function(t){return s[\"default\"].isNumber(t)?this.midi===t:s[\"default\"].isPitch(t)?this.name.toLowerCase()===t.toLowerCase():void 0}},{key:\"toJSON\",value:function(){return{name:this.name,midi:this.midi,time:this.time,velocity:this.velocity,duration:this.duration}}},{key:\"name\",get:function(){return s[\"default\"].midiToPitch(this.midi)},set:function(t){this.midi=s[\"default\"].pitchToMidi(t)}},{key:\"noteOn\",get:function(){return this.time},set:function(t){this.time=t}},{key:\"noteOff\",get:function(){return this.time+this.duration},set:function(t){this.duration=t-this.time}}]),t}();e.Note=u},function(t,e,n){\"use strict\";function r(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0}),e.Track=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),o=n(4),s=n(6),u=n(8),c=n(2),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;r(this,t),this.name=e,this.notes=[],this.controlChanges={},this.instrumentNumber=n}return i(t,[{key:\"note\",value:function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=new u.Note(t,n,r,i);return(0,a.BinaryInsert)(this.notes,e),this}},{key:\"noteOn\",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new u.Note(t,e,0,n);return(0,a.BinaryInsert)(this.notes,r),this}},{key:\"noteOff\",value:function(t,e){for(var n=0;n<this.notes.length;n++){var r=this.notes[n];if(r.match(t)&&0===r.duration){r.noteOff=e;break}}return this}},{key:\"cc\",value:function n(t,e,r){this.controlChanges.hasOwnProperty(t)||(this.controlChanges[t]=[]);var n=new o.Control(t,e,r);return(0,a.BinaryInsert)(this.controlChanges[t],n),this}},{key:\"patch\",value:function(t){return this.instrumentNumber=t,this}},{key:\"scale\",value:function(t){return this.notes.forEach(function(e){e.time*=t,e.duration*=t}),this}},{key:\"slice\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration,r=Math.max(this.notes.findIndex(function(t){return t.time>=e}),0),i=this.notes.findIndex(function(t){return t.noteOff>=n})+1,a=new t(this.name);return a.notes=this.notes.slice(r,i),a.notes.forEach(function(t){return t.time=t.time-e}),a}},{key:\"encode\",value:function(t,e){function n(t){var e=Math.floor(r*t),n=Math.max(e-i,0);return i=e,n}var r=e.PPQ/(60/e.bpm),i=0,a=0;-1!==this.instrumentNumber&&t.instrument(a,this.instrumentNumber),(0,s.Merge)(this.noteOns,function(e){t.addNoteOn(a,e.name,n(e.time),Math.floor(127*e.velocity))},this.noteOffs,function(e){t.addNoteOff(a,e.name,n(e.time))})}},{key:\"noteOns\",get:function(){var t=[];return this.notes.forEach(function(e){t.push({time:e.noteOn,midi:e.midi,name:e.name,velocity:e.velocity})}),t}},{key:\"noteOffs\",get:function(){var t=[];return this.notes.forEach(function(e){t.push({time:e.noteOff,midi:e.midi,name:e.name})}),t}},{key:\"length\",get:function(){return this.notes.length}},{key:\"startTime\",get:function(){if(this.notes.length){var t=this.notes[0];return t.noteOn}return 0}},{key:\"duration\",get:function(){if(this.notes.length){var t=this.notes[this.notes.length-1];return t.noteOff}return 0}},{key:\"instrument\",get:function(){return c.instrumentByPatchID[this.instrumentNumber]},set:function(t){var e=c.instrumentByPatchID.indexOf(t);-1!==e&&(this.instrumentNumber=e)}},{key:\"instrumentFamily\",get:function(){return c.instrumentFamilyByID[Math.floor(this.instrumentNumber/8)]}}]),t}();e.Track=h},function(t,e,n){(function(t){var n={};!function(t){var e=t.DEFAULT_VOLUME=90,n=(t.DEFAULT_DURATION=128,t.DEFAULT_CHANNEL=0,{midi_letter_pitches:{a:21,b:23,c:12,d:14,e:16,f:17,g:19},midiPitchFromNote:function(t){var e=/([a-g])(#+|b+)?([0-9]+)$/i.exec(t),r=e[1].toLowerCase(),i=e[2]||\"\",a=parseInt(e[3],10);return 12*a+n.midi_letter_pitches[r]+(\"#\"==i.substr(0,1)?1:-1)*i.length},ensureMidiPitch:function(t){return\"number\"!=typeof t&&/[^0-9]/.test(t)?n.midiPitchFromNote(t):parseInt(t,10)},midi_pitches_letter:{12:\"c\",13:\"c#\",14:\"d\",15:\"d#\",16:\"e\",17:\"f\",18:\"f#\",19:\"g\",20:\"g#\",21:\"a\",22:\"a#\",23:\"b\"},midi_flattened_notes:{\"a#\":\"bb\",\"c#\":\"db\",\"d#\":\"eb\",\"f#\":\"gb\",\"g#\":\"ab\"},noteFromMidiPitch:function(t,e){var r,i=0,a=t,e=e||!1;return t>23&&(i=Math.floor(t/12)-1,a=t-12*i),r=n.midi_pitches_letter[a],e&&r.indexOf(\"#\")>0&&(r=n.midi_flattened_notes[r]),r+i},mpqnFromBpm:function(t){var e=Math.floor(6e7/t),n=[];do n.unshift(255&e),e>>=8;while(e);for(;n.length<3;)n.push(0);return n},bpmFromMpqn:function(t){var e=t;if(\"undefined\"!=typeof t[0]){e=0;for(var n=0,r=t.length-1;r>=0;++n,--r)e|=t[n]<<r}return Math.floor(6e7/t)},codes2Str:function(t){return String.fromCharCode.apply(null,t)},str2Bytes:function(t,e){if(e)for(;t.length/2<e;)t=\"0\"+t;for(var n=[],r=t.length-1;r>=0;r-=2){var i=0===r?t[r]:t[r-1]+t[r];n.unshift(parseInt(i,16))}return n},translateTickTime:function(t){for(var e=127&t;t>>=7;)e<<=8,e|=127&t|128;for(var n=[];;){if(n.push(255&e),!(128&e))break;e>>=8}return n}}),r=function(t){return this?void(!t||null===t.type&&void 0===t.type||null===t.channel&&void 0===t.channel||null===t.param1&&void 0===t.param1||(this.setTime(t.time),this.setType(t.type),this.setChannel(t.channel),this.setParam1(t.param1),this.setParam2(t.param2))):new r(t)};r.NOTE_OFF=128,r.NOTE_ON=144,r.AFTER_TOUCH=160,r.CONTROLLER=176,r.PROGRAM_CHANGE=192,r.CHANNEL_AFTERTOUCH=208,r.PITCH_BEND=224,r.prototype.setTime=function(t){this.time=n.translateTickTime(t||0)},r.prototype.setType=function(t){if(t<r.NOTE_OFF||t>r.PITCH_BEND)throw new Error(\"Trying to set an unknown event: \"+t);this.type=t},r.prototype.setChannel=function(t){if(0>t||t>15)throw new Error(\"Channel is out of bounds.\");this.channel=t},r.prototype.setParam1=function(t){this.param1=t},r.prototype.setParam2=function(t){this.param2=t},r.prototype.toBytes=function(){var t=[],e=this.type|15&this.channel;return t.push.apply(t,this.time),t.push(e),t.push(this.param1),void 0!==this.param2&&null!==this.param2&&t.push(this.param2),t};var i=function(t){if(!this)return new i(t);this.setTime(t.time),this.setType(t.type),this.setData(t.data)};i.SEQUENCE=0,i.TEXT=1,i.COPYRIGHT=2,i.TRACK_NAME=3,i.INSTRUMENT=4,i.LYRIC=5,i.MARKER=6,i.CUE_POINT=7,i.CHANNEL_PREFIX=32,i.END_OF_TRACK=47,i.TEMPO=81,i.SMPTE=84,i.TIME_SIG=88,i.KEY_SIG=89,i.SEQ_EVENT=127,i.prototype.setTime=function(t){this.time=n.translateTickTime(t||0)},i.prototype.setType=function(t){this.type=t},i.prototype.setData=function(t){this.data=t},i.prototype.toBytes=function(){if(!this.type)throw new Error(\"Type for meta-event not specified.\");var t=[];if(t.push.apply(t,this.time),t.push(255,this.type),Array.isArray(this.data))t.push(this.data.length),t.push.apply(t,this.data);else if(\"number\"==typeof this.data)t.push(1,this.data);else if(null!==this.data&&void 0!==this.data){t.push(this.data.length);var e=this.data.split(\"\").map(function(t){return t.charCodeAt(0)});t.push.apply(t,e)}else t.push(0);return t};var a=function(t){if(!this)return new a(t);var e=t||{};this.events=e.events||[]};a.START_BYTES=[77,84,114,107],a.END_BYTES=[0,255,47,0],a.prototype.addEvent=function(t){return this.events.push(t),this},a.prototype.addNoteOn=a.prototype.noteOn=function(t,i,a,o){return this.events.push(new r({type:r.NOTE_ON,channel:t,param1:n.ensureMidiPitch(i),param2:o||e,time:a||0})),this},a.prototype.addNoteOff=a.prototype.noteOff=function(t,i,a,o){return this.events.push(new r({type:r.NOTE_OFF,channel:t,param1:n.ensureMidiPitch(i),param2:o||e,time:a||0})),this},a.prototype.addNote=a.prototype.note=function(t,e,n,r,i){return this.noteOn(t,e,r,i),n&&this.noteOff(t,e,n,i),this},a.prototype.addChord=a.prototype.chord=function(t,e,n,r){if(!Array.isArray(e)&&!e.length)throw new Error(\"Chord must be an array of pitches\");return e.forEach(function(e){this.noteOn(t,e,0,r)},this),e.forEach(function(e,r){0===r?this.noteOff(t,e,n):this.noteOff(t,e)},this),this},a.prototype.setInstrument=a.prototype.instrument=function(t,e,n){return this.events.push(new r({type:r.PROGRAM_CHANGE,channel:t,param1:e,time:n||0})),this},a.prototype.setTempo=a.prototype.tempo=function(t,e){return this.events.push(new i({type:i.TEMPO,data:n.mpqnFromBpm(t),time:e||0})),this},a.prototype.toBytes=function(){var t=0,e=[],r=a.START_BYTES,i=a.END_BYTES,o=function(n){var r=n.toBytes();t+=r.length,e.push.apply(e,r)};this.events.forEach(o),t+=i.length;var s=n.str2Bytes(t.toString(16),4);return r.concat(s,e,i)};var o=function(t){if(!this)return new o(t);var e=t||{};if(e.ticks){if(\"number\"!=typeof e.ticks)throw new Error(\"Ticks per beat must be a number!\");if(e.ticks<=0||e.ticks>=32768||e.ticks%1!==0)throw new Error(\"Ticks per beat must be an integer between 1 and 32767!\")}this.ticks=e.ticks||128,this.tracks=e.tracks||[]};o.HDR_CHUNKID=\"MThd\",o.HDR_CHUNK_SIZE=\"\\x00\\x00\\x00\u0006\",o.HDR_TYPE0=\"\\x00\\x00\",o.HDR_TYPE1=\"\\x00\u0001\",o.prototype.addTrack=function(t){return t?(this.tracks.push(t),this):(t=new a,this.tracks.push(t),t)},o.prototype.toBytes=function(){var t=this.tracks.length.toString(16),e=o.HDR_CHUNKID+o.HDR_CHUNK_SIZE;return e+=parseInt(t,16)>1?o.HDR_TYPE1:o.HDR_TYPE0,e+=n.codes2Str(n.str2Bytes(t,2)),e+=String.fromCharCode(this.ticks/256,this.ticks%256),this.tracks.forEach(function(t){e+=n.codes2Str(t.toBytes())}),e},t.Util=n,t.File=o,t.Track=a,t.Event=r,t.MetaEvent=i}(n),\"undefined\"!=typeof t&&null!==t?t.exports=n:\"undefined\"!=typeof e&&null!==e?e=n:this.Midi=n}).call(e,n(12)(t))},function(t,e){function n(t){function e(t){var e=t.read(4),n=t.readInt32();return{id:e,length:n,data:t.read(n)}}function n(t){var e={};e.deltaTime=t.readVarInt();var n=t.readInt8();if(240==(240&n)){if(255==n){e.type=\"meta\";var r=t.readInt8(),a=t.readVarInt();switch(r){case 0:if(e.subtype=\"sequenceNumber\",2!=a)throw\"Expected length for sequenceNumber event is 2, got \"+a;return e.number=t.readInt16(),e;case 1:return e.subtype=\"text\",e.text=t.read(a),e;case 2:return e.subtype=\"copyrightNotice\",e.text=t.read(a),e;case 3:return e.subtype=\"trackName\",e.text=t.read(a),e;case 4:return e.subtype=\"instrumentName\",e.text=t.read(a),e;case 5:return e.subtype=\"lyrics\",e.text=t.read(a),e;case 6:return e.subtype=\"marker\",e.text=t.read(a),e;case 7:return e.subtype=\"cuePoint\",e.text=t.read(a),e;case 32:if(e.subtype=\"midiChannelPrefix\",1!=a)throw\"Expected length for midiChannelPrefix event is 1, got \"+a;return e.channel=t.readInt8(),e;case 47:if(e.subtype=\"endOfTrack\",0!=a)throw\"Expected length for endOfTrack event is 0, got \"+a;return e;case 81:if(e.subtype=\"setTempo\",3!=a)throw\"Expected length for setTempo event is 3, got \"+a;return e.microsecondsPerBeat=(t.readInt8()<<16)+(t.readInt8()<<8)+t.readInt8(),e;case 84:if(e.subtype=\"smpteOffset\",5!=a)throw\"Expected length for smpteOffset event is 5, got \"+a;var o=t.readInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&o],e.hour=31&o,e.min=t.readInt8(),e.sec=t.readInt8(),e.frame=t.readInt8(),e.subframe=t.readInt8(),e;case 88:if(e.subtype=\"timeSignature\",4!=a)throw\"Expected length for timeSignature event is 4, got \"+a;return e.numerator=t.readInt8(),e.denominator=Math.pow(2,t.readInt8()),e.metronome=t.readInt8(),e.thirtyseconds=t.readInt8(),e;case 89:if(e.subtype=\"keySignature\",2!=a)throw\"Expected length for keySignature event is 2, got \"+a;return e.key=t.readInt8(!0),e.scale=t.readInt8(),e;case 127:return e.subtype=\"sequencerSpecific\",e.data=t.read(a),e;default:return e.subtype=\"unknown\",e.data=t.read(a),e}return e.data=t.read(a),e}if(240==n){e.type=\"sysEx\";var a=t.readVarInt();return e.data=t.read(a),e}if(247==n){e.type=\"dividedSysEx\";var a=t.readVarInt();return e.data=t.read(a),e}throw\"Unrecognised MIDI event type byte: \"+n}var s;0==(128&n)?(s=n,n=i):(s=t.readInt8(),i=n);var u=n>>4;switch(e.channel=15&n,e.type=\"channel\",u){case 8:return e.subtype=\"noteOff\",e.noteNumber=s,e.velocity=t.readInt8(),e;case 9:return e.noteNumber=s,e.velocity=t.readInt8(),0==e.velocity?e.subtype=\"noteOff\":e.subtype=\"noteOn\",e;case 10:return e.subtype=\"noteAftertouch\",e.noteNumber=s,e.amount=t.readInt8(),e;case 11:return e.subtype=\"controller\",e.controllerType=s,e.value=t.readInt8(),e;case 12:return e.subtype=\"programChange\",e.programNumber=s,e;case 13:return e.subtype=\"channelAftertouch\",e.amount=s,e;case 14:return e.subtype=\"pitchBend\",e.value=s+(t.readInt8()<<7),e;default:throw\"Unrecognised MIDI event type: \"+u}}var i;stream=r(t);var a=e(stream);if(\"MThd\"!=a.id||6!=a.length)throw\"Bad .mid file - header not found\";var o=r(a.data),s=o.readInt16(),u=o.readInt16(),c=o.readInt16();if(32768&c)throw\"Expressing time division in SMTPE frames is not supported yet\";ticksPerBeat=c;for(var h={formatType:s,trackCount:u,ticksPerBeat:ticksPerBeat},f=[],d=0;d<h.trackCount;d++){f[d]=[];var l=e(stream);if(\"MTrk\"!=l.id)throw\"Unexpected chunk - expected MTrk, got \"+l.id;for(var p=r(l.data);!p.eof();){var m=n(p);f[d].push(m)}}return{header:h,tracks:f}}function r(t){function e(e){var n=t.substr(s,e);return s+=e,n}function n(){var e=(t.charCodeAt(s)<<24)+(t.charCodeAt(s+1)<<16)+(t.charCodeAt(s+2)<<8)+t.charCodeAt(s+3);return s+=4,e}function r(){var e=(t.charCodeAt(s)<<8)+t.charCodeAt(s+1);return s+=2,e}function i(e){var n=t.charCodeAt(s);return e&&n>127&&(n-=256),s+=1,n}function a(){return s>=t.length}function o(){for(var t=0;;){var e=i();if(!(128&e))return t+e;t+=127&e,t<<=7}}var s=0;return{eof:a,read:e,readInt32:n,readInt16:r,readInt8:i,readVarInt:o}}t.exports=function(t){return n(t)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}])});\n//# sourceMappingURL=MidiConvert.js.map"]}