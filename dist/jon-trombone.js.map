{"version":3,"sources":["webpack://jon-trombone/webpack/universalModuleDefinition","webpack://jon-trombone/webpack/bootstrap","webpack://jon-trombone/./node_modules/babel-runtime/core-js/get-iterator.js","webpack://jon-trombone/./node_modules/babel-runtime/core-js/object/define-property.js","webpack://jon-trombone/./node_modules/babel-runtime/core-js/object/freeze.js","webpack://jon-trombone/./node_modules/babel-runtime/helpers/classCallCheck.js","webpack://jon-trombone/./node_modules/babel-runtime/helpers/createClass.js","webpack://jon-trombone/./node_modules/core-js/library/fn/get-iterator.js","webpack://jon-trombone/./node_modules/core-js/library/fn/object/define-property.js","webpack://jon-trombone/./node_modules/core-js/library/fn/object/freeze.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_a-function.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_add-to-unscopables.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_an-object.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_array-includes.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_classof.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_cof.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_core.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_ctx.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_defined.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_descriptors.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_dom-create.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_enum-bug-keys.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_export.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_fails.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_global.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_has.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_hide.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_html.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_ie8-dom-define.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_iobject.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_is-object.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_iter-create.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_iter-define.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_iter-step.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_iterators.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_library.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_meta.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_object-create.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_object-dp.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_object-dps.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_object-gpo.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_object-keys-internal.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_object-keys.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_object-sap.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_property-desc.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_redefine.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_set-to-string-tag.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_shared-key.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_shared.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_string-at.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_to-absolute-index.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_to-integer.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_to-iobject.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_to-length.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_to-object.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_to-primitive.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_uid.js","webpack://jon-trombone/./node_modules/core-js/library/modules/_wks.js","webpack://jon-trombone/./node_modules/core-js/library/modules/core.get-iterator-method.js","webpack://jon-trombone/./node_modules/core-js/library/modules/core.get-iterator.js","webpack://jon-trombone/./node_modules/core-js/library/modules/es6.array.iterator.js","webpack://jon-trombone/./node_modules/core-js/library/modules/es6.object.define-property.js","webpack://jon-trombone/./node_modules/core-js/library/modules/es6.object.freeze.js","webpack://jon-trombone/./node_modules/core-js/library/modules/es6.string.iterator.js","webpack://jon-trombone/./node_modules/core-js/library/modules/web.dom.iterable.js","webpack://jon-trombone/./node_modules/jsmidgen/lib/jsmidgen.js","webpack://jon-trombone/./node_modules/midi-file-parser/index.js","webpack://jon-trombone/./node_modules/midiconvert/src/BinaryInsert.js","webpack://jon-trombone/./node_modules/midiconvert/src/Control.js","webpack://jon-trombone/./node_modules/midiconvert/src/Header.js","webpack://jon-trombone/./node_modules/midiconvert/src/Merge.js","webpack://jon-trombone/./node_modules/midiconvert/src/Midi.js","webpack://jon-trombone/./node_modules/midiconvert/src/MidiConvert.js","webpack://jon-trombone/./node_modules/midiconvert/src/Note.js","webpack://jon-trombone/./node_modules/midiconvert/src/Track.js","webpack://jon-trombone/./node_modules/midiconvert/src/Util.js","webpack://jon-trombone/./node_modules/midiconvert/src/instrumentMaps.js","webpack://jon-trombone/(webpack)/buildin/module.js","webpack://jon-trombone/./src/gui.js","webpack://jon-trombone/./src/index.js","webpack://jon-trombone/./src/jon-trombone.js","webpack://jon-trombone/./src/midi/midi-controller.js","webpack://jon-trombone/./src/pink-trombone/components/audio-system.js","webpack://jon-trombone/./src/pink-trombone/components/glottis.js","webpack://jon-trombone/./src/pink-trombone/components/tract-ui.js","webpack://jon-trombone/./src/pink-trombone/components/tract.js","webpack://jon-trombone/./src/pink-trombone/math-extensions.js","webpack://jon-trombone/./src/pink-trombone/noise.js","webpack://jon-trombone/./src/pink-trombone/pink-trombone.js","webpack://jon-trombone/./src/tts/tts-controller.js","webpack://jon-trombone/./src/utils/model-loader.js","webpack://jon-trombone/./src/utils/start-overlay.js","webpack://jon-trombone/./src/utils/webgl-detect.js"],"names":["GUI","jon","container","guify","console","log","panel","title","theme","root","width","barMode","align","opacity","Register","type","label","object","trombone","property","onChange","data","SetMute","min","max","folder","voices","glottis","step","tract","tractUI","fileReadFunc","midiController","LoadSongDirect","action","PlaySong","Stop","Restart","gui","Init","document","getElementById","HasWebGL","innerHTML","GetErrorHTML","classList","add","jonTrombone","readyState","window","onload","JonTrombone","finishedCallback","style","position","cursor","renderer","THREE","WebGLRenderer","alpha","setPixelRatio","devicePixelRatio","setSize","offsetWidth","offsetHeight","setClearColor","appendChild","domElement","aspect","camera","PerspectiveCamera","scene","Scene","clock","Clock","startDelayMS","setTimeout","StartAudio","moveJaw","jawFlapSpeed","jawOpenOffset","legato","flapWhileSinging","SetUpThree","SetUpScene","startOverlay","audioSystem","audioContext","OnUpdate","OrbitControls","undefined","controls","target","set","update","warn","light1","HemisphereLight","name","light2","DirectionalLight","LoadJSON","rotation","y","Math","degToRad","jaw","skeleton","bones","find","obj","jawShutZ","z","deltaTime","getDelta","requestAnimationFrame","bind","playing","notes","GetPitches","lastNotes","i","length","loudness","SetLipsClosed","UIFrequency","MIDIToFrequency","midi","velocity","voice","time","getElapsedTime","percent","sin","render","MidiConvert","require","MidiController","controller","currentTrack","baseFreq","path","callback","load","file","parse","trackIndex","GetSongProgress","tracks","item","noteOn","noteOff","filter","track","LoadSong","EnterSingMode","start","midiCode","pow","stop","ExitSingMode","backup_settings","autoWobble","voiceBackup","addPitchVariance","addTensenessVariance","vibratoFrequency","id","backup","AudioSystem","blockLength","blockTime","soundOn","AudioContext","webkitAudioContext","sampleRate","processors","scriptProcessor","createScriptProcessor","connect","destination","onaudioprocess","e","doScriptProcessor","whiteNoise","createWhiteNoiseNode","aspirateFilter","createBiquadFilter","frequency","value","Q","fricativeFilter","push","frameCount","myArrayBuffer","createBuffer","nowBuffering","getChannelData","random","source","createBufferSource","buffer","loop","event","index","inputArray1","inputBuffer","inputArray2","outArray","outputBuffer","N","j","lambda1","lambda2","glottalOutput","runStep","vocalOutput","lipOutput","noseOutput","finishBlock","processor","disconnect","exports","Glottis","timeInWaveform","oldFrequency","newFrequency","smoothFrequency","oldTenseness","newTenseness","UITenseness","totalTime","vibratoAmount","intensity","isTouched","touch","x","keyboardTop","keyboardLeft","keyboardWidth","keyboardHeight","semitones","marks","baseNote","output","setupWaveform","alive","UI","touchesWithMouse","local_y","local_x","clamp","semitone","t","cos","PI","lambda","noiseSource","timeStep","waveformLength","out","normalizedLFWaveform","aspiration","sqrt","getNoiseModulator","simplex1","voiced","vibrato","alwaysVoice","tenseness","Rd","Ra","Rk","Rg","Ta","Tp","Te","epsilon","shift","exp","Delta","RHSIntegral","totalLowerIntegral","totalUpperIntegral","omega","s","E0","TractUI","originX","originY","radius","scale","tongueIndex","tongueDiameter","innerTongueControlRadius","outerTongueControlRadius","tongueTouch","angleScale","angleOffset","noseOffset","gridOffset","Tract","setRestDiameter","n","diameter","targetDiameter","restDiameter","tongueLowerIndexBound","bladeStart","tongueUpperIndexBound","tipStart","tongueIndexCentre","xx","yy","angle","atan2","lipStart","fixedTongueDiameter","curve","progress","interp","lerp","R","L","reflection","junctionOutputR","junctionOutputL","maxAmplitude","newDiameter","A","glottalReflection","lipReflection","lastObstruction","fade","movementSpeed","transients","velumTarget","floor","Float64Array","newReflection","noseLength","noseStart","noseR","noseL","noseJunctionOutputR","noseJunctionOutputL","noseReflection","noseDiameter","noseA","noseMaxAmplitude","d","newReflectionLeft","newReflectionRight","newReflectionNose","calculateReflections","calculateNoseReflections","amount","newLastObstruction","slowReturn","moveTowards","addTransient","reflectionLeft","reflectionRight","reflectionNose","sum","turbulenceNoise","updateAmplitudes","processTransients","addTurbulenceNoise","r","w","amplitude","abs","reshapeTract","trans","timeAlive","lifeTime","strength","exponent","splice","delta","thinness0","openness","noise0","noise1","number","current","amountUp","amountDown","gaussian","c","a","b","Grad","Noise","grad3","p","perm","Array","gradP","seed","Date","now","v","xin","yin","F2","G2","F3","G3","n0","n1","n2","x0","y0","i1","j1","x1","y1","x2","y2","gi0","gi1","gi2","t0","dot2","t1","t2","simplex2","singleton","Voice","init","PinkTrombone","noiseFreq","noiseQ","muted","startSound","doMute","mute","unmute","TTSController","ModelLoader","modelInfo","loadedCallback","onProgress","xhr","lengthComputable","percentComplete","loaded","total","round","onError","mtlLoader","MTLLoader","setPath","mtlFile","materials","preload","objLoader","OBJLoader","setMaterials","objFile","loader","JSONLoader","geometry","mat","skinning","mesh","SkinnedMesh","MultiMaterial","manager","LoadingManager","FBXLoader","StartOverlay","overlay","createElement","cssText","addEventListener","Detector","WebGLRenderingContext","canvas","names","context","getContext","getParameter","message"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;ACnEA,kBAAkB,gJ;;;;;;;;;;;ACAlB,kBAAkB,oK;;;;;;;;;;;ACAlB,kBAAkB,kJ;;;;;;;;;;;;ACAlB;;AAEA;;AAEA;AACA;AACA;AACA;AACA,E;;;;;;;;;;;;ACRA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC,G;;;;;;;;;;;AC1BD;AACA;AACA;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;;;;;;;;;;;;ACDA;AACA;AACA;AACA;;;;;;;;;;;;ACHA,8BAA8B;;;;;;;;;;;;ACA9B;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,YAAY,eAAe;AAChC;AACA,KAAK;AACL;AACA;;;;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA,2BAA2B,kBAAkB,EAAE;;AAE/C;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtBA,iBAAiB;;AAEjB;AACA;AACA;;;;;;;;;;;;ACJA,6BAA6B;AAC7B,uCAAuC;;;;;;;;;;;;ACDvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA,iCAAiC,QAAQ,mBAAmB,UAAU,EAAE,EAAE;AAC1E,CAAC;;;;;;;;;;;;ACHD;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA;AACA;AACA;AACA;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA,kFAAkF;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,cAAc;AACd,cAAc;AACd,cAAc;AACd,eAAe;AACf,eAAe;AACf,eAAe;AACf,gBAAgB;AAChB;;;;;;;;;;;;AC5DA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA,yCAAyC;;;;;;;;;;;;ACLzC,uBAAuB;AACvB;AACA;AACA;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;;;;;;;;;;;ACPA;AACA;;;;;;;;;;;;ACDA;AACA,+IAAsE,mBAAmB,UAAU,EAAE,EAAE;AACvG,CAAC;;;;;;;;;;;;ACFD;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACLA;AACA;AACA;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;;AAEA;AACA,uNAAkF,aAAa,EAAE;;AAEjG;AACA,qDAAqD,4BAA4B;AACjF;AACA;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;;AAEA,8BAA8B,aAAa;;AAE3C;AACA;AACA;AACA;AACA;AACA,yCAAyC,oCAAoC;AAC7E,6CAA6C,oCAAoC;AACjF,KAAK,4BAA4B,oCAAoC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,mBAAmB;AACnC;AACA;AACA,kCAAkC,2BAA2B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;ACrEA;AACA,UAAU;AACV;;;;;;;;;;;;ACFA;;;;;;;;;;;;ACAA;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD,CAAC;AACD;AACA,qBAAqB;AACrB;AACA,SAAS;AACT,GAAG,EAAE;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;ACxCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf;AACA;AACA;AACA;;;;;;;;;;;;ACfA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACZA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChBA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,qDAAqD,OAAO,EAAE;AAC9D;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;;;;;;;;;;;;ACAA;AACA;AACA;;AAEA;AACA,oEAAoE,iCAAiC;AACrG;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA,kDAAkD;AAClD;AACA,uCAAuC;AACvC;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC,cAAc;AACd,iBAAiB;AACjB;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACjCA;AACA;AACA,iJAAuE,oHAA4C;;;;;;;;;;;;ACFnH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;ACRD;AACA;;AAEA;AACA;AACA,6BAA6B;AAC7B,cAAc;AACd;AACA,CAAC;AACD;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA,UAAU;AACV,CAAC;;;;;;;;;;;;AChBD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClBA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,wBAAwB,2CAA2C;;AAEnE;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,aAAa,cAAc;AAC3B,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,GAAG;;AAEH,wBAAwB,8HAA8H;AACtJ,yBAAyB,wDAAwD;;AAEjF;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,QAAQ;AACrB;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,kCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,aAAa,MAAM;AACnB,eAAe,OAAO;AACtB;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA,eAAe,MAAM;AACrB;AACA;AACA;AACA,2CAA2C,iBAAiB;AAC5D;;AAEA;AACA,2BAA2B,MAAM;AACjC;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA,UAAU;AACV;AACA,aAAa,OAAO;AACpB,eAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wBAAwB,cAAc;AACtC,UAAU,OAAO;AACjB;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,aAAa;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH,oBAAoB;AACpB;AACA,uDAAuD,yBAAyB;AAChF;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY,oBAAoB;AAChC,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,cAAc;AAC1B;AACA,YAAY,OAAO;AACnB;AACA,YAAY,OAAO;AACnB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,cAAc;AAC1B;AACA,YAAY,OAAO;AACnB;AACA,YAAY,OAAO;AACnB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,cAAc;AAC1B;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA,YAAY,OAAO;AACnB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,MAAM;AAClB;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B;AAC/B,2CAA2C;AAC3C,mCAAmC;AACnC,mCAAmC;;AAEnC;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,CAAC;;AAED;AACA;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;;;;;;;;;;;;;ACzqBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,uBAAuB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;;ACvTA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,MAAM;AAClB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEQ;;;;;;;;;;;;;;ACrDR;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEQ;;;;;;;;;;;;;;ACtCR;AAAA;AACA;AACA,aAAa,OAAO;AACpB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,gBAAgB,4BAA4B;AAC5C;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEQ;;;;;;;;;;;;;;;;AC3BR;AACA,gBAAgB,mBAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,mBAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;ACzCA;AACA;AACA;AACc;AACM;;AAEpB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,YAAY,EAAE;AACd,YAAY,OAAO;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ;;AAEA;AACA;AACA,aAAa,mBAAmB;AAChC,aAAa,KAAK;AAClB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,cAAc;AAC3B,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,cAAc,KAAK;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEQ;;;;;;;;;;;;;;;;;;;;;;;;;;AClSK;AACuD;;AAEpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,cAAc;AAC3B,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,YAAY,UAAU;AACtB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC1EA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA,YAAY,cAAc;AAC1B,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEQ;;;;;;;;;;;;;;;;;;;;AC5Ga;AACL;AACF;AACD;AACuD;;AAEpE;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc;AACd;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,cAAc;AAC3B;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,cAAc;AAC3B,aAAa,OAAO;AACpB,aAAa,MAAM;AACnB;AACA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA,eAAe;AACf;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEQ;;;;;;;;;;;;;;;;;;;;;AC1VR;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yBAAyB,EAAE;AAC3B;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB,EAAE;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;;;;;AClDD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICrBMA,G;;;;;;;6BAEGC,G,EAAKC,S,EAAU;;AAEhB,gBAAG,CAACC,KAAJ,EAAW;AACPC,wBAAQC,GAAR,CAAY,4EAAZ;AACA;AACH;;AAED,iBAAKC,KAAL,GAAa,IAAIH,KAAJ,CAAU;AACnBI,uBAAO,cADY;AAEnBC,uBAAO,MAFY;AAGnBC,sBAAMP,SAHa;AAInBQ,uBAAO,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","file":"jon-trombone.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"jon-trombone\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jon-trombone\"] = factory();\n\telse\n\t\troot[\"jon-trombone\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/freeze\"), __esModule: true };","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      (0, _defineProperty2.default)(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc) {\n  return $Object.defineProperty(it, key, desc);\n};\n","require('../../modules/es6.object.freeze');\nmodule.exports = require('../../modules/_core').Object.freeze;\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","module.exports = function () { /* empty */ };\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","var core = module.exports = { version: '2.5.3' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","var global = require('./_global');\nvar core = require('./_core');\nvar ctx = require('./_ctx');\nvar hide = require('./_hide');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && key in exports) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = (!BUGGY && $native) || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && !has(IteratorPrototype, ITERATOR)) hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n","module.exports = {};\n","module.exports = true;\n","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","module.exports = require('./_hide');\n","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","var global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function (key) {\n  return store[key] || (store[key] = {});\n};\n","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n","// 19.1.2.5 Object.freeze(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('freeze', function ($freeze) {\n  return function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(meta(it)) : it;\n  };\n});\n","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n","require('./es6.array.iterator');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar TO_STRING_TAG = require('./_wks')('toStringTag');\n\nvar DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +\n  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +\n  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +\n  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +\n  'TextTrackList,TouchList').split(',');\n\nfor (var i = 0; i < DOMIterables.length; i++) {\n  var NAME = DOMIterables[i];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}\n","var Midi = {};\n\n(function(exported) {\n\n\tvar DEFAULT_VOLUME   = exported.DEFAULT_VOLUME   = 90;\n\tvar DEFAULT_DURATION = exported.DEFAULT_DURATION = 128;\n\tvar DEFAULT_CHANNEL  = exported.DEFAULT_CHANNEL  = 0;\n\n\t/* ******************************************************************\n\t * Utility functions\n\t ****************************************************************** */\n\n\tvar Util = {\n\n\t\tmidi_letter_pitches: { a:21, b:23, c:12, d:14, e:16, f:17, g:19 },\n\n\t\t/**\n\t\t * Convert a symbolic note name (e.g. \"c4\") to a numeric MIDI pitch (e.g.\n\t\t * 60, middle C).\n\t\t *\n\t\t * @param {string} n - The symbolic note name to parse.\n\t\t * @returns {number} The MIDI pitch that corresponds to the symbolic note\n\t\t * name.\n\t\t */\n\t\tmidiPitchFromNote: function(n) {\n\t\t\tvar matches = /([a-g])(#+|b+)?([0-9]+)$/i.exec(n);\n\t\t\tvar note = matches[1].toLowerCase(), accidental = matches[2] || '', octave = parseInt(matches[3], 10);\n\t\t\treturn (12 * octave) + Util.midi_letter_pitches[note] + (accidental.substr(0,1)=='#'?1:-1) * accidental.length;\n\t\t},\n\n\t\t/**\n\t\t * Ensure that the given argument is converted to a MIDI pitch. Note that\n\t\t * it may already be one (including a purely numeric string).\n\t\t *\n\t\t * @param {string|number} p - The pitch to convert.\n\t\t * @returns {number} The resulting numeric MIDI pitch.\n\t\t */\n\t\tensureMidiPitch: function(p) {\n\t\t\tif (typeof p == 'number' || !/[^0-9]/.test(p)) {\n\t\t\t\t// numeric pitch\n\t\t\t\treturn parseInt(p, 10);\n\t\t\t} else {\n\t\t\t\t// assume it's a note name\n\t\t\t\treturn Util.midiPitchFromNote(p);\n\t\t\t}\n\t\t},\n\n\t\tmidi_pitches_letter: { '12':'c', '13':'c#', '14':'d', '15':'d#', '16':'e', '17':'f', '18':'f#', '19':'g', '20':'g#', '21':'a', '22':'a#', '23':'b' },\n\t\tmidi_flattened_notes: { 'a#':'bb', 'c#':'db', 'd#':'eb', 'f#':'gb', 'g#':'ab' },\n\n\t\t/**\n\t\t * Convert a numeric MIDI pitch value (e.g. 60) to a symbolic note name\n\t\t * (e.g. \"c4\").\n\t\t *\n\t\t * @param {number} n - The numeric MIDI pitch value to convert.\n\t\t * @param {boolean} [returnFlattened=false] - Whether to prefer flattened\n\t\t * notes to sharpened ones. Optional, default false.\n\t\t * @returns {string} The resulting symbolic note name.\n\t\t */\n\t\tnoteFromMidiPitch: function(n, returnFlattened) {\n\t\t\tvar octave = 0, noteNum = n, noteName, returnFlattened = returnFlattened || false;\n\t\t\tif (n > 23) {\n\t\t\t\t// noteNum is on octave 1 or more\n\t\t\t\toctave = Math.floor(n/12) - 1;\n\t\t\t\t// subtract number of octaves from noteNum\n\t\t\t\tnoteNum = n - octave * 12;\n\t\t\t}\n\n\t\t\t// get note name (c#, d, f# etc)\n\t\t\tnoteName = Util.midi_pitches_letter[noteNum];\n\t\t\t// Use flattened notes if requested (e.g. f# should be output as gb)\n\t\t\tif (returnFlattened && noteName.indexOf('#') > 0) {\n\t\t\t\tnoteName = Util.midi_flattened_notes[noteName];\n\t\t\t}\n\t\t\treturn noteName + octave;\n\t\t},\n\n\t\t/**\n\t\t * Convert beats per minute (BPM) to microseconds per quarter note (MPQN).\n\t\t *\n\t\t * @param {number} bpm - A number in beats per minute.\n\t\t * @returns {number} The number of microseconds per quarter note.\n\t\t */\n\t\tmpqnFromBpm: function(bpm) {\n\t\t\tvar mpqn = Math.floor(60000000 / bpm);\n\t\t\tvar ret=[];\n\t\t\tdo {\n\t\t\t\tret.unshift(mpqn & 0xFF);\n\t\t\t\tmpqn >>= 8;\n\t\t\t} while (mpqn);\n\t\t\twhile (ret.length < 3) {\n\t\t\t\tret.push(0);\n\t\t\t}\n\t\t\treturn ret;\n\t\t},\n\n\t\t/**\n\t\t * Convert microseconds per quarter note (MPQN) to beats per minute (BPM).\n\t\t *\n\t\t * @param {number} mpqn - The number of microseconds per quarter note.\n\t\t * @returns {number} A number in beats per minute.\n\t\t */\n\t\tbpmFromMpqn: function(mpqn) {\n\t\t\tvar m = mpqn;\n\t\t\tif (typeof mpqn[0] != 'undefined') {\n\t\t\t\tm = 0;\n\t\t\t\tfor (var i=0, l=mpqn.length-1; l >= 0; ++i, --l) {\n\t\t\t\t\tm |= mpqn[i] << l;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn Math.floor(60000000 / mpqn);\n\t\t},\n\n\t\t/**\n\t\t * Converts an array of bytes to a string of hexadecimal characters. Prepares\n\t\t * it to be converted into a base64 string.\n\t\t *\n\t\t * @param {Array} byteArray - Array of bytes to be converted.\n\t\t * @returns {string} Hexadecimal string, e.g. \"097B8A\".\n\t\t */\n\t\tcodes2Str: function(byteArray) {\n\t\t\treturn String.fromCharCode.apply(null, byteArray);\n\t\t},\n\n\t\t/**\n\t\t * Converts a string of hexadecimal values to an array of bytes. It can also\n\t\t * add remaining \"0\" nibbles in order to have enough bytes in the array as the\n\t\t * `finalBytes` parameter.\n\t\t *\n\t\t * @param {string} str - string of hexadecimal values e.g. \"097B8A\"\n\t\t * @param {number} [finalBytes] - Optional. The desired number of bytes\n\t\t * (not nibbles) that the returned array should contain.\n\t\t * @returns {Array} An array of nibbles.\n\t\t */\n\t\tstr2Bytes: function (str, finalBytes) {\n\t\t\tif (finalBytes) {\n\t\t\t\twhile ((str.length / 2) < finalBytes) { str = \"0\" + str; }\n\t\t\t}\n\n\t\t\tvar bytes = [];\n\t\t\tfor (var i=str.length-1; i>=0; i = i-2) {\n\t\t\t\tvar chars = i === 0 ? str[i] : str[i-1] + str[i];\n\t\t\t\tbytes.unshift(parseInt(chars, 16));\n\t\t\t}\n\n\t\t\treturn bytes;\n\t\t},\n\n\t\t/**\n\t\t * Translates number of ticks to MIDI timestamp format, returning an array\n\t\t * of bytes with the time values. MIDI has a very particular way to express\n\t\t * time; take a good look at the spec before ever touching this function.\n\t\t *\n\t\t * @param {number} ticks - Number of ticks to be translated.\n\t\t * @returns {number} Array of bytes that form the MIDI time value.\n\t\t */\n\t\ttranslateTickTime: function(ticks) {\n\t\t\tvar buffer = ticks & 0x7F;\n\n\t\t\twhile (ticks = ticks >> 7) {\n\t\t\t\tbuffer <<= 8;\n\t\t\t\tbuffer |= ((ticks & 0x7F) | 0x80);\n\t\t\t}\n\n\t\t\tvar bList = [];\n\t\t\twhile (true) {\n\t\t\t\tbList.push(buffer & 0xff);\n\n\t\t\t\tif (buffer & 0x80) { buffer >>= 8; }\n\t\t\t\telse { break; }\n\t\t\t}\n\t\t\treturn bList;\n\t\t},\n\n\t};\n\n\t/* ******************************************************************\n\t * Event class\n\t ****************************************************************** */\n\n\t/**\n\t * Construct a MIDI event.\n\t *\n\t * Parameters include:\n\t *  - time [optional number] - Ticks since previous event.\n\t *  - type [required number] - Type of event.\n\t *  - channel [required number] - Channel for the event.\n\t *  - param1 [required number] - First event parameter.\n\t *  - param2 [optional number] - Second event parameter.\n\t */\n\tvar MidiEvent = function(params) {\n\t\tif (!this) return new MidiEvent(params);\n\t\tif (params &&\n\t\t\t\t(params.type    !== null || params.type    !== undefined) &&\n\t\t\t\t(params.channel !== null || params.channel !== undefined) &&\n\t\t\t\t(params.param1  !== null || params.param1  !== undefined)) {\n\t\t\tthis.setTime(params.time);\n\t\t\tthis.setType(params.type);\n\t\t\tthis.setChannel(params.channel);\n\t\t\tthis.setParam1(params.param1);\n\t\t\tthis.setParam2(params.param2);\n\t\t}\n\t};\n\n\t// event codes\n\tMidiEvent.NOTE_OFF           = 0x80;\n\tMidiEvent.NOTE_ON            = 0x90;\n\tMidiEvent.AFTER_TOUCH        = 0xA0;\n\tMidiEvent.CONTROLLER         = 0xB0;\n\tMidiEvent.PROGRAM_CHANGE     = 0xC0;\n\tMidiEvent.CHANNEL_AFTERTOUCH = 0xD0;\n\tMidiEvent.PITCH_BEND         = 0xE0;\n\n\n\t/**\n\t * Set the time for the event in ticks since the previous event.\n\t *\n\t * @param {number} ticks - The number of ticks since the previous event. May\n\t * be zero.\n\t */\n\tMidiEvent.prototype.setTime = function(ticks) {\n\t\tthis.time = Util.translateTickTime(ticks || 0);\n\t};\n\n\t/**\n\t * Set the type of the event. Must be one of the event codes on MidiEvent.\n\t *\n\t * @param {number} type - Event type.\n\t */\n\tMidiEvent.prototype.setType = function(type) {\n\t\tif (type < MidiEvent.NOTE_OFF || type > MidiEvent.PITCH_BEND) {\n\t\t\tthrow new Error(\"Trying to set an unknown event: \" + type);\n\t\t}\n\n\t\tthis.type = type;\n\t};\n\n\t/**\n\t * Set the channel for the event. Must be between 0 and 15, inclusive.\n\t *\n\t * @param {number} channel - The event channel.\n\t */\n\tMidiEvent.prototype.setChannel = function(channel) {\n\t\tif (channel < 0 || channel > 15) {\n\t\t\tthrow new Error(\"Channel is out of bounds.\");\n\t\t}\n\n\t\tthis.channel = channel;\n\t};\n\n\t/**\n\t * Set the first parameter for the event. Must be between 0 and 255,\n\t * inclusive.\n\t *\n\t * @param {number} p - The first event parameter value.\n\t */\n\tMidiEvent.prototype.setParam1 = function(p) {\n\t\tthis.param1 = p;\n\t};\n\n\t/**\n\t * Set the second parameter for the event. Must be between 0 and 255,\n\t * inclusive.\n\t *\n\t * @param {number} p - The second event parameter value.\n\t */\n\tMidiEvent.prototype.setParam2 = function(p) {\n\t\tthis.param2 = p;\n\t};\n\n\t/**\n\t * Serialize the event to an array of bytes.\n\t *\n\t * @returns {Array} The array of serialized bytes.\n\t */\n\tMidiEvent.prototype.toBytes = function() {\n\t\tvar byteArray = [];\n\n\t\tvar typeChannelByte = this.type | (this.channel & 0xF);\n\n\t\tbyteArray.push.apply(byteArray, this.time);\n\t\tbyteArray.push(typeChannelByte);\n\t\tbyteArray.push(this.param1);\n\n\t\t// Some events don't have a second parameter\n\t\tif (this.param2 !== undefined && this.param2 !== null) {\n\t\t\tbyteArray.push(this.param2);\n\t\t}\n\t\treturn byteArray;\n\t};\n\n\t/* ******************************************************************\n\t * MetaEvent class\n\t ****************************************************************** */\n\n\t/**\n\t * Construct a meta event.\n\t *\n\t * Parameters include:\n\t *  - time [optional number] - Ticks since previous event.\n\t *  - type [required number] - Type of event.\n\t *  - data [optional array|string] - Event data.\n\t */\n\tvar MetaEvent = function(params) {\n\t\tif (!this) return new MetaEvent(params);\n\t\tvar p = params || {};\n\t\tthis.setTime(params.time);\n\t\tthis.setType(params.type);\n\t\tthis.setData(params.data);\n\t};\n\n\tMetaEvent.SEQUENCE   = 0x00;\n\tMetaEvent.TEXT       = 0x01;\n\tMetaEvent.COPYRIGHT  = 0x02;\n\tMetaEvent.TRACK_NAME = 0x03;\n\tMetaEvent.INSTRUMENT = 0x04;\n\tMetaEvent.LYRIC      = 0x05;\n\tMetaEvent.MARKER     = 0x06;\n\tMetaEvent.CUE_POINT  = 0x07;\n\tMetaEvent.CHANNEL_PREFIX = 0x20;\n\tMetaEvent.END_OF_TRACK   = 0x2f;\n\tMetaEvent.TEMPO      = 0x51;\n\tMetaEvent.SMPTE      = 0x54;\n\tMetaEvent.TIME_SIG   = 0x58;\n\tMetaEvent.KEY_SIG    = 0x59;\n\tMetaEvent.SEQ_EVENT  = 0x7f;\n\n\t/**\n\t * Set the time for the event in ticks since the previous event.\n\t *\n\t * @param {number} ticks - The number of ticks since the previous event. May\n\t * be zero.\n\t */\n\tMetaEvent.prototype.setTime = function(ticks) {\n\t\tthis.time = Util.translateTickTime(ticks || 0);\n\t};\n\n\t/**\n\t * Set the type of the event. Must be one of the event codes on MetaEvent.\n\t *\n\t * @param {number} t - Event type.\n\t */\n\tMetaEvent.prototype.setType = function(t) {\n\t\tthis.type = t;\n\t};\n\n\t/**\n\t * Set the data associated with the event. May be a string or array of byte\n\t * values.\n\t *\n\t * @param {string|Array} d - Event data.\n\t */\n\tMetaEvent.prototype.setData = function(d) {\n\t\tthis.data = d;\n\t};\n\n\t/**\n\t * Serialize the event to an array of bytes.\n\t *\n\t * @returns {Array} The array of serialized bytes.\n\t */\n\tMetaEvent.prototype.toBytes = function() {\n\t\tif (!this.type) {\n\t\t\tthrow new Error(\"Type for meta-event not specified.\");\n\t\t}\n\n\t\tvar byteArray = [];\n\t\tbyteArray.push.apply(byteArray, this.time);\n\t\tbyteArray.push(0xFF, this.type);\n\n\t\t// If data is an array, we assume that it contains several bytes. We\n\t\t// apend them to byteArray.\n\t\tif (Array.isArray(this.data)) {\n\t\t\tbyteArray.push(this.data.length);\n\t\t\tbyteArray.push.apply(byteArray, this.data);\n\t\t} else if (typeof this.data == 'number') {\n\t\t\tbyteArray.push(1, this.data);\n\t\t} else if (this.data !== null && this.data !== undefined) {\n\t\t\t// assume string; may be a bad assumption\n\t\t\tbyteArray.push(this.data.length);\n\t\t\tvar dataBytes = this.data.split('').map(function(x){ return x.charCodeAt(0) });\n\t\t\tbyteArray.push.apply(byteArray, dataBytes);\n\t\t} else {\n\t\t\tbyteArray.push(0);\n\t\t}\n\n\t\treturn byteArray;\n\t};\n\n\t/* ******************************************************************\n\t * Track class\n\t ****************************************************************** */\n\n\t/**\n\t * Construct a MIDI track.\n\t *\n\t * Parameters include:\n\t *  - events [optional array] - Array of events for the track.\n\t */\n\tvar Track = function(config) {\n\t\tif (!this) return new Track(config);\n\t\tvar c = config || {};\n\t\tthis.events = c.events || [];\n\t};\n\n\tTrack.START_BYTES = [0x4d, 0x54, 0x72, 0x6b];\n\tTrack.END_BYTES   = [0x00, 0xFF, 0x2F, 0x00];\n\n\t/**\n\t * Add an event to the track.\n\t *\n\t * @param {MidiEvent|MetaEvent} event - The event to add.\n\t * @returns {Track} The current track.\n\t */\n\tTrack.prototype.addEvent = function(event) {\n\t\tthis.events.push(event);\n\t\treturn this;\n\t};\n\n\t/**\n\t * Add a note-on event to the track.\n\t *\n\t * @param {number} channel - The channel to add the event to.\n\t * @param {number|string} pitch - The pitch of the note, either numeric or\n\t * symbolic.\n\t * @param {number} [time=0] - The number of ticks since the previous event,\n\t * defaults to 0.\n\t * @param {number} [velocity=90] - The volume for the note, defaults to\n\t * DEFAULT_VOLUME.\n\t * @returns {Track} The current track.\n\t */\n\tTrack.prototype.addNoteOn = Track.prototype.noteOn = function(channel, pitch, time, velocity) {\n\t\tthis.events.push(new MidiEvent({\n\t\t\ttype: MidiEvent.NOTE_ON,\n\t\t\tchannel: channel,\n\t\t\tparam1: Util.ensureMidiPitch(pitch),\n\t\t\tparam2: velocity || DEFAULT_VOLUME,\n\t\t\ttime: time || 0,\n\t\t}));\n\t\treturn this;\n\t};\n\n\t/**\n\t * Add a note-off event to the track.\n\t *\n\t * @param {number} channel - The channel to add the event to.\n\t * @param {number|string} pitch - The pitch of the note, either numeric or\n\t * symbolic.\n\t * @param {number} [time=0] - The number of ticks since the previous event,\n\t * defaults to 0.\n\t * @param {number} [velocity=90] - The velocity the note was released,\n\t * defaults to DEFAULT_VOLUME.\n\t * @returns {Track} The current track.\n\t */\n\tTrack.prototype.addNoteOff = Track.prototype.noteOff = function(channel, pitch, time, velocity) {\n\t\tthis.events.push(new MidiEvent({\n\t\t\ttype: MidiEvent.NOTE_OFF,\n\t\t\tchannel: channel,\n\t\t\tparam1: Util.ensureMidiPitch(pitch),\n\t\t\tparam2: velocity || DEFAULT_VOLUME,\n\t\t\ttime: time || 0,\n\t\t}));\n\t\treturn this;\n\t};\n\n\t/**\n\t * Add a note-on and -off event to the track.\n\t *\n\t * @param {number} channel - The channel to add the event to.\n\t * @param {number|string} pitch - The pitch of the note, either numeric or\n\t * symbolic.\n\t * @param {number} dur - The duration of the note, in ticks.\n\t * @param {number} [time=0] - The number of ticks since the previous event,\n\t * defaults to 0.\n\t * @param {number} [velocity=90] - The velocity the note was released,\n\t * defaults to DEFAULT_VOLUME.\n\t * @returns {Track} The current track.\n\t */\n\tTrack.prototype.addNote = Track.prototype.note = function(channel, pitch, dur, time, velocity) {\n\t\tthis.noteOn(channel, pitch, time, velocity);\n\t\tif (dur) {\n\t\t\tthis.noteOff(channel, pitch, dur, velocity);\n\t\t}\n\t\treturn this;\n\t};\n\n\t/**\n\t * Add a note-on and -off event to the track for each pitch in an array of pitches.\n\t *\n\t * @param {number} channel - The channel to add the event to.\n\t * @param {array} chord - An array of pitches, either numeric or\n\t * symbolic.\n\t * @param {number} dur - The duration of the chord, in ticks.\n\t * @param {number} [velocity=90] - The velocity of the chord,\n\t * defaults to DEFAULT_VOLUME.\n\t * @returns {Track} The current track.\n\t */\n\tTrack.prototype.addChord = Track.prototype.chord = function(channel, chord, dur, velocity) {\n\t\tif (!Array.isArray(chord) && !chord.length) {\n\t\t\tthrow new Error('Chord must be an array of pitches');\n\t\t}\n\t\tchord.forEach(function(note) {\n\t\t\tthis.noteOn(channel, note, 0, velocity);\n\t\t}, this);\n\t\tchord.forEach(function(note, index) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.noteOff(channel, note, dur);\n\t\t\t} else {\n\t\t\t\tthis.noteOff(channel, note);\n\t\t\t}\n\t\t}, this);\n\t\treturn this;\n\t};\n\n\t/**\n\t * Set instrument for the track.\n\t *\n\t * @param {number} channel - The channel to set the instrument on.\n\t * @param {number} instrument - The instrument to set it to.\n\t * @param {number} [time=0] - The number of ticks since the previous event,\n\t * defaults to 0.\n\t * @returns {Track} The current track.\n\t */\n\tTrack.prototype.setInstrument = Track.prototype.instrument = function(channel, instrument, time) {\n\t\tthis.events.push(new MidiEvent({\n\t\t\ttype: MidiEvent.PROGRAM_CHANGE,\n\t\t\tchannel: channel,\n\t\t\tparam1: instrument,\n\t\t\ttime: time || 0,\n\t\t}));\n\t\treturn this;\n\t};\n\n\t/**\n\t * Set the tempo for the track.\n\t *\n\t * @param {number} bpm - The new number of beats per minute.\n\t * @param {number} [time=0] - The number of ticks since the previous event,\n\t * defaults to 0.\n\t * @returns {Track} The current track.\n\t */\n\tTrack.prototype.setTempo = Track.prototype.tempo = function(bpm, time) {\n\t\tthis.events.push(new MetaEvent({\n\t\t\ttype: MetaEvent.TEMPO,\n\t\t\tdata: Util.mpqnFromBpm(bpm),\n\t\t\ttime: time || 0,\n\t\t}));\n\t\treturn this;\n\t};\n\n\t/**\n\t * Serialize the track to an array of bytes.\n\t *\n\t * @returns {Array} The array of serialized bytes.\n\t */\n\tTrack.prototype.toBytes = function() {\n\t\tvar trackLength = 0;\n\t\tvar eventBytes = [];\n\t\tvar startBytes = Track.START_BYTES;\n\t\tvar endBytes   = Track.END_BYTES;\n\n\t\tvar addEventBytes = function(event) {\n\t\t\tvar bytes = event.toBytes();\n\t\t\ttrackLength += bytes.length;\n\t\t\teventBytes.push.apply(eventBytes, bytes);\n\t\t};\n\n\t\tthis.events.forEach(addEventBytes);\n\n\t\t// Add the end-of-track bytes to the sum of bytes for the track, since\n\t\t// they are counted (unlike the start-of-track ones).\n\t\ttrackLength += endBytes.length;\n\n\t\t// Makes sure that track length will fill up 4 bytes with 0s in case\n\t\t// the length is less than that (the usual case).\n\t\tvar lengthBytes = Util.str2Bytes(trackLength.toString(16), 4);\n\n\t\treturn startBytes.concat(lengthBytes, eventBytes, endBytes);\n\t};\n\n\t/* ******************************************************************\n\t * File class\n\t ****************************************************************** */\n\n\t/**\n\t * Construct a file object.\n\t *\n\t * Parameters include:\n\t *  - ticks [optional number] - Number of ticks per beat, defaults to 128.\n\t *    Must be 1-32767.\n\t *  - tracks [optional array] - Track data.\n\t */\n\tvar File = function(config){\n\t\tif (!this) return new File(config);\n\n\t\tvar c = config || {};\n\t\tif (c.ticks) {\n\t\t\tif (typeof c.ticks !== 'number') {\n\t\t\t\tthrow new Error('Ticks per beat must be a number!');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (c.ticks <= 0 || c.ticks >= (1 << 15) || c.ticks % 1 !== 0) {\n\t\t\t\tthrow new Error('Ticks per beat must be an integer between 1 and 32767!');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.ticks = c.ticks || 128;\n\t\tthis.tracks = c.tracks || [];\n\t};\n\n\tFile.HDR_CHUNKID     = \"MThd\";             // File magic cookie\n\tFile.HDR_CHUNK_SIZE  = \"\\x00\\x00\\x00\\x06\"; // Header length for SMF\n\tFile.HDR_TYPE0       = \"\\x00\\x00\";         // Midi Type 0 id\n\tFile.HDR_TYPE1       = \"\\x00\\x01\";         // Midi Type 1 id\n\n\t/**\n\t * Add a track to the file.\n\t *\n\t * @param {Track} track - The track to add.\n\t */\n\tFile.prototype.addTrack = function(track) {\n\t\tif (track) {\n\t\t\tthis.tracks.push(track);\n\t\t\treturn this;\n\t\t} else {\n\t\t\ttrack = new Track();\n\t\t\tthis.tracks.push(track);\n\t\t\treturn track;\n\t\t}\n\t};\n\n\t/**\n\t * Serialize the MIDI file to an array of bytes.\n\t *\n\t * @returns {Array} The array of serialized bytes.\n\t */\n\tFile.prototype.toBytes = function() {\n\t\tvar trackCount = this.tracks.length.toString(16);\n\n\t\t// prepare the file header\n\t\tvar bytes = File.HDR_CHUNKID + File.HDR_CHUNK_SIZE;\n\n\t\t// set Midi type based on number of tracks\n\t\tif (parseInt(trackCount, 16) > 1) {\n\t\t\tbytes += File.HDR_TYPE1;\n\t\t} else {\n\t\t\tbytes += File.HDR_TYPE0;\n\t\t}\n\n\t\t// add the number of tracks (2 bytes)\n\t\tbytes += Util.codes2Str(Util.str2Bytes(trackCount, 2));\n\t\t// add the number of ticks per beat (currently hardcoded)\n\t\tbytes += String.fromCharCode((this.ticks/256),  this.ticks%256);;\n\n\t\t// iterate over the tracks, converting to bytes too\n\t\tthis.tracks.forEach(function(track) {\n\t\t\tbytes += Util.codes2Str(track.toBytes());\n\t\t});\n\n\t\treturn bytes;\n\t};\n\n\t/* ******************************************************************\n\t * Exports\n\t ****************************************************************** */\n\n\texported.Util = Util;\n\texported.File = File;\n\texported.Track = Track;\n\texported.Event = MidiEvent;\n\texported.MetaEvent = MetaEvent;\n\n})( Midi );\n\nif (typeof module != 'undefined' && module !== null) {\n\tmodule.exports = Midi;\n} else if (typeof exports != 'undefined' && exports !== null) {\n\texports = Midi;\n} else {\n\tthis.Midi = Midi;\n}\n","// https://github.com/gasman/jasmid\n//\n//\n\nmodule.exports = function(file){\n\treturn MidiFile(file)\n};\n\nfunction MidiFile(data) {\n\tfunction readChunk(stream) {\n\t\tvar id = stream.read(4);\n\t\tvar length = stream.readInt32();\n\t\treturn {\n\t\t\t'id': id,\n\t\t\t'length': length,\n\t\t\t'data': stream.read(length)\n\t\t};\n\t}\n\t\n\tvar lastEventTypeByte;\n\t\n\tfunction readEvent(stream) {\n\t\tvar event = {};\n\t\tevent.deltaTime = stream.readVarInt();\n\t\tvar eventTypeByte = stream.readInt8();\n\t\tif ((eventTypeByte & 0xf0) == 0xf0) {\n\t\t\t/* system / meta event */\n\t\t\tif (eventTypeByte == 0xff) {\n\t\t\t\t/* meta event */\n\t\t\t\tevent.type = 'meta';\n\t\t\t\tvar subtypeByte = stream.readInt8();\n\t\t\t\tvar length = stream.readVarInt();\n\t\t\t\tswitch(subtypeByte) {\n\t\t\t\t\tcase 0x00:\n\t\t\t\t\t\tevent.subtype = 'sequenceNumber';\n\t\t\t\t\t\tif (length != 2) throw \"Expected length for sequenceNumber event is 2, got \" + length;\n\t\t\t\t\t\tevent.number = stream.readInt16();\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x01:\n\t\t\t\t\t\tevent.subtype = 'text';\n\t\t\t\t\t\tevent.text = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x02:\n\t\t\t\t\t\tevent.subtype = 'copyrightNotice';\n\t\t\t\t\t\tevent.text = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x03:\n\t\t\t\t\t\tevent.subtype = 'trackName';\n\t\t\t\t\t\tevent.text = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x04:\n\t\t\t\t\t\tevent.subtype = 'instrumentName';\n\t\t\t\t\t\tevent.text = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x05:\n\t\t\t\t\t\tevent.subtype = 'lyrics';\n\t\t\t\t\t\tevent.text = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x06:\n\t\t\t\t\t\tevent.subtype = 'marker';\n\t\t\t\t\t\tevent.text = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x07:\n\t\t\t\t\t\tevent.subtype = 'cuePoint';\n\t\t\t\t\t\tevent.text = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x20:\n\t\t\t\t\t\tevent.subtype = 'midiChannelPrefix';\n\t\t\t\t\t\tif (length != 1) throw \"Expected length for midiChannelPrefix event is 1, got \" + length;\n\t\t\t\t\t\tevent.channel = stream.readInt8();\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x2f:\n\t\t\t\t\t\tevent.subtype = 'endOfTrack';\n\t\t\t\t\t\tif (length != 0) throw \"Expected length for endOfTrack event is 0, got \" + length;\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x51:\n\t\t\t\t\t\tevent.subtype = 'setTempo';\n\t\t\t\t\t\tif (length != 3) throw \"Expected length for setTempo event is 3, got \" + length;\n\t\t\t\t\t\tevent.microsecondsPerBeat = (\n\t\t\t\t\t\t\t(stream.readInt8() << 16)\n\t\t\t\t\t\t\t+ (stream.readInt8() << 8)\n\t\t\t\t\t\t\t+ stream.readInt8()\n\t\t\t\t\t\t)\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x54:\n\t\t\t\t\t\tevent.subtype = 'smpteOffset';\n\t\t\t\t\t\tif (length != 5) throw \"Expected length for smpteOffset event is 5, got \" + length;\n\t\t\t\t\t\tvar hourByte = stream.readInt8();\n\t\t\t\t\t\tevent.frameRate = {\n\t\t\t\t\t\t\t0x00: 24, 0x20: 25, 0x40: 29, 0x60: 30\n\t\t\t\t\t\t}[hourByte & 0x60];\n\t\t\t\t\t\tevent.hour = hourByte & 0x1f;\n\t\t\t\t\t\tevent.min = stream.readInt8();\n\t\t\t\t\t\tevent.sec = stream.readInt8();\n\t\t\t\t\t\tevent.frame = stream.readInt8();\n\t\t\t\t\t\tevent.subframe = stream.readInt8();\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x58:\n\t\t\t\t\t\tevent.subtype = 'timeSignature';\n\t\t\t\t\t\tif (length != 4) throw \"Expected length for timeSignature event is 4, got \" + length;\n\t\t\t\t\t\tevent.numerator = stream.readInt8();\n\t\t\t\t\t\tevent.denominator = Math.pow(2, stream.readInt8());\n\t\t\t\t\t\tevent.metronome = stream.readInt8();\n\t\t\t\t\t\tevent.thirtyseconds = stream.readInt8();\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x59:\n\t\t\t\t\t\tevent.subtype = 'keySignature';\n\t\t\t\t\t\tif (length != 2) throw \"Expected length for keySignature event is 2, got \" + length;\n\t\t\t\t\t\tevent.key = stream.readInt8(true);\n\t\t\t\t\t\tevent.scale = stream.readInt8();\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tcase 0x7f:\n\t\t\t\t\t\tevent.subtype = 'sequencerSpecific';\n\t\t\t\t\t\tevent.data = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// console.log(\"Unrecognised meta event subtype: \" + subtypeByte);\n\t\t\t\t\t\tevent.subtype = 'unknown'\n\t\t\t\t\t\tevent.data = stream.read(length);\n\t\t\t\t\t\treturn event;\n\t\t\t\t}\n\t\t\t\tevent.data = stream.read(length);\n\t\t\t\treturn event;\n\t\t\t} else if (eventTypeByte == 0xf0) {\n\t\t\t\tevent.type = 'sysEx';\n\t\t\t\tvar length = stream.readVarInt();\n\t\t\t\tevent.data = stream.read(length);\n\t\t\t\treturn event;\n\t\t\t} else if (eventTypeByte == 0xf7) {\n\t\t\t\tevent.type = 'dividedSysEx';\n\t\t\t\tvar length = stream.readVarInt();\n\t\t\t\tevent.data = stream.read(length);\n\t\t\t\treturn event;\n\t\t\t} else {\n\t\t\t\tthrow \"Unrecognised MIDI event type byte: \" + eventTypeByte;\n\t\t\t}\n\t\t} else {\n\t\t\t/* channel event */\n\t\t\tvar param1;\n\t\t\tif ((eventTypeByte & 0x80) == 0) {\n\t\t\t\t/* running status - reuse lastEventTypeByte as the event type.\n\t\t\t\t\teventTypeByte is actually the first parameter\n\t\t\t\t*/\n\t\t\t\tparam1 = eventTypeByte;\n\t\t\t\teventTypeByte = lastEventTypeByte;\n\t\t\t} else {\n\t\t\t\tparam1 = stream.readInt8();\n\t\t\t\tlastEventTypeByte = eventTypeByte;\n\t\t\t}\n\t\t\tvar eventType = eventTypeByte >> 4;\n\t\t\tevent.channel = eventTypeByte & 0x0f;\n\t\t\tevent.type = 'channel';\n\t\t\tswitch (eventType) {\n\t\t\t\tcase 0x08:\n\t\t\t\t\tevent.subtype = 'noteOff';\n\t\t\t\t\tevent.noteNumber = param1;\n\t\t\t\t\tevent.velocity = stream.readInt8();\n\t\t\t\t\treturn event;\n\t\t\t\tcase 0x09:\n\t\t\t\t\tevent.noteNumber = param1;\n\t\t\t\t\tevent.velocity = stream.readInt8();\n\t\t\t\t\tif (event.velocity == 0) {\n\t\t\t\t\t\tevent.subtype = 'noteOff';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.subtype = 'noteOn';\n\t\t\t\t\t}\n\t\t\t\t\treturn event;\n\t\t\t\tcase 0x0a:\n\t\t\t\t\tevent.subtype = 'noteAftertouch';\n\t\t\t\t\tevent.noteNumber = param1;\n\t\t\t\t\tevent.amount = stream.readInt8();\n\t\t\t\t\treturn event;\n\t\t\t\tcase 0x0b:\n\t\t\t\t\tevent.subtype = 'controller';\n\t\t\t\t\tevent.controllerType = param1;\n\t\t\t\t\tevent.value = stream.readInt8();\n\t\t\t\t\treturn event;\n\t\t\t\tcase 0x0c:\n\t\t\t\t\tevent.subtype = 'programChange';\n\t\t\t\t\tevent.programNumber = param1;\n\t\t\t\t\treturn event;\n\t\t\t\tcase 0x0d:\n\t\t\t\t\tevent.subtype = 'channelAftertouch';\n\t\t\t\t\tevent.amount = param1;\n\t\t\t\t\treturn event;\n\t\t\t\tcase 0x0e:\n\t\t\t\t\tevent.subtype = 'pitchBend';\n\t\t\t\t\tevent.value = param1 + (stream.readInt8() << 7);\n\t\t\t\t\treturn event;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Unrecognised MIDI event type: \" + eventType\n\t\t\t\t\t/* \n\t\t\t\t\tconsole.log(\"Unrecognised MIDI event type: \" + eventType);\n\t\t\t\t\tstream.readInt8();\n\t\t\t\t\tevent.subtype = 'unknown';\n\t\t\t\t\treturn event;\n\t\t\t\t\t*/\n\t\t\t}\n\t\t}\n\t}\n\t\n\tstream = Stream(data);\n\tvar headerChunk = readChunk(stream);\n\tif (headerChunk.id != 'MThd' || headerChunk.length != 6) {\n\t\tthrow \"Bad .mid file - header not found\";\n\t}\n\tvar headerStream = Stream(headerChunk.data);\n\tvar formatType = headerStream.readInt16();\n\tvar trackCount = headerStream.readInt16();\n\tvar timeDivision = headerStream.readInt16();\n\t\n\tif (timeDivision & 0x8000) {\n\t\tthrow \"Expressing time division in SMTPE frames is not supported yet\"\n\t} else {\n\t\tticksPerBeat = timeDivision;\n\t}\n\t\n\tvar header = {\n\t\t'formatType': formatType,\n\t\t'trackCount': trackCount,\n\t\t'ticksPerBeat': ticksPerBeat\n\t}\n\tvar tracks = [];\n\tfor (var i = 0; i < header.trackCount; i++) {\n\t\ttracks[i] = [];\n\t\tvar trackChunk = readChunk(stream);\n\t\tif (trackChunk.id != 'MTrk') {\n\t\t\tthrow \"Unexpected chunk - expected MTrk, got \"+ trackChunk.id;\n\t\t}\n\t\tvar trackStream = Stream(trackChunk.data);\n\t\twhile (!trackStream.eof()) {\n\t\t\tvar event = readEvent(trackStream);\n\t\t\ttracks[i].push(event);\n\t\t\t//console.log(event);\n\t\t}\n\t}\n\t\n\treturn {\n\t\t'header': header,\n\t\t'tracks': tracks\n\t}\n};\n\n/* Wrapper for accessing strings through sequential reads */\nfunction Stream(str) {\n\tvar position = 0;\n\t\n\tfunction read(length) {\n\t\tvar result = str.substr(position, length);\n\t\tposition += length;\n\t\treturn result;\n\t}\n\t\n\t/* read a big-endian 32-bit integer */\n\tfunction readInt32() {\n\t\tvar result = (\n\t\t\t(str.charCodeAt(position) << 24)\n\t\t\t+ (str.charCodeAt(position + 1) << 16)\n\t\t\t+ (str.charCodeAt(position + 2) << 8)\n\t\t\t+ str.charCodeAt(position + 3));\n\t\tposition += 4;\n\t\treturn result;\n\t}\n\n\t/* read a big-endian 16-bit integer */\n\tfunction readInt16() {\n\t\tvar result = (\n\t\t\t(str.charCodeAt(position) << 8)\n\t\t\t+ str.charCodeAt(position + 1));\n\t\tposition += 2;\n\t\treturn result;\n\t}\n\t\n\t/* read an 8-bit integer */\n\tfunction readInt8(signed) {\n\t\tvar result = str.charCodeAt(position);\n\t\tif (signed && result > 127) result -= 256;\n\t\tposition += 1;\n\t\treturn result;\n\t}\n\t\n\tfunction eof() {\n\t\treturn position >= str.length;\n\t}\n\t\n\t/* read a MIDI-style variable-length integer\n\t\t(big-endian value in groups of 7 bits,\n\t\twith top bit set to signify that another byte follows)\n\t*/\n\tfunction readVarInt() {\n\t\tvar result = 0;\n\t\twhile (true) {\n\t\t\tvar b = readInt8();\n\t\t\tif (b & 0x80) {\n\t\t\t\tresult += (b & 0x7f);\n\t\t\t\tresult <<= 7;\n\t\t\t} else {\n\t\t\t\t/* b is the last byte */\n\t\t\t\treturn result + b;\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn {\n\t\t'eof': eof,\n\t\t'read': read,\n\t\t'readInt32': readInt32,\n\t\t'readInt16': readInt16,\n\t\t'readInt8': readInt8,\n\t\t'readVarInt': readVarInt\n\t}\n}","/**\n * Return the index of the element at or before the given time\n */\nfunction findElement(array, time) {\n\tlet beginning = 0\n\tconst len = array.length\n\tlet end = len\n\tif (len > 0 && array[len - 1].time <= time){\n\t\treturn len - 1\n\t}\n\twhile (beginning < end){\n\t\t// calculate the midpoint for roughly equal partition\n\t\tlet midPoint = Math.floor(beginning + (end - beginning) / 2)\n\t\tconst event = array[midPoint]\n\t\tconst nextEvent = array[midPoint + 1]\n\t\tif (event.time === time){\n\t\t\t//choose the last one that has the same time\n\t\t\tfor (let i = midPoint; i < array.length; i++){\n\t\t\t\tlet testEvent = array[i]\n\t\t\t\tif (testEvent.time === time){\n\t\t\t\t\tmidPoint = i\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn midPoint\n\t\t} else if (event.time < time && nextEvent.time > time){\n\t\t\treturn midPoint\n\t\t} else if (event.time > time){\n\t\t\t//search lower\n\t\t\tend = midPoint\n\t\t} else if (event.time < time){\n\t\t\t//search upper\n\t\t\tbeginning = midPoint + 1\n\t\t}\n\t}\n\treturn -1\n}\n\n/**\n * Does a binary search to insert the note\n * in the correct spot in the array\n * @param  {Array} array\n * @param  {Object} event\n * @param  {Number=} offset\n */\nfunction BinaryInsert(array, event){\n\tif (array.length){\n\t\tconst index = findElement(array, event.time)\n\t\tarray.splice(index + 1, 0, event)\n\t} else {\n\t\tarray.push(event)\n\t}\n}\n\nexport {BinaryInsert}\n","const channelNames = {\n\t\"1\"  : \"modulationWheel\",\n\t\"2\"  : \"breath\",\n\t\"4\"  : \"footController\",\n\t\"5\"  : \"portamentoTime\",\n\t\"7\"  : \"volume\",\n\t\"8\"  : \"balance\",\n\t\"10\" : \"pan\",\n\t\"64\" : \"sustain\",\n\t\"65\" : \"portamentoTime\",\n\t\"66\" : \"sostenuto\",\n\t\"67\" : \"softPedal\",\n\t\"68\" : \"legatoFootswitch\",\n\t\"84\" : \"portamentoContro\"\n}\n\nclass Control{\n\tconstructor(number, time, value){\n\n\t\tthis.number = number\n\n\t\tthis.time = time\n\n\t\tthis.value = value\n\t}\n\n\t/**\n\t * The common name of the control change event\n\t * @type {String}\n\t * @readOnly\n\t */\n\tget name(){\n\t\tif (channelNames.hasOwnProperty(this.number)){\n\t\t\treturn channelNames[this.number]\n\t\t}\n\t}\n}\n\nexport {Control}\n","/**\n *  Parse tempo and time signature from the midiJson\n *  @param  {Object}  midiJson\n *  @return  {Object}\n */\nfunction parseHeader(midiJson){\n\tvar ret = {\n\t\tPPQ : midiJson.header.ticksPerBeat\n\t}\n\tfor (var i = 0; i < midiJson.tracks.length; i++){\n\t\tvar track = midiJson.tracks[i]\n\t\tfor (var j = 0; j < track.length; j++){\n\t\t\tvar datum = track[j]\n\t\t\tif (datum.type === \"meta\"){\n\t\t\t\tif (datum.subtype === \"timeSignature\"){\n\t\t\t\t\tret.timeSignature = [datum.numerator, datum.denominator]\n\t\t\t\t} else if (datum.subtype === \"setTempo\"){\n\t\t\t\t\tif (!ret.bpm){\n\t\t\t\t\t\tret.bpm = 60000000 / datum.microsecondsPerBeat\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tret.bpm = ret.bpm || 120\n\treturn ret\n}\n\nexport {parseHeader}\n","\nfunction hasMoreValues(arrays, positions){\n\tfor (let i = 0; i < arrays.length; i++){\n\t\tlet arr = arrays[i]\n\t\tlet pos = positions[i]\n\t\tif (arr.length > pos){\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nfunction getLowestAtPosition(arrays, positions, encoders){\n\tlet lowestIndex = 0\n\tlet lowestValue = Infinity\n\tfor (let i = 0; i < arrays.length; i++){\n\t\tlet arr = arrays[i]\n\t\tlet pos = positions[i]\n\t\tif (arr[pos] && (arr[pos].time < lowestValue)){\n\t\t\tlowestIndex = i\n\t\t\tlowestValue = arr[pos].time\n\t\t}\n\t}\n\tencoders[lowestIndex](arrays[lowestIndex][positions[lowestIndex]])\n\t// increment array\n\tpositions[lowestIndex] += 1\n}\n\n/**\n * Combine multiple arrays keeping the timing in order\n * The arguments should alternate between the array and the encoder callback\n * @param {...Array|Function} args\n */\nfunction Merge(...args){\n\tconst arrays = args.filter((v, i) => (i % 2) === 0)\n\tconst positions = new Uint32Array(arrays.length)\n\tconst encoders = args.filter((v, i) => (i % 2) === 1)\n\tconst output = []\n\twhile(hasMoreValues(arrays, positions)){\n\t\tgetLowestAtPosition(arrays, positions, encoders)\n\t}\n}\n\nexport {Merge}","import * as Decoder from 'midi-file-parser'\nimport * as Encoder from 'jsmidgen'\nimport * as Util from './Util'\nimport {Track} from './Track'\nimport {parseHeader} from './Header'\n\n/**\n * @class The Midi object. Contains tracks and the header info.\n */\nclass Midi {\n\t/**\n\t * Convert JSON to Midi object\n\t * @param {object} json\n\t * @static\n\t * @returns {Midi}\n\t */\n\tstatic fromJSON(json){\n\t\tvar midi = new Midi()\n\n\t\tmidi.header = json.header\n\t\tjson.tracks.forEach((track) => {\n\t\t\tvar newTrack = Track.fromJSON(track)\n\t\t\tmidi.tracks.push(newTrack)\n\t\t})\n\n\t\treturn midi\n\t}\n\t\n\tconstructor(){\n\n\t\tthis.header = {\n\t\t\t//defaults\n\t\t\tbpm : 120,\n\t\t\ttimeSignature : [4, 4],\n\t\t\tPPQ : 480\n\t\t}\n\n\t\tthis.tracks = []\n\t}\n\n\t/**\n\t * Load the given url and parse the midi at that url\n\t * @param  {String}   url\n\t * @param {*} data Anything that should be sent in the XHR\n\t * @param {String} method Either GET or POST\n\t * @return {Promise}\n\t */\n\tload(url, data=null, method='GET'){\n\t\treturn new Promise((success, fail) => {\n\t\t\tvar request = new XMLHttpRequest()\n\t\t\trequest.open(method, url)\n\t\t\trequest.responseType = 'arraybuffer'\n\t\t\t// decode asynchronously\n\t\t\trequest.addEventListener('load', () => {\n\t\t\t\tif (request.readyState === 4 && request.status === 200){\n\t\t\t\t\tsuccess(this.decode(request.response))\n\t\t\t\t} else {\n\t\t\t\t\tfail(request.status)\n\t\t\t\t}\n\t\t\t})\n\t\t\trequest.addEventListener('error', fail)\n\t\t\trequest.send(data)\n\t\t}).catch(function(error) {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t}\n\n\t/**\n\t * Decode the bytes\n\t * @param  {String|ArrayBuffer} bytes The midi file encoded as a string or ArrayBuffer\n\t * @return {Midi}       this\n\t */\n\tdecode(bytes){\n\n\t\tif (bytes instanceof ArrayBuffer){\n\t\t\tvar byteArray = new Uint8Array(bytes)\n\t\t\tbytes = String.fromCharCode.apply(null, byteArray)\n\t\t}\n\n\t\tconst midiData = Decoder(bytes)\n\n\t\tthis.header = parseHeader(midiData)\n\n\t\t//replace the previous tracks\n\t\tthis.tracks = []\n\n\t\tmidiData.tracks.forEach((trackData, i) => {\n\n\t\t\tconst track = new Track()\n\t\t\ttrack.id = i\n\t\t\tthis.tracks.push(track)\n\n\t\t\tlet absoluteTime = 0\n\t\t\ttrackData.forEach((event) => {\n\t\t\t\tabsoluteTime += Util.ticksToSeconds(event.deltaTime, this.header)\n\t\t\t\tif (event.type === 'meta' && event.subtype === 'trackName'){\n\t\t\t\t\ttrack.name = Util.cleanName(event.text)\n\t\t\t\t} else if (event.subtype === 'noteOn'){\n\t\t\t\t\ttrack.noteOn(event.noteNumber, absoluteTime, event.velocity / 127)\n\n\t\t\t\t\tif (track.channelNumber === -1) {\n\t\t\t\t\t\ttrack.channelNumber = event.channel\n\t\t\t\t\t}\n\t\t\t\t} else if (event.subtype === 'noteOff'){\n\t\t\t\t\ttrack.noteOff(event.noteNumber, absoluteTime)\n\t\t\t\t} else if (event.subtype === 'controller' && event.controllerType){\n\t\t\t\t\ttrack.cc(event.controllerType, absoluteTime, event.value / 127)\n\t\t\t\t} else if (event.type === 'meta' && event.subtype === 'instrumentName'){\n\t\t\t\t\ttrack.instrument = event.text\n\t\t\t\t} else if (event.type === 'channel' && event.subtype === 'programChange'){\n\t\t\t\t\ttrack.patch(event.programNumber)\n\t\t\t\t\ttrack.channelNumber = event.channel\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t//if the track is empty, then it is the file name\n\t\t\tif (!this.header.name && !track.length && track.name) {\n\t\t\t\tthis.header.name = track.name;\n\t\t\t}\n\t\t})\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Encode the Midi object as a Buffer String\n\t * @returns {String}\n\t */\n\tencode(){\n\t\tconst output = new Encoder.File({\n\t\t\tticks : this.header.PPQ\n\t\t})\n\n\t\tconst firstEmptyTrack = this.tracks.filter(track => !track.length)[0];\n\n\t\tif (this.header.name && !(firstEmptyTrack && firstEmptyTrack.name === this.header.name)) {\n\t\t\tconst track = output.addTrack()\n\t\t\ttrack.addEvent(\n\t\t\t\tnew Encoder.MetaEvent({\n\t\t\t\t\ttime: 0,\n\t\t\t\t\ttype: Encoder.MetaEvent.TRACK_NAME,\n\t\t\t\t\tdata: this.header.name\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\n\t\tthis.tracks.forEach((track) => {\n\t\t\tconst trackEncoder = output.addTrack()\n\t\t\ttrackEncoder.setTempo(this.bpm)\n\n\t\t\tif (track.name) {\n\t\t\t\ttrackEncoder.addEvent(\n\t\t\t\t\tnew Encoder.MetaEvent({\n\t\t\t\t\t\ttime: 0,\n\t\t\t\t\t\ttype: Encoder.MetaEvent.TRACK_NAME,\n\t\t\t\t\t\tdata: track.name\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\n\t\t\ttrack.encode(trackEncoder, this.header)\n\t\t})\n\t\treturn output.toBytes()\n\t}\n\n\t/**\n\t * Convert the output encoding into an Array\n\t * @return {Array}\n\t */\n\ttoArray(){\n\t\tconst encodedStr = this.encode()\n\t\tconst buffer = new Array(encodedStr.length)\n\t\tfor (let i = 0; i < encodedStr.length; i++){\n\t\t\tbuffer[i] = encodedStr.charCodeAt(i)\n\t\t}\n\t\treturn buffer\n\t}\n\n\t/**\n\t *  Convert all of the fields to JSON\n\t *  @return  {Object}\n\t */\n\ttoJSON(){\n\t\tconst ret = {\n\t\t\theader: this.header,\n\t\t\tstartTime: this.startTime,\n\t\t\tduration: this.duration,\n\t\t\ttracks: (this.tracks || []).map(\n\t\t\t\ttrack => track.toJSON()\n\t\t\t)\n\t\t}\n\n\t\tif (!ret.header.name)\n\t\t\tret.header.name = ''\n\n\t\treturn ret\n\t}\n\n\t/**\n\t * Add a new track.\n\t * @param {String=} name Optionally include the name of the track\n\t * @returns {Track}\n\t */\n\ttrack(name){\n\t\tconst track = new Track(name)\n\t\tthis.tracks.push(track)\n\t\treturn track\n\t}\n\n\t/**\n\t * Get a track either by it's name or track index\n\t * @param  {Number|String} trackName\n\t * @return {Track}\n\t */\n\tget(trackName){\n\t\tif (Util.isNumber(trackName)){\n\t\t\treturn this.tracks[trackName]\n\t\t} else {\n\t\t\treturn this.tracks.find((t) => t.name === trackName)\n\t\t}\n\t}\n\n\t/**\n\t * Slice the midi file between the startTime and endTime. Returns a copy of the\n\t * midi\n\t * @param {Number} startTime\n\t * @param {Number} endTime\n\t * @returns {Midi} this\n\t */\n\tslice(startTime=0, endTime=this.duration){\n\t\tconst midi = new Midi()\n\t\tmidi.header = this.header\n\t\tmidi.tracks = this.tracks.map((t) => t.slice(startTime, endTime))\n\t\treturn midi\n\t}\n\n\t/**\n\t * the time of the first event\n\t * @type {Number}\n\t */\n\tget startTime(){\n\t\tconst startTimes = this.tracks.map((t) => t.startTime)\n\n\t\tif (!startTimes.length)\n\t\t\treturn 0\n\n\t\treturn Math.min.apply(Math, startTimes) || 0\n\t}\n\n\t/**\n\t * The bpm of the midi file in beats per minute\n\t * @type {Number}\n\t */\n\tget bpm(){\n\t\treturn this.header.bpm\n\t}\n\tset bpm(bpm){\n\t\tconst prevTempo = this.header.bpm\n\t\tthis.header.bpm = bpm\n\t\t//adjust the timing of all the notes\n\t\tconst ratio = prevTempo / bpm\n\t\tthis.tracks.forEach((track) => track.scale(ratio))\n\n\t}\n\n\t/**\n\t * The timeSignature of the midi file\n\t * @type {Array}\n\t */\n\tget timeSignature(){\n\t\treturn this.header.timeSignature\n\t}\n\tset timeSignature(timeSig){\n\t\tthis.header.timeSignature = timeSig\n\t}\n\n\t/**\n\t * The duration is the end time of the longest track\n\t * @type {Number}\n\t */\n\tget duration(){\n\t\tconst durations = this.tracks.map((t) => t.duration)\n\n\t\tif (!durations.length)\n\t\t\treturn 0\n\n\t\treturn Math.max.apply(Math, durations) || 0\n\t}\n}\n\nexport {Midi}\n","import {Midi} from './Midi'\nexport {instrumentByPatchID, instrumentFamilyByID, drumKitByPatchID} from './instrumentMaps'\n\n/**\n *  Parse all the data from the Midi file into this format:\n *  {\n *  \t// the transport and timing data\n *  \theader : {\n *  \t\tbpm : Number,                     // tempo, e.g. 120\n *  \t\ttimeSignature : [Number, Number], // time signature, e.g. [4, 4],\n *  \t\tPPQ : Number                  // PPQ of the midi file\n *  \t}\n *  \t// an array for each of the midi tracks\n *  \ttracks : [\n *  \t\t{\n *  \t\t\tname : String, // the track name if one was given\n *  \t\t\tnotes : [\n *  \t\t\t\t{\n *  \t\t\t\t\ttime : Number, // time in seconds\n *  \t\t\t\t\tname : String, // note name, e.g. 'C4'\n *  \t\t\t\t\tmidi : Number, // midi number, e.g. 60\n *  \t\t\t\t\tvelocity : Number,  // normalized velocity\n *  \t\t\t\t\tduration : Number   // duration between noteOn and noteOff\n *  \t\t\t\t}\n *  \t\t\t],\n *  \t\t\tcontrolChanges : { //all of the control changes\n *  \t\t\t\t64 : [ //array for each cc value\n *  \t\t\t\t\t{\n *  \t\t\t\t\t\tnumber : Number, //the cc number\n *  \t\t\t\t\t\ttime : Number, //the time of the event in seconds\n *  \t\t\t\t\t\tname : String, // if the cc value has a common name (e.g. 'sustain')\n *  \t\t\t\t\t\tvalue : Number, //the normalized value\n *  \t\t\t\t\t}\n *  \t\t\t\t]\n *  \t\t\t}\n *  \t\t}\n *  \t]\n *  }\n *  @param  {Binary String}  fileBlob  The output from fs.readFile or FileReader\n *  @returns {Object} All of the options parsed from the midi file.\n */\nexport function parse(fileBlob){\n\treturn new Midi().decode(fileBlob)\n}\n\n/**\n *  Load and parse a midi file. See `parse` for what the results look like.\n *  @param  {String}    url\n *  @param {Function=} callback\n *  @returns {Promise} A promise which is invoked with the returned Midi object\n */\nexport function load(url, callback){\n\tconst promise = new Midi().load(url)\n\tif (callback){\n\t\tpromise.then(callback)\n\t}\n\treturn promise\n}\n\n/**\n * Create an empty midi file\n * @return {Midi}\n */\nexport function create(){\n\treturn new Midi()\n}\n\n/**\n * Create midi object from json\n * @param {object} json\n * @returns {Midi} Deserialized midi object\n */\nexport function fromJSON(json){\n\treturn Midi.fromJSON(json)\n}\n","import * as Util from './Util'\n\nclass Note{\n\t/**\n\t * Convert JSON to Note object\n\t * @param {object} json\n\t * @static\n\t * @returns {Note}\n\t */\n\tstatic fromJSON(json) {\n\t\tvar note = new Note(json.midi, json.time, json.duration, json.velocity)\n\t\treturn note\n\t}\n\t\n\tconstructor(midi, time, duration=0, velocity=1){\n\n\t\t/**\n\t\t * The MIDI note number\n\t\t * @type {Number}\n\t\t */\n\t\tif (Util.isNumber(midi)){\n\t\t\tthis.midi = midi\n\t\t} else if (Util.isPitch(midi)){\n\t\t\tthis.name = midi\n\t\t} else {\n\t\t\tthrow new Error('the midi value must either be in Pitch Notation (e.g. C#4) or a midi value')\n\t\t}\n\n\t\t/**\n\t\t * The note on time in seconds\n\t\t * @type {Number}\n\t\t */\n\t\tthis.time = time\n\n\t\t/**\n\t\t * The duration in seconds\n\t\t * @type {Number}\n\t\t */\n\t\tthis.duration = duration\n\n\t\t/**\n\t\t * The velocity 0-1\n\t\t * @type {Number}\n\t\t */\n\t\tthis.velocity = velocity\n\t}\n\n\t/**\n\t * If the note is the same as the given note\n\t * @param {String|Number} note\n\t * @return {Boolean}\n\t */\n\tmatch(note){\n\t\tif (Util.isNumber(note)){\n\t\t\treturn this.midi === note\n\t\t} else if (Util.isPitch(note)){\n\t\t\treturn this.name.toLowerCase() === note.toLowerCase()\n\t\t}\n\t}\n\n\t/**\n\t * The note in Scientific Pitch Notation\n\t * @type {String}\n\t */\n\tget name(){\n\t\treturn Util.midiToPitch(this.midi)\n\t}\n\tset name(name){\n\t\tthis.midi = Util.pitchToMidi(name)\n\t}\n\n\t/**\n\t * Alias for time\n\t * @type {Number}\n\t */\n\tget noteOn(){\n\t\treturn this.time\n\t}\n\tset noteOn(t){\n\t\tthis.time = t\n\t}\n\n\t/**\n\t * The note off time\n\t * @type {Number}\n\t */\n\tget noteOff(){\n\t\treturn this.time + this.duration\n\t}\n\tset noteOff(time){\n\t\tthis.duration = time - this.time\n\t}\n\n\t/**\n\t * Convert the note to JSON\n\t * @returns {Object}\n\t */\n\ttoJSON(){\n\t\treturn {\n\t\t\tname : this.name,\n\t\t\tmidi : this.midi,\n\t\t\ttime : this.time,\n\t\t\tvelocity : this.velocity,\n\t\t\tduration : this.duration\n\t\t}\n\t}\n}\n\nexport {Note}\n","import {BinaryInsert} from './BinaryInsert'\nimport {Control} from './Control'\nimport {Merge} from './Merge'\nimport {Note} from './Note'\nimport {instrumentByPatchID, instrumentFamilyByID, drumKitByPatchID} from './instrumentMaps'\n\nclass Track {\n/**\n\t * Convert JSON to Track object\n\t * @param {object} json\n\t * @static\n\t * @returns {Track}\n\t */\n\tstatic fromJSON(json){\n\t\tvar track = new Track(json.name, json.instrumentNumber, json.channelNumber )\n\n\t\ttrack.id = json.id\n\t\t\n\t\tif (json.notes) {\n\t\t\tjson.notes.forEach((note) => {\n\t\t\t\tvar newNote = Note.fromJSON(note)\n\t\t\t\ttrack.notes.push(newNote)\n\t\t\t})\n\t\t}\n\n\t\tif (json.controlChanges) {\n\t\t\ttrack.controlChanges = json.controlChanges\n\t\t}\n\n\t\treturn track\n\t}\n\t\n\tconstructor(name, instrumentNumber=-1, channel=-1){\n\n\t\t/**\n\t\t * The name of the track\n\t\t * @type {String}\n\t\t */\n\t\tthis.name = name\n\n\t\t/**\n\t\t * The MIDI channel of the track\n\t\t * @type {number}\n\t\t */\n\t\tthis.channelNumber = channel\n\n\t\t/**\n\t\t * The note events\n\t\t * @type {Array}\n\t\t */\n\t\tthis.notes = []\n\n\t\t/**\n\t\t * The control changes\n\t\t * @type {Object}\n\t\t */\n\t\tthis.controlChanges = {}\n\n\t\t/**\n\t\t * The MIDI patch ID of the instrument. -1 if none is set.\n\t\t * @type {Number}\n\t\t */\n\t\tthis.instrumentNumber = instrumentNumber\n\t}\n\n\tnote(midi, time, duration=0, velocity=1){\n\t\tconst note = new Note(midi, time, duration, velocity)\n\t\tBinaryInsert(this.notes, note)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add a note on event\n\t * @param  {Number|String} midi     The midi note as either a midi number or\n\t *                                  Pitch Notation like ('C#4')\n\t * @param  {Number} time     The time in seconds\n\t * @param  {Number} velocity The velocity value 0-1\n\t * @return {Track} this\n\t */\n\tnoteOn(midi, time, velocity=1){\n\t\tconst note = new Note(midi, time, 0, velocity)\n\t\tBinaryInsert(this.notes, note)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add a note off event. Go through and find an unresolved\n\t * noteOn event with the same pitch.\n\t * @param  {String|Number} midi The midi number or note name.\n\t * @param  {Number} time The time of the event in seconds\n\t * @return {Track} this\n\t */\n\tnoteOff(midi, time){\n\t\tfor (let i = 0; i < this.notes.length; i++){\n\t\t\tlet note = this.notes[i]\n\t\t\tif (note.match(midi) && note.duration === 0){\n\t\t\t\tnote.noteOff = time\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn this\n\t}\n\n\t/**\n\t * Add a CC event\n\t * @param  {Number} num The CC number\n\t * @param  {Number} time The time of the event in seconds\n\t * @param  {Number} value The value of the CC\n\t * @return {Track} this\n\t */\n\tcc(num, time, value){\n\t\tif (!this.controlChanges.hasOwnProperty(num)){\n\t\t\tthis.controlChanges[num] = []\n\t\t}\n\t\tconst cc = new Control(num, time, value)\n\t\tBinaryInsert(this.controlChanges[num], cc)\n\t\treturn this\n\t}\n\n\t/**\n\t * Sets instrumentNumber.\n\t * For a list of possible values, see the [General MIDI Instrument Patch Map](https://www.midi.org/specifications/item/gm-level-1-sound-set)\n\t * @param  {Number} id The Patch ID for this instrument, as specified in the General MIDI Instrument Patch Map\n\t */\n\tpatch(id){\n\t\tthis.instrumentNumber = id\n\t\treturn this\n\t}\n\n\t/**\n\t * Sets channelNumber.\n\t * @param  {Number} id The MIDI channel number, between 0 and 0xF.  0x9 and 0xA are percussion\n\t */\n\tchannel(id){\n\t\tthis.channelNumber = id\n\t\treturn this\n\t}\n\n\t/**\n\t * An array of all the note on events\n\t * @type {Array<Object>}\n\t * @readOnly\n\t */\n\tget noteOns(){\n\t\tconst noteOns = []\n\t\tthis.notes.forEach((note) => {\n\t\t\tnoteOns.push({\n\t\t\t\ttime : note.noteOn,\n\t\t\t\tmidi : note.midi,\n\t\t\t\tname : note.name,\n\t\t\t\tvelocity : note.velocity\n\t\t\t})\n\t\t})\n\t\treturn noteOns\n\t}\n\n\t/**\n\t * An array of all the noteOff events\n\t * @type {Array<Object>}\n\t * @readOnly\n\t */\n\tget noteOffs(){\n\t\tconst noteOffs = []\n\t\tthis.notes.forEach((note) => {\n\t\t\tnoteOffs.push({\n\t\t\t\ttime : note.noteOff,\n\t\t\t\tmidi : note.midi,\n\t\t\t\tname : note.name\n\t\t\t})\n\t\t})\n\t\treturn noteOffs\n\t}\n\n\t/**\n\t * The length in seconds of the track\n\t * @type {Number}\n\t */\n\tget length() {\n\t\treturn this.notes.length\n\t}\n\n\t/**\n\t * The time of the first event in seconds\n\t * @type {Number}\n\t */\n\tget startTime() {\n\t\tif (this.notes.length){\n\t\t\tlet firstNote = this.notes[0]\n\t\t\treturn firstNote.noteOn\n\t\t} else {\n\t\t\treturn 0\n\t\t}\n\t}\n\n\t/**\n\t * The time of the last event in seconds\n\t * @type {Number}\n\t */\n\tget duration() {\n\t\tif (this.notes.length){\n\t\t\tlet lastNote = this.notes[this.notes.length - 1]\n\t\t\treturn lastNote.noteOff\n\t\t} else {\n\t\t\treturn 0\n\t\t}\n\t}\n\n\t/**\n\t * The name of the midi instrument\n\t * @type {String}\n\t */\n\tget instrument() {\n\t\tif (this.isPercussion){\n\t\t\treturn drumKitByPatchID[this.instrumentNumber]\n\t\t} else {\n\t\t\treturn instrumentByPatchID[this.instrumentNumber]\n\t\t}\n\t}\n\tset instrument(inst) {\n\t\tconst index = instrumentByPatchID.indexOf(inst)\n\t\tif (index !== -1){\n\t\t\tthis.instrumentNumber = index\n\t\t}\n\t}\n\n\n\t/**\n\t * Whether or not this is a percussion track\n\t * @type {Boolean}\n\t */\n\tget isPercussion() {\n\t\treturn [0x9, 0xA].includes(this.channelNumber)\n\t}\n\n\t/**\n\t * The family that the instrument belongs to\n\t * @type {String}\n\t * @readOnly\n\t */\n\tget instrumentFamily() {\n\t\tif (this.isPercussion){\n\t\t\treturn 'drums'\n\t\t} else {\n\t\t\treturn instrumentFamilyByID[Math.floor(this.instrumentNumber / 8)]\n\t\t}\n\t}\n\n\t/**\n\t * Scale the timing of all the events in the track\n\t * @param {Number} amount The amount to scale all the values\n\t */\n\tscale(amount){\n\t\tthis.notes.forEach((note) => {\n\t\t\tnote.time *= amount\n\t\t\tnote.duration *= amount\n\t\t})\n\t\treturn this\n\t}\n\n\t/**\n\t * Slice returns a new track with only events that occured between startTime and endTime.\n\t * Modifies this track.\n\t * @param {Number} startTime\n\t * @param {Number} endTime\n\t * @returns {Track}\n\t */\n\tslice(startTime=0, endTime=this.duration){\n\t\t// get the index before the startTime\n\t\tconst noteStartIndex = Math.max(this.notes.findIndex((note) => note.time >= startTime), 0)\n\t\tconst noteEndIndex = this.notes.findIndex((note) => note.noteOff >= endTime) + 1\n\t\tconst track = new Track(this.name)\n\t\ttrack.notes = this.notes.slice(noteStartIndex, noteEndIndex)\n\t\t//shift the start time\n\t\ttrack.notes.forEach((note) => note.time = note.time - startTime)\n\t\treturn track\n\t}\n\n\t/**\n\t * Write the output to the stream\n\t */\n\tencode(trackEncoder, header){\n\n\t\tconst ticksPerSecond = header.PPQ / (60 / header.bpm)\n\t\tlet lastEventTime = 0\n\n\t\t// unset, `channelNumber` defaults to -1, but that's not a valid MIDI channel\n\t\tconst channelNumber = Math.max(0, this.channelNumber)\n\n\t\tfunction getDeltaTime(time){\n\t\t\tconst ticks = Math.floor(ticksPerSecond * time)\n\t\t\tconst delta = Math.max(ticks - lastEventTime, 0)\n\t\t\tlastEventTime = ticks\n\t\t\treturn delta\n\t\t}\n\n\t\tif (this.instrumentNumber !== -1) {\n\t\t\ttrackEncoder.instrument(channelNumber, this.instrumentNumber)\n\t\t}\n\n\t\tMerge(this.noteOns, (noteOn) => {\n\t\t\ttrackEncoder.addNoteOn(channelNumber, noteOn.name, getDeltaTime(noteOn.time), Math.floor(noteOn.velocity * 127))\n\t\t}, this.noteOffs, (noteOff) => {\n\t\t\ttrackEncoder.addNoteOff(channelNumber, noteOff.name, getDeltaTime(noteOff.time))\n\t\t})\n\t}\n\n\t/**\n\t *  Convert all of the fields to JSON\n\t *  @return  {Object}\n\t */\n\ttoJSON(){\n\n\t\tconst ret = {\n\t\t\tstartTime: this.startTime,\n\t\t\tduration: this.duration,\n\t\t\tlength: this.length,\n\t\t\tnotes: [],\n\t\t\tcontrolChanges: {},\n\t\t}\n\n\t\tif (typeof this.id !== 'undefined')\n\t\t\tret.id = this.id\n\n\t\tret.name = this.name\n\n\t\tif (this.instrumentNumber !== -1){\n\t\t\tret.instrumentNumber = this.instrumentNumber\n\t\t\tret.instrument = this.instrument\n\t\t\tret.instrumentFamily = this.instrumentFamily\n\t\t}\n\n\t\tif (this.channelNumber !== -1){\n\t\t\tret.channelNumber = this.channelNumber\n\t\t\tret.isPercussion = this.isPercussion\n\t\t}\n\n\t\tif (this.notes.length)\n\t\t\tret.notes = this.notes.map((n) => n.toJSON())\n\n\t\tif (Object.keys(this.controlChanges).length)\n\t\t\tret.controlChanges = this.controlChanges\n\n\t\treturn ret\n\t}\n}\n\nexport {Track}\n","export function cleanName(str){\n\t//ableton adds some weird stuff to the track\n\treturn str.replace(/\\u0000/g, '')\n}\n\nexport function ticksToSeconds(ticks, header){\n\treturn (60 / header.bpm) * (ticks / header.PPQ);\n}\n\nexport function isNumber(val){\n\treturn typeof val === 'number'\n}\n\nexport function isString(val){\n\treturn typeof val === 'string'\n}\n\nexport const isPitch = (function(){\n\tconst regexp = /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i\n\treturn (val) => {\n\t\treturn isString(val) && regexp.test(val)\n\t}\n}())\n\n\nexport function midiToPitch(midi){\n\tconst scaleIndexToNote = [\"C\", \"C#\", \"D\", \"D#\", \"E\", \"F\", \"F#\", \"G\", \"G#\", \"A\", \"A#\", \"B\"];\n\tconst octave = Math.floor(midi / 12) - 1;\n\tconst note = midi % 12;\n\treturn scaleIndexToNote[note] + octave;\n}\n\nexport const pitchToMidi = (function(){\n\tconst regexp = /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i\n\tconst noteToScaleIndex = {\n\t\t\"cbb\" : -2, \"cb\" : -1, \"c\" : 0,  \"c#\" : 1,  \"cx\" : 2,\n\t\t\"dbb\" : 0,  \"db\" : 1,  \"d\" : 2,  \"d#\" : 3,  \"dx\" : 4,\n\t\t\"ebb\" : 2,  \"eb\" : 3,  \"e\" : 4,  \"e#\" : 5,  \"ex\" : 6,\n\t\t\"fbb\" : 3,  \"fb\" : 4,  \"f\" : 5,  \"f#\" : 6,  \"fx\" : 7,\n\t\t\"gbb\" : 5,  \"gb\" : 6,  \"g\" : 7,  \"g#\" : 8,  \"gx\" : 9,\n\t\t\"abb\" : 7,  \"ab\" : 8,  \"a\" : 9,  \"a#\" : 10, \"ax\" : 11,\n\t\t\"bbb\" : 9,  \"bb\" : 10, \"b\" : 11, \"b#\" : 12, \"bx\" : 13,\n\t}\n\treturn (note) => {\n\t\tconst split = regexp.exec(note)\n\t\tconst pitch = split[1]\n\t\tconst octave = split[2]\n\t\tconst index = noteToScaleIndex[pitch.toLowerCase()]\n\t\treturn index + (parseInt(octave) + 1) * 12\n\t}\n}())\n","export const instrumentByPatchID = [\n\t\"acoustic grand piano\",\n\t\"bright acoustic piano\",\n\t\"electric grand piano\",\n\t\"honky-tonk piano\",\n\t\"electric piano 1\",\n\t\"electric piano 2\",\n\t\"harpsichord\",\n\t\"clavi\",\n\t\"celesta\",\n\t\"glockenspiel\",\n\t\"music box\",\n\t\"vibraphone\",\n\t\"marimba\",\n\t\"xylophone\",\n\t\"tubular bells\",\n\t\"dulcimer\",\n\t\"drawbar organ\",\n\t\"percussive organ\",\n\t\"rock organ\",\n\t\"church organ\",\n\t\"reed organ\",\n\t\"accordion\",\n\t\"harmonica\",\n\t\"tango accordion\",\n\t\"acoustic guitar (nylon)\",\n\t\"acoustic guitar (steel)\",\n\t\"electric guitar (jazz)\",\n\t\"electric guitar (clean)\",\n\t\"electric guitar (muted)\",\n\t\"overdriven guitar\",\n\t\"distortion guitar\",\n\t\"guitar harmonics\",\n\t\"acoustic bass\",\n\t\"electric bass (finger)\",\n\t\"electric bass (pick)\",\n\t\"fretless bass\",\n\t\"slap bass 1\",\n\t\"slap bass 2\",\n\t\"synth bass 1\",\n\t\"synth bass 2\",\n\t\"violin\",\n\t\"viola\",\n\t\"cello\",\n\t\"contrabass\",\n\t\"tremolo strings\",\n\t\"pizzicato strings\",\n\t\"orchestral harp\",\n\t\"timpani\",\n\t\"string ensemble 1\",\n\t\"string ensemble 2\",\n\t\"synthstrings 1\",\n\t\"synthstrings 2\",\n\t\"choir aahs\",\n\t\"voice oohs\",\n\t\"synth voice\",\n\t\"orchestra hit\",\n\t\"trumpet\",\n\t\"trombone\",\n\t\"tuba\",\n\t\"muted trumpet\",\n\t\"french horn\",\n\t\"brass section\",\n\t\"synthbrass 1\",\n\t\"synthbrass 2\",\n\t\"soprano sax\",\n\t\"alto sax\",\n\t\"tenor sax\",\n\t\"baritone sax\",\n\t\"oboe\",\n\t\"english horn\",\n\t\"bassoon\",\n\t\"clarinet\",\n\t\"piccolo\",\n\t\"flute\",\n\t\"recorder\",\n\t\"pan flute\",\n\t\"blown bottle\",\n\t\"shakuhachi\",\n\t\"whistle\",\n\t\"ocarina\",\n\t\"lead 1 (square)\",\n\t\"lead 2 (sawtooth)\",\n\t\"lead 3 (calliope)\",\n\t\"lead 4 (chiff)\",\n\t\"lead 5 (charang)\",\n\t\"lead 6 (voice)\",\n\t\"lead 7 (fifths)\",\n\t\"lead 8 (bass + lead)\",\n\t\"pad 1 (new age)\",\n\t\"pad 2 (warm)\",\n\t\"pad 3 (polysynth)\",\n\t\"pad 4 (choir)\",\n\t\"pad 5 (bowed)\",\n\t\"pad 6 (metallic)\",\n\t\"pad 7 (halo)\",\n\t\"pad 8 (sweep)\",\n\t\"fx 1 (rain)\",\n\t\"fx 2 (soundtrack)\",\n\t\"fx 3 (crystal)\",\n\t\"fx 4 (atmosphere)\",\n\t\"fx 5 (brightness)\",\n\t\"fx 6 (goblins)\",\n\t\"fx 7 (echoes)\",\n\t\"fx 8 (sci-fi)\",\n\t\"sitar\",\n\t\"banjo\",\n\t\"shamisen\",\n\t\"koto\",\n\t\"kalimba\",\n\t\"bag pipe\",\n\t\"fiddle\",\n\t\"shanai\",\n\t\"tinkle bell\",\n\t\"agogo\",\n\t\"steel drums\",\n\t\"woodblock\",\n\t\"taiko drum\",\n\t\"melodic tom\",\n\t\"synth drum\",\n\t\"reverse cymbal\",\n\t\"guitar fret noise\",\n\t\"breath noise\",\n\t\"seashore\",\n\t\"bird tweet\",\n\t\"telephone ring\",\n\t\"helicopter\",\n\t\"applause\",\n\t\"gunshot\",\n]\n\nexport const instrumentFamilyByID = [\n\t\"piano\",\n\t\"chromatic percussion\",\n\t\"organ\",\n\t\"guitar\",\n\t\"bass\",\n\t\"strings\",\n\t\"ensemble\",\n\t\"brass\",\n\t\"reed\",\n\t\"pipe\",\n\t\"synth lead\",\n\t\"synth pad\",\n\t\"synth effects\",\n\t\"ethnic\",\n\t\"percussive\",\n\t\"sound effects\",\n]\n\nexport const drumKitByPatchID = {\n\t 0: \"standard kit\",\n\t 8: \"room kit\",\n\t16: \"power kit\",\n\t24: \"electronic kit\",\n\t25: \"tr-808 kit\",\n\t32: \"jazz kit\",\n\t40: \"brush kit\",\n\t48: \"orchestra kit\",\n\t56: \"sound fx kit\",\n}\n","module.exports = function(module) {\r\n\tif (!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif (!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n","class GUI {\n\n    Init(jon, container){\n\n        if(!guify) {\n            console.log(\"Guify was not found! Add it to your page to enable a GUI for this program.\");\n            return;\n        }\n\n        this.panel = new guify({\n            title: \"Jon-Trombone\", \n            theme: \"dark\", \n            root: container,\n            width: 350,\n            barMode: \"above\",\n            align: \"right\",\n            opacity: \"0.95\"\n        });\n\n        this.panel.Register({ \n            type: \"checkbox\", label: \"Mute\", \n            object: jon.trombone, property: \"muted\", \n            onChange: (data) => {\n                jon.trombone.SetMute(data);\n            } \n        });\n\n        // Jon folder\n        this.panel.Register({ type: \"folder\", label: \"Jon\" });\n        this.panel.Register([\n            { type: \"checkbox\", label: \"Move Jaw\", object: jon, property: \"moveJaw\" },\n            { type: \"range\", label: \"Jaw Speed\", object: jon, property: \"jawFlapSpeed\", min: 0, max: 100 },\n            { type: \"range\", label: \"Jaw Range\", object: jon, property: \"jawOpenOffset\", min: 0, max: 1 },\n        ], { folder: \"Jon\" });\n\n        // Voice folder\n        this.panel.Register({ type: \"folder\", label: \"Voice\" });\n        this.panel.Register([\n            { type: \"checkbox\", label: \"Wobble\", object: jon.trombone, property: \"autoWobble\" },\n            { type: \"checkbox\", label: \"Pitch Variance\", object: jon.trombone.voices[0].glottis, property: \"addPitchVariance\" },\n            { type: \"checkbox\", label: \"Tenseness Variance\", object: jon.trombone.voices[0].glottis, property: \"addTensenessVariance\" },\n            { type: \"range\", label: \"Tenseness\", object: jon.trombone.voices[0].glottis, property: \"UITenseness\", min: 0, max: 1 },\n            { type: \"range\", label: \"Vibrato\", object: jon.trombone.voices[0].glottis, property: \"vibratoAmount\", min: 0, max: 0.5 },\n            { type: \"range\", label: \"Frequency\", object: jon.trombone.voices[0].glottis, property: \"UIFrequency\", min: 1, max: 1000, step: 1 },\n            { type: \"range\", label: \"Loudness\", object: jon.trombone.voices[0].glottis, property: \"loudness\", min: 0, max: 1 },\n        ], { folder: \"Voice\" });\n\n        // Tract folder\n        this.panel.Register({ type: \"folder\", label: \"Tract\" });\n        this.panel.Register([\n            { type: \"range\", label: \"Move Speed\", object: jon.trombone.voices[0].tract, property: \"movementSpeed\", min: 1, max: 30, step: 1 },\n            { type: \"range\", label: \"Velum Target\", object: jon.trombone.voices[0].tract, property: \"velumTarget\", min: 0.001, max: 2 },\n            { type: \"range\", label: \"Target\", object: jon.trombone.voices[0].tractUI, property: \"target\", min: 0.001, max: 1 },\n            { type: \"range\", label: \"Index\", object: jon.trombone.voices[0].tractUI, property: \"index\", min: 0, max: 43, step: 1 },\n            { type: \"range\", label: \"Radius\", object: jon.trombone.voices[0].tractUI, property: \"radius\", min: 0, max: 5, step: 1 },\n        ], { folder: \"Tract\" });\n\n        // MIDI folder\n        this.panel.Register({ type: \"folder\", label: \"MIDI\" });\n        this.panel.Register([\n            { type: \"file\", label: \"MIDI File\", fileReadFunc: \"readAsBinaryString\",\n                onChange: (data) => {\n                    jon.midiController.LoadSongDirect(data);\n                }\n            },\n            { type: \"title\", label: \"Controls\" },\n            { type: \"button\", label: \"Play\", action: () => jon.midiController.PlaySong() },\n            { type: \"button\", label: \"Stop\", action: () => jon.midiController.Stop() },\n            { type: \"button\", label: \"Restart\", action: () => jon.midiController.Restart() },\n            { type: \"title\", label: \"Options\" },\n            { type: \"range\", label: \"Track\", object: jon.midiController, property: \"currentTrack\", min: 1, max: 20, step: 1 },\n            { type: \"range\", label: \"Base Frequency\", object: jon.midiController, property: \"baseFreq\", min: 1, max: 2000, step: 1 },\n            { type: \"checkbox\", label: \"Extreme Vibrato\", object: jon, property: \"flapWhileSinging\" },\n            { type: \"checkbox\", label: \"Legato\", object: jon, property: \"legato\" },\n        ], { folder: \"MIDI\" });\n\n    }\n\n}\n\nexport let gui = new GUI();","import { Detector } from \"./utils/webgl-detect.js\";\nimport { JonTrombone } from \"./jon-trombone.js\";\n\n// Optionally bundle three.js as part of the project\n//import THREELib from \"three-js\";\n//var THREE = THREELib(); // return THREE JS\n\nlet Init = () => {\n    let container = document.getElementById(\"jon-trombone-container\");\n\n    if ( !Detector.HasWebGL() ) {\n        //exit(\"WebGL is not supported on this browser.\");\n        console.log(\"WebGL is not supported on this browser.\");\n        container.innerHTML = Detector.GetErrorHTML();\n        container.classList.add(\"no-webgl\");\n    }\n    else{\n        let jonTrombone = new JonTrombone(container);\n    }\n}\n\nif (document.readyState === 'complete') {\n    Init();\n} else {\n    window.onload = () => {\n        Init();\n    }\n}","import { ModelLoader } from \"./utils/model-loader.js\";\nimport { StartOverlay } from \"./utils/start-overlay.js\";\nimport { PinkTrombone } from \"./pink-trombone/pink-trombone.js\";\nimport { MidiController } from \"./midi/midi-controller.js\";\nimport { TTSController } from \"./tts/tts-controller.js\";\nimport { gui } from \"./gui.js\";\n\nclass JonTrombone {\n\n    constructor(container, finishedCallback) {\n        this.container = container;\n        this.container.style.position = \"relative\";\n        this.container.style.cursor = \"default\";\n\n        // Set up renderer and embed in container\n        this.renderer = new THREE.WebGLRenderer( { alpha: true } );\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(this.container.offsetWidth, this.container.offsetHeight);\n        this.renderer.setClearColor(0x000000, 0);\n        this.container.appendChild(this.renderer.domElement);\n\n        // Set up scene and view\n        let aspect = this.container.offsetWidth / this.container.offsetHeight;\n        this.camera = new THREE.PerspectiveCamera( 45, aspect, 0.1, 100 );\n        this.scene = new THREE.Scene();\n\n        // Export scene for three js inspector\n        //window.scene = this.scene;\n\n        // Set up clock for timing\n        this.clock = new THREE.Clock();\n\n        let startDelayMS = 1000;\n        this.trombone = new PinkTrombone(this);\n        setTimeout(()=> {\n            this.trombone.StartAudio();\n            //this.trombone.SetMute(true);\n            this.moveJaw = true;\n        }, startDelayMS);\n\n        // Mute button for trombone\n        // let button = document.createElement(\"button\");\n        // button.innerHTML = \"Mute\";\n        // button.style.cssText = \"position: absolute; display: block; top: 0; left: 0;\";\n        // this.container.appendChild(button);\n        // button.addEventListener (\"click\", () => {\n        //     this.trombone.ToggleMute();\n        //     button.innerHTML = this.trombone.muted ? \"Unmute\" : \"Mute\";\n        // });\n\n        this.jawFlapSpeed = 20.0;\n        this.jawOpenOffset = 0.19;\n        this.moveJaw = false;\n        this.legato = false;\n        this.flapWhileSinging = false;\n\n        this.midiController = new MidiController(this);\n\n        // let tts = new TTSController();\n        // console.log(tts.GetGraphemes(\"Testing one two three 1 2 3\"));\n\n        this.SetUpThree();\n        this.SetUpScene();\n\n        let startOverlay = new StartOverlay(this.container, this.trombone.audioSystem.audioContext);\n\n        // Start the update loop\n        this.OnUpdate();\n\n        gui.Init(this, this.container);\n    }\n\n    /**\n     * Set up non-scene config for Three.js\n     */\n    SetUpThree() {\n        if(THREE.OrbitControls !== undefined){\n            // Add orbit controls\n            this.controls = new THREE.OrbitControls( this.camera, this.renderer.domElement );\n            this.controls.target.set( 0, 0, 0 );\n            this.controls.update();\n        } else {\n            console.warn(\"No THREE.OrbitControls detected. Include to allow interaction with the model.\");\n        }\n    }\n\n    /**\n     * Populates and configures objects within the scene.\n     */\n    SetUpScene() {\n\n        // Set camera position\n        this.camera.position.set( 0, 0, 0.5 );\n\n        // Lights\n        let light1 = new THREE.HemisphereLight(0xffffff, 0x444444, 1.0);\n        light1.name = \"Hemisphere Light\";\n        light1.position.set(0, 1, 0);\n        this.scene.add(light1);\n\n        let light2 = new THREE.DirectionalLight(0xffffff, 1.0);\n        light2.name = \"Directional Light\";\n        light2.position.set(0, 1, 1);\n        light2.target.position.set(0, 0, 0);\n        this.scene.add(light2);\n\n        // Load the Jon model and place it in the scene\n        ModelLoader.LoadJSON(\"../resources/jon/three/jon.json\", (object) => {\n            this.jon = object;\n            this.scene.add( this.jon );\n            this.jon.rotation.y = (THREE.Math.degToRad(15));\n\n            this.jaw = this.jon.skeleton.bones.find((obj) => {\n                return obj.name == \"Bone.006\";\n            });\n            if(this.jaw){\n                this.jawShutZ = this.jaw.position.z;\n            }\n        });\n\n\n    }\n\n    /**\n     * Called every frame. Continues indefinitely after being called once.\n     */\n    OnUpdate() {\n        let deltaTime = this.clock.getDelta();\n        requestAnimationFrame( this.OnUpdate.bind(this) );\n\n        if(this.midiController.playing){\n\n            let notes = this.midiController.GetPitches();\n            if(notes != this.lastNotes){\n                // Do the note\n                if(notes !== undefined){ //&& notes.length != 0){ \n                    // Note on\n                    // Play frequency\n                    for (let i = 0; i < this.trombone.voices.length; i++){\n                        if (i >= notes.length) {\n                            if (!this.legato) this.trombone.voices[i].glottis.loudness = 0;\n                            if (this.moveJaw) this.trombone.voices[i].tractUI.SetLipsClosed(1);\n                            continue\n                        }\n\n                        this.trombone.voices[i].glottis.UIFrequency = this.midiController.MIDIToFrequency(notes[i].midi);\n                        this.trombone.voices[i].glottis.loudness = notes[i].velocity;\n\n                        if (this.moveJaw) this.trombone.voices[i].tractUI.SetLipsClosed(0);\n                    }\n                    // let note = notes[0];\n                    // if(notes.length > 1){\n                    //     //console.log (\"chord\");\n                    // }\n                    // let freq = this.midiController.MIDIToFrequency(note.midi);\n                    // //console.log(freq);\n                    // this.trombone.glottis.UIFrequency = freq;\n                    // this.trombone.glottis.loudness = note.velocity;\n                    // Open jaw\n                    if (this.moveJaw) this.jaw.position.z = this.jawShutZ + this.jawOpenOffset;\n                    for(let voice of this.trombone.voices) {\n                        if (this.moveJaw) voice.tractUI.SetLipsClosed(0);\n                    }\n\n                } \n\n                if(notes.length == 0) {\n                    if (this.moveJaw) this.jaw.position.z = this.jawShutZ;\n                    \n                }\n                // else { \n                //     // Note off\n                //     if (!this.legato) this.trombone.glottis.loudness = 0;\n                //     // Close jaw\n                //     this.jaw.position.z = this.jawShutZ;\n                //     // this.trombone.tractUI.SetLipsClosed(1);\n\n                // }\n\n                this.lastNotes = notes;\n            }\n\n        }\n\n        if(this.jaw && this.moveJaw && (!this.midiController.playing || this.flapWhileSinging)){\n            let time = this.clock.getElapsedTime();// % 60;\n\n            // Move the jaw\n            let percent = (Math.sin(time * this.jawFlapSpeed) + 1.0) / 2.0;\n            this.jaw.position.z = this.jawShutZ + (percent * this.jawOpenOffset);\n\n            // Make the audio match the jaw position\n            for(let voice of this.trombone.voices) {\n                voice.tractUI.SetLipsClosed(1.0 - percent);\n            }\n\n        }\n\n        // Render\n        this.renderer.render(this.scene, this.camera);\n\n    }\n\n}\n\nexport { JonTrombone };","let MidiConvert = require('midiconvert');\n\n/**\n * Simple class for MIDI playback.\n * The paradigm here's a bit weird; it's up to an external\n * source to actually produce audio. This class just manages\n * a timer, which GetPitch() reads to produce the \"current\"\n * note information. \n * \n * As an example of usage, jon-trombone calls PlaySong() to\n * begin, and then every frame uses GetPitch() to figure out\n * what the current frequency to produce is.\n */\nclass MidiController {\n\n    constructor(controller) {\n        this.controller = controller;\n\n        this.midi = null;\n\n        this.playing = false;\n        this.currentTrack = 5;\n\n        this.baseFreq = 440; //110 is A4\n\n        this.clock = new THREE.Clock(false);\n    }\n\n    /**\n     * Loads and parses a MIDI file.\n     */\n    LoadSong(path, callback){\n        this.Stop();\n        this.midi = null;\n        MidiConvert.load(path, (midi) => {\n            console.log(\"MIDI loaded.\");\n            this.midi = midi;\n            console.log(this.midi);\n            if(callback) callback(midi);\n        });\n    }\n\n    LoadSongDirect(file){\n        this.Stop();\n        this.midi = MidiConvert.parse(file);\n        console.log(\"MIDI loaded.\");\n        console.log(this.midi);\n    }\n\n    /**\n     * Gets the pitch for the specified track at the current time in the song.\n     */\n    GetPitch(trackIndex = this.currentTrack){\n        let time = this.GetSongProgress();\n\n        // Constrain track specified to valid range\n        trackIndex = Math.min(trackIndex, this.midi.tracks.length - 1);\n        trackIndex = Math.max(trackIndex, 0);\n\n        return this.midi.tracks[trackIndex].notes.find((item) => {\n            return item.noteOn <= time && time <= item.noteOff;\n        });\n    }\n\n    GetPitches(trackIndex = this.currentTrack){\n        let time = this.GetSongProgress();\n\n        // Constrain track specified to valid range\n        trackIndex = Math.min(trackIndex, this.midi.tracks.length - 1);\n        trackIndex = Math.max(trackIndex, 0);\n\n        return this.midi.tracks[trackIndex].notes.filter(item => \n            item.noteOn <= time && time <= item.noteOff);\n    }\n\n    PlaySong(track = 5){\n        if(this.playing){\n            return;\n        }\n\n        // If no song is specified, load a song\n        if(!this.midi){\n            console.log(\"No MIDI is loaded. Loading an example...\");\n            this.LoadSong('../resources/midi/un-owen-was-her.mid', () => {\n                this.PlaySong();\n            });\n            return;\n        }\n\n        // Turn off some stuff so the singing kind of sounds okay\n        this.EnterSingMode();\n\n        this.currentTrack = track;\n        this.clock.start();\n        this.playing = true;\n\n        console.log(\"Playback started.\");\n\n    }\n\n    GetSongProgress(){\n        return this.clock.getElapsedTime();\n    }\n\n    /**\n     * Converts from a MIDI note code to its corresponding frequency.\n     * @param {*} midiCode \n     */\n    MIDIToFrequency(midiCode){\n        return this.baseFreq * Math.pow(2, (midiCode - 69) / 12);\n    }\n\n    /**\n     * Restarts the playback.\n     */\n    Restart(){\n        console.log(\"Playback moved to beginning.\");\n        this.clock = new THREE.Clock();\n    }\n\n    /**\n     * Stops playback.\n     */\n    Stop() {\n        if(!this.playing){\n            return;\n        }\n        console.log(\"Playback stopped.\");\n        this.clock.stop();\n        this.playing = false;\n        this.ExitSingMode();\n    }\n\n    /**\n     * Sets up the trombone for singing.\n     */\n    EnterSingMode(){\n        if(this.backup_settings){\n            return;\n        }\n\n        this.backup_settings = {};\n\n        this.backup_settings[\"autoWobble\"] = this.controller.trombone.autoWobble;\n        this.controller.trombone.autoWobble = false;\n\n        for(let voice of this.controller.trombone.voices) {\n            let voiceBackup = {}\n\n            voiceBackup[\"addPitchVariance\"] = voice.glottis.addPitchVariance;\n            voice.glottis.addPitchVariance = false;\n\n            voiceBackup[\"addTensenessVariance\"] = voice.glottis.addTensenessVariance;\n            voice.glottis.addTensenessVariance = false;\n\n            voiceBackup[\"vibratoFrequency\"] = voice.glottis.vibratoFrequency;\n            voice.glottis.vibratoFrequency = 0;\n\n            voiceBackup[\"frequency\"] = voice.glottis.UIFrequency;\n\n            voiceBackup[\"loudness\"] = voice.glottis.loudness;\n            voice.glottis.loudness = 0;\n\n            this.backup_settings[`${voice.id}`] = voiceBackup\n        }\n    }\n\n    /**\n     * Restores the trombone to the state it was in before singing.\n     */\n    ExitSingMode(){\n        if(!this.backup_settings) {\n            return;\n        }\n\n        this.controller.trombone.autoWobble = this.backup_settings[\"autoWobble\"];\n\n        for(let voice of this.controller.trombone.voices) {\n            let backup = this.backup_settings[`${voice.id}`]\n            voice.glottis.addPitchVariance = backup[\"addPitchVariance\"];\n            voice.glottis.addTensenessVariance = backup[\"addTensenessVariance\"];\n            voice.glottis.vibratoFrequency = backup[\"vibratoFrequency\"];\n            voice.glottis.UIFrequency = backup[\"frequency\"];\n            voice.glottis.loudness = backup[\"loudness\"];\n        }\n\n        this.backup_settings = null;\n    }\n\n}\n\nexport { MidiController };","\n\nclass AudioSystem {  \n\n    constructor(trombone) {\n        this.trombone = trombone;\n\n        this.blockLength = 512;\n        this.blockTime = 1;\n        this.soundOn = false;\n\n    }\n\n    init() {\n        window.AudioContext = window.AudioContext||window.webkitAudioContext;\n        this.audioContext = new window.AudioContext();\n        this.sampleRate = this.audioContext.sampleRate;\n        \n        this.blockTime = this.blockLength/this.sampleRate;\n\n        this.processors = [];\n    }\n    \n    startSound() {\n        for (let i = 0; i < this.trombone.voices.length; i++) {\n            //scriptProcessor may need a dummy input channel on iOS\n            let scriptProcessor = this.audioContext.createScriptProcessor(this.blockLength, 2, 1);\n            scriptProcessor.connect(this.audioContext.destination);\n            scriptProcessor.onaudioprocess = (e) => {this.doScriptProcessor(e, i)};\n        \n            var whiteNoise = this.createWhiteNoiseNode(2 * this.sampleRate); // 2 seconds of noise\n            \n            var aspirateFilter = this.audioContext.createBiquadFilter();\n            aspirateFilter.type = \"bandpass\";\n            aspirateFilter.frequency.value = 500;\n            aspirateFilter.Q.value = 0.5;\n            whiteNoise.connect(aspirateFilter);  // Use white noise as input for filter\n            aspirateFilter.connect(scriptProcessor);  // Use this as input 0 for script processor\n            \n            var fricativeFilter = this.audioContext.createBiquadFilter();\n            fricativeFilter.type = \"bandpass\";\n            fricativeFilter.frequency.value = 1000;\n            fricativeFilter.Q.value = 0.5;\n            whiteNoise.connect(fricativeFilter);  // Use white noise as input\n            fricativeFilter.connect(scriptProcessor);  // Use this as input 1 for script processor\n            \n            whiteNoise.start(0);\n            this.processors.push(scriptProcessor);\n        }\n    }\n    \n    createWhiteNoiseNode(frameCount) {\n        var myArrayBuffer = this.audioContext.createBuffer(1, frameCount, this.sampleRate);\n\n        var nowBuffering = myArrayBuffer.getChannelData(0);\n        for (var i = 0; i < frameCount; i++) \n        {\n            nowBuffering[i] = Math.random();// gaussian();\n        }\n\n        var source = this.audioContext.createBufferSource();\n        source.buffer = myArrayBuffer;\n        source.loop = true;\n\n        return source;\n    }\n    \n    doScriptProcessor(event, index) {\n        var inputArray1 = event.inputBuffer.getChannelData(0);  // Glottis input\n        var inputArray2 = event.inputBuffer.getChannelData(1);  // Tract input\n        var outArray = event.outputBuffer.getChannelData(0);  // Output (mono)\n\n        let voice = this.trombone.voices[index];\n\n        let N = outArray.length;\n        for (var j = 0; j < N; j++)\n        {\n            var lambda1 = j/N; // Goes from 0 to 1\n            var lambda2 = (j+0.5)/N;\n            var glottalOutput = voice.glottis.runStep(lambda1, inputArray1[j]); \n            \n            var vocalOutput = 0;\n            //Tract runs at twice the sample rate \n            voice.tract.runStep(glottalOutput, inputArray2[j], lambda1);\n            vocalOutput += voice.tract.lipOutput + voice.tract.noseOutput;\n            voice.tract.runStep(glottalOutput, inputArray2[j], lambda2);\n            vocalOutput += voice.tract.lipOutput + voice.tract.noseOutput;\n            outArray[j] = vocalOutput * 0.125;\n\n            // Solves background hissing problem but introduces popping.\n            //if(voice.glottis.loudness == 0) outArray[j] = 0;\n        }\n\n        voice.glottis.finishBlock();\n        voice.tract.finishBlock();\n    }\n    \n    mute() {\n        for(let processor of this.processors) {\n            processor.disconnect();\n        }\n    }\n    \n    unmute() {\n        for(let processor of this.processors) {\n            processor.connect(this.audioContext.destination);\n        }\n    }\n    \n}\n\nexports.AudioSystem = AudioSystem;","import noise from \"../noise.js\";\n\nclass Glottis {\n\n    constructor(trombone) {\n        this.trombone = trombone;\n\n        this.timeInWaveform = 0;\n        this.oldFrequency = 140;\n        this.newFrequency = 140;\n        this.UIFrequency = 140;\n        this.smoothFrequency = 140;\n        this.oldTenseness = 0.6;\n        this.newTenseness = 0.6;\n        this.UITenseness = 0.6;\n        this.totalTime = 0;\n        this.vibratoAmount = 0.005;\n        this.vibratoFrequency = 6;\n        this.intensity = 0;\n        this.loudness = 1;\n        this.isTouched = false;\n        this.touch = 0;\n        this.x = 240;\n        this.y = 530;\n\n        this.keyboardTop = 500;\n        this.keyboardLeft = 0;\n        this.keyboardWidth = 600;\n        this.keyboardHeight = 100;\n        this.semitones = 20;\n        this.marks = [0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0];\n        this.baseNote = 87.3071; //F\n\n        this.output;\n\n        /// Allow pitch to wobble over time\n        this.addPitchVariance = true;\n        /// Allow tenseness to wobble over time\n        this.addTensenessVariance = true;\n\n    }\n    \n    init() {\n        this.setupWaveform(0);\n    }\n    \n    handleTouches() {\n        if (this.touch != 0 && !this.touch.alive) this.touch = 0;\n        \n        if (this.touch == 0)\n        {        \n            for (var j=0; j<UI.touchesWithMouse.length; j++)  \n            {\n                var touch = UI.touchesWithMouse[j];\n                if (!touch.alive) continue;\n                if (touch.y<this.keyboardTop) continue;\n                this.touch = touch;\n            }    \n        }\n        \n        if (this.touch != 0)\n        {\n            var local_y = this.touch.y -  this.keyboardTop-10;\n            var local_x = this.touch.x - this.keyboardLeft;\n            local_y = Math.clamp(local_y, 0, this.keyboardHeight-26);\n            var semitone = this.semitones * local_x / this.keyboardWidth + 0.5;\n            Glottis.UIFrequency = this.baseNote * Math.pow(2, semitone/12);\n            if (Glottis.intensity == 0) Glottis.smoothFrequency = Glottis.UIFrequency;\n            //Glottis.UIRd = 3*local_y / (this.keyboardHeight-20);\n            var t = Math.clamp(1-local_y / (this.keyboardHeight-28), 0, 1);\n            Glottis.UITenseness = 1-Math.cos(t*Math.PI*0.5);\n            Glottis.loudness = Math.pow(Glottis.UITenseness, 0.25);\n            this.x = this.touch.x;\n            this.y = local_y + this.keyboardTop+10;\n        }\n        Glottis.isTouched = (this.touch != 0);\n    }\n        \n    runStep(lambda, noiseSource) {\n        var timeStep = 1.0 / this.trombone.audioSystem.sampleRate;\n        this.timeInWaveform += timeStep;\n        this.totalTime += timeStep;\n        if (this.timeInWaveform > this.waveformLength) \n        {\n            this.timeInWaveform -= this.waveformLength;\n            this.setupWaveform(lambda);\n        }\n        var out = this.normalizedLFWaveform(this.timeInWaveform/this.waveformLength);\n        var aspiration = this.intensity*(1.0-Math.sqrt(this.UITenseness))*this.getNoiseModulator()*noiseSource;\n        aspiration *= 0.2 + 0.02 * noise.simplex1(this.totalTime * 1.99);\n        out += aspiration;\n        return out;\n    }\n    \n    getNoiseModulator() {\n        var voiced = 0.1+0.2*Math.max(0,Math.sin(Math.PI*2*this.timeInWaveform/this.waveformLength));\n        //return 0.3;\n        return this.UITenseness* this.intensity * voiced + (1-this.UITenseness* this.intensity ) * 0.3;\n    }\n    \n    finishBlock() {\n        var vibrato = 0;\n        if (this.addPitchVariance) {\n            // Add small imperfections to the vocal output\n            vibrato += this.vibratoAmount * Math.sin(2*Math.PI * this.totalTime *this.vibratoFrequency);          \n            vibrato += 0.02 * noise.simplex1(this.totalTime * 4.07);\n            vibrato += 0.04 * noise.simplex1(this.totalTime * 2.15);\n        }\n        \n        if (this.trombone.autoWobble)\n        {\n            vibrato += 0.2 * noise.simplex1(this.totalTime * 0.98);\n            vibrato += 0.4 * noise.simplex1(this.totalTime * 0.5);\n        }\n\n        if (this.UIFrequency>this.smoothFrequency) \n            this.smoothFrequency = Math.min(this.smoothFrequency * 1.1, this.UIFrequency);\n        if (this.UIFrequency<this.smoothFrequency) \n            this.smoothFrequency = Math.max(this.smoothFrequency / 1.1, this.UIFrequency);\n        this.oldFrequency = this.newFrequency;\n        this.newFrequency = this.smoothFrequency * (1+vibrato);\n        this.oldTenseness = this.newTenseness;\n\n        if (this.addTensenessVariance)\n            this.newTenseness = this.UITenseness + 0.1*noise.simplex1(this.totalTime*0.46)+0.05*noise.simplex1(this.totalTime*0.36);\n        else\n            this.newTenseness = this.UITenseness;\n\n        if (!this.isTouched && this.trombone.alwaysVoice) this.newTenseness += (3-this.UITenseness)*(1-this.intensity);\n        \n        if (this.isTouched || this.trombone.alwaysVoice)\n            this.intensity += 0.13;\n        this.intensity = Math.clamp(this.intensity, 0, 1);\n    }\n    \n    /// Queues up a single wave?\n    setupWaveform(lambda) {\n        this.frequency = this.oldFrequency*(1-lambda) + this.newFrequency*lambda;\n        var tenseness = this.oldTenseness*(1-lambda) + this.newTenseness*lambda;\n        this.Rd = 3*(1-tenseness);\n        this.waveformLength = 1.0/this.frequency;\n        \n        var Rd = this.Rd;\n        if (Rd<0.5) Rd = 0.5;\n        if (Rd>2.7) Rd = 2.7;\n        // normalized to time = 1, Ee = 1\n        var Ra = -0.01 + 0.048*Rd;\n        var Rk = 0.224 + 0.118*Rd;\n        var Rg = (Rk/4)*(0.5+1.2*Rk)/(0.11*Rd-Ra*(0.5+1.2*Rk));\n        \n        var Ta = Ra;\n        var Tp = 1 / (2*Rg);\n        var Te = Tp + Tp*Rk; //\n        \n        var epsilon = 1/Ta;\n        var shift = Math.exp(-epsilon * (1-Te));\n        var Delta = 1 - shift; //divide by this to scale RHS\n           \n        var RHSIntegral = (1/epsilon)*(shift - 1) + (1-Te)*shift;\n        RHSIntegral = RHSIntegral/Delta;\n        \n        var totalLowerIntegral = - (Te-Tp)/2 + RHSIntegral;\n        var totalUpperIntegral = -totalLowerIntegral;\n        \n        var omega = Math.PI/Tp;\n        var s = Math.sin(omega*Te);\n        var y = -Math.PI*s*totalUpperIntegral / (Tp*2);\n        var z = Math.log(y);\n        var alpha = z/(Tp/2 - Te);\n        var E0 = -1 / (s*Math.exp(alpha*Te));\n        this.alpha = alpha;\n        this.E0 = E0;\n        this.epsilon = epsilon;\n        this.shift = shift;\n        this.Delta = Delta;\n        this.Te=Te;\n        this.omega = omega;\n    }\n    \n \n    normalizedLFWaveform(t) {     \n        if (t>this.Te) this.output = (-Math.exp(-this.epsilon * (t-this.Te)) + this.shift)/this.Delta;\n        else this.output = this.E0 * Math.exp(this.alpha*t) * Math.sin(this.omega * t);\n     \n        return this.output * this.intensity * this.loudness;\n    }\n}\n\nexport { Glottis };","class TractUI\n{\n\n    constructor(trombone, tract) {\n        this.trombone = trombone;\n        this.tract = tract;\n        \n        this.originX = 340; \n        this.originY = 449; \n        this.radius = 298; \n        this.scale = 60;\n        this.tongueIndex = 12.9;\n        this.tongueDiameter = 2.43;\n        this.innerTongueControlRadius = 2.05;\n        this.outerTongueControlRadius = 3.5;\n        this.tongueTouch = 0;\n        this.angleScale = 0.64;\n        this.angleOffset = -0.24;\n        this.noseOffset = 0.8;\n        this.gridOffset = 1.7;\n\n        /// Final openness of the mouth (closer to 0 is more closed)\n        this.target = 0.1;\n        /// Index in the throat array to move to target\n        this.index = 42;\n        /// Number of throat segments to close around the index\n        this.radius = 0;\n    }\n    \n    init() {\n        let Tract = this.tract;\n\n        this.setRestDiameter();\n        for (var i=0; i<Tract.n; i++) \n        {\n            Tract.diameter[i] = Tract.targetDiameter[i] = Tract.restDiameter[i];\n        }\n\n        this.tongueLowerIndexBound = Tract.bladeStart+2;\n        this.tongueUpperIndexBound = Tract.tipStart-3;\n        this.tongueIndexCentre = 0.5*(this.tongueLowerIndexBound+this.tongueUpperIndexBound);\n    }\n        \n    getIndex(x,y) {\n        let Tract = this.tract;\n\n        var xx = x-this.originX; var yy = y-this.originY;\n        var angle = Math.atan2(yy, xx);\n        while (angle> 0) angle -= 2*Math.PI;\n        return (Math.PI + angle - this.angleOffset)*(Tract.lipStart-1) / (this.angleScale*Math.PI);\n    }\n\n    getDiameter(x,y) {\n        var xx = x-this.originX; var yy = y-this.originY;\n        return (this.radius-Math.sqrt(xx*xx + yy*yy))/this.scale;\n    }\n    \n    setRestDiameter() {\n        let Tract = this.tract;\n\n        for (var i=Tract.bladeStart; i<Tract.lipStart; i++)\n        {\n            var t = 1.1 * Math.PI*(this.tongueIndex - i)/(Tract.tipStart - Tract.bladeStart);\n            var fixedTongueDiameter = 2+(this.tongueDiameter-2)/1.5;\n            var curve = (1.5-fixedTongueDiameter+this.gridOffset)*Math.cos(t);\n            if (i == Tract.bladeStart-2 || i == Tract.lipStart-1) curve *= 0.8;\n            if (i == Tract.bladeStart || i == Tract.lipStart-2) curve *= 0.94;               \n            Tract.restDiameter[i] = 1.5 - curve;\n        }\n    }\n\n    /**\n     * Sets the lips of the modeled tract to be closed by the specified amount.\n     * @param {number} progress Percentage closed (number between 0 and 1)\n     */\n    SetLipsClosed(progress) {\n\n        let Tract = this.tract;\n        \n        this.setRestDiameter();\n        for (var i=0; i<Tract.n; i++) Tract.targetDiameter[i] = Tract.restDiameter[i];    \n\n        // Disable this behavior if the mouth is closed a certain amount\n        //if (progress > 0.8 || progress < 0.1) return;\n        \n        for(let i= this.index - this.radius; i <= this.index + this.radius; i++){\n            if (i > Tract.targetDiameter.length || i < 0) continue;\n            let interp = Math.lerp(Tract.restDiameter[i], this.target, progress);\n            Tract.targetDiameter[i] = interp;\n        }\n    }\n\n\n}\n\nexport { TractUI };","class Tract {\n\n    constructor(trombone, glottis) {\n        this.trombone = trombone;\n        this.glottis = glottis;\n        \n        this.n = 44;\n        this.bladeStart = 10;\n        this.tipStart = 32;\n        this.lipStart = 39;\n        this.R = []; //component going right\n        this.L = []; //component going left\n        this.reflection = [];\n        this.junctionOutputR = [];\n        this.junctionOutputL = [];\n        this.maxAmplitude = [];\n        this.diameter = [];\n        this.restDiameter = [];\n        this.targetDiameter = [];\n        this.newDiameter = [];\n        this.A = [];\n        this.glottalReflection = 0.75;\n        this.lipReflection = -0.85;\n        this.lastObstruction = -1;\n        this.fade = 1.0; //0.9999,\n        this.movementSpeed = 15; //cm per second\n        this.transients = [];\n        this.lipOutput = 0;\n        this.noseOutput = 0;\n        this.velumTarget = 0.01;\n    }\n\n    init() {\n        this.bladeStart = Math.floor(this.bladeStart*this.n/44);\n        this.tipStart = Math.floor(this.tipStart*this.n/44);\n        this.lipStart = Math.floor(this.lipStart*this.n/44);        \n        this.diameter = new Float64Array(this.n);\n        this.restDiameter = new Float64Array(this.n);\n        this.targetDiameter = new Float64Array(this.n);\n        this.newDiameter = new Float64Array(this.n);\n        for (var i=0; i<this.n; i++)\n        {\n            var diameter = 0;\n            if (i<7*this.n/44-0.5) diameter = 0.6;\n            else if (i<12*this.n/44) diameter = 1.1;\n            else diameter = 1.5;\n            this.diameter[i] = this.restDiameter[i] = this.targetDiameter[i] = this.newDiameter[i] = diameter;\n        }\n        this.R = new Float64Array(this.n);\n        this.L = new Float64Array(this.n);\n        this.reflection = new Float64Array(this.n+1);\n        this.newReflection = new Float64Array(this.n+1);\n        this.junctionOutputR = new Float64Array(this.n+1);\n        this.junctionOutputL = new Float64Array(this.n+1);\n        this.A =new Float64Array(this.n);\n        this.maxAmplitude = new Float64Array(this.n);\n        \n        this.noseLength = Math.floor(28*this.n/44)\n        this.noseStart = this.n-this.noseLength + 1;\n        this.noseR = new Float64Array(this.noseLength);\n        this.noseL = new Float64Array(this.noseLength);\n        this.noseJunctionOutputR = new Float64Array(this.noseLength+1);\n        this.noseJunctionOutputL = new Float64Array(this.noseLength+1);        \n        this.noseReflection = new Float64Array(this.noseLength+1);\n        this.noseDiameter = new Float64Array(this.noseLength);\n        this.noseA = new Float64Array(this.noseLength);\n        this.noseMaxAmplitude = new Float64Array(this.noseLength);\n        for (var i=0; i<this.noseLength; i++)\n        {\n            var diameter;\n            var d = 2*(i/this.noseLength);\n            if (d<1) diameter = 0.4+1.6*d;\n            else diameter = 0.5+1.5*(2-d);\n            diameter = Math.min(diameter, 1.9);\n            this.noseDiameter[i] = diameter;\n        }       \n        this.newReflectionLeft = this.newReflectionRight = this.newReflectionNose = 0;\n        this.calculateReflections();        \n        this.calculateNoseReflections();\n        this.noseDiameter[0] = this.velumTarget;\n    }\n    \n    reshapeTract(deltaTime) {\n        var amount = deltaTime * this.movementSpeed; ;    \n        var newLastObstruction = -1;\n        for (var i=0; i<this.n; i++)\n        {\n            var diameter = this.diameter[i];\n            var targetDiameter = this.targetDiameter[i];\n            if (diameter <= 0) newLastObstruction = i;\n            var slowReturn; \n            if (i<this.noseStart) slowReturn = 0.6;\n            else if (i >= this.tipStart) slowReturn = 1.0; \n            else slowReturn = 0.6+0.4*(i-this.noseStart)/(this.tipStart-this.noseStart);\n            this.diameter[i] = Math.moveTowards(diameter, targetDiameter, slowReturn*amount, 2*amount);\n        }\n        if (this.lastObstruction>-1 && newLastObstruction == -1 && this.noseA[0]<0.05)\n        {\n            this.addTransient(this.lastObstruction);\n        }\n        this.lastObstruction = newLastObstruction;\n        \n        amount = deltaTime * this.movementSpeed; \n        this.noseDiameter[0] = Math.moveTowards(this.noseDiameter[0], this.velumTarget, \n                amount*0.25, amount*0.1);\n        this.noseA[0] = this.noseDiameter[0]*this.noseDiameter[0];        \n    }\n    \n    calculateReflections() {\n        for (var i=0; i<this.n; i++) \n        {\n            this.A[i] = this.diameter[i]*this.diameter[i]; //ignoring PI etc.\n        }\n        for (var i=1; i<this.n; i++)\n        {\n            this.reflection[i] = this.newReflection[i];\n            if (this.A[i] == 0) this.newReflection[i] = 0.999; //to prevent some bad behaviour if 0\n            else this.newReflection[i] = (this.A[i-1]-this.A[i]) / (this.A[i-1]+this.A[i]); \n        }\n        \n        //now at junction with nose\n\n        this.reflectionLeft = this.newReflectionLeft;\n        this.reflectionRight = this.newReflectionRight;\n        this.reflectionNose = this.newReflectionNose;\n        var sum = this.A[this.noseStart]+this.A[this.noseStart+1]+this.noseA[0];\n        this.newReflectionLeft = (2*this.A[this.noseStart]-sum)/sum;\n        this.newReflectionRight = (2*this.A[this.noseStart+1]-sum)/sum;   \n        this.newReflectionNose = (2*this.noseA[0]-sum)/sum;      \n    }\n\n    calculateNoseReflections() {\n        for (var i=0; i<this.noseLength; i++) \n        {\n            this.noseA[i] = this.noseDiameter[i]*this.noseDiameter[i]; \n        }\n        for (var i=1; i<this.noseLength; i++)\n        {\n            this.noseReflection[i] = (this.noseA[i-1]-this.noseA[i]) / (this.noseA[i-1]+this.noseA[i]); \n        }\n    }\n    \n    runStep(glottalOutput, turbulenceNoise, lambda) {\n        var updateAmplitudes = (Math.random()<0.1);\n    \n        //mouth\n        this.processTransients();\n        this.addTurbulenceNoise(turbulenceNoise);\n        \n        //this.glottalReflection = -0.8 + 1.6 * Glottis.newTenseness;\n        this.junctionOutputR[0] = this.L[0] * this.glottalReflection + glottalOutput;\n        this.junctionOutputL[this.n] = this.R[this.n-1] * this.lipReflection; \n        \n        for (var i=1; i<this.n; i++)\n        {\n            var r = this.reflection[i] * (1-lambda) + this.newReflection[i]*lambda;\n            var w = r * (this.R[i-1] + this.L[i]);\n            this.junctionOutputR[i] = this.R[i-1] - w;\n            this.junctionOutputL[i] = this.L[i] + w;\n        }    \n        \n        //now at junction with nose\n        var i = this.noseStart;\n        var r = this.newReflectionLeft * (1-lambda) + this.reflectionLeft*lambda;\n        this.junctionOutputL[i] = r*this.R[i-1]+(1+r)*(this.noseL[0]+this.L[i]);\n        r = this.newReflectionRight * (1-lambda) + this.reflectionRight*lambda;\n        this.junctionOutputR[i] = r*this.L[i]+(1+r)*(this.R[i-1]+this.noseL[0]);     \n        r = this.newReflectionNose * (1-lambda) + this.reflectionNose*lambda;\n        this.noseJunctionOutputR[0] = r*this.noseL[0]+(1+r)*(this.L[i]+this.R[i-1]);\n         \n        for (var i=0; i<this.n; i++)\n        {          \n            this.R[i] = this.junctionOutputR[i]*0.999;\n            this.L[i] = this.junctionOutputL[i+1]*0.999; \n            \n            //this.R[i] = Math.clamp(this.junctionOutputR[i] * this.fade, -1, 1);\n            //this.L[i] = Math.clamp(this.junctionOutputL[i+1] * this.fade, -1, 1);    \n            \n            if (updateAmplitudes)\n            {   \n                var amplitude = Math.abs(this.R[i]+this.L[i]);\n                if (amplitude > this.maxAmplitude[i]) this.maxAmplitude[i] = amplitude;\n                else this.maxAmplitude[i] *= 0.999;\n            }\n        }\n\n        this.lipOutput = this.R[this.n-1];\n        \n        //nose     \n        this.noseJunctionOutputL[this.noseLength] = this.noseR[this.noseLength-1] * this.lipReflection; \n        \n        for (var i=1; i<this.noseLength; i++)\n        {\n            var w = this.noseReflection[i] * (this.noseR[i-1] + this.noseL[i]);\n            this.noseJunctionOutputR[i] = this.noseR[i-1] - w;\n            this.noseJunctionOutputL[i] = this.noseL[i] + w;\n        }\n        \n        for (var i=0; i<this.noseLength; i++)\n        {\n            this.noseR[i] = this.noseJunctionOutputR[i] * this.fade;\n            this.noseL[i] = this.noseJunctionOutputL[i+1] * this.fade;   \n            \n            //this.noseR[i] = Math.clamp(this.noseJunctionOutputR[i] * this.fade, -1, 1);\n            //this.noseL[i] = Math.clamp(this.noseJunctionOutputL[i+1] * this.fade, -1, 1);    \n            \n            if (updateAmplitudes)\n            {\n                var amplitude = Math.abs(this.noseR[i]+this.noseL[i]);\n                if (amplitude > this.noseMaxAmplitude[i]) this.noseMaxAmplitude[i] = amplitude;\n                else this.noseMaxAmplitude[i] *= 0.999;\n            }\n        }\n\n        this.noseOutput = this.noseR[this.noseLength-1];\n       \n    }\n    \n    finishBlock() {         \n        this.reshapeTract(this.trombone.audioSystem.blockTime);\n        this.calculateReflections();\n    }\n    \n    addTransient(position) {\n        var trans = {}\n        trans.position = position;\n        trans.timeAlive = 0;\n        trans.lifeTime = 0.2;\n        trans.strength = 0.3;\n        trans.exponent = 200;\n        this.transients.push(trans);\n    }\n    \n    processTransients() {\n        for (var i = 0; i < this.transients.length; i++)  \n        {\n            var trans = this.transients[i];\n            var amplitude = trans.strength * Math.pow(2, -trans.exponent * trans.timeAlive);\n            this.R[trans.position] += amplitude/2;\n            this.L[trans.position] += amplitude/2;\n            trans.timeAlive += 1.0/(this.trombone.audioSystem.sampleRate*2);\n        }\n        for (var i=this.transients.length-1; i>=0; i--)\n        {\n            var trans = this.transients[i];\n            if (trans.timeAlive > trans.lifeTime)\n            {\n                this.transients.splice(i,1);\n            }\n        }\n    }\n    \n    addTurbulenceNoise(turbulenceNoise) {\n        // for (var j=0; j<UI.touchesWithMouse.length; j++)\n        // {\n        //     var touch = UI.touchesWithMouse[j];\n        //     if (touch.index<2 || touch.index>Tract.n) continue;\n        //     if (touch.diameter<=0) continue;            \n        //     var intensity = touch.fricative_intensity;\n        //     if (intensity == 0) continue;\n        //     this.addTurbulenceNoiseAtIndex(0.66*turbulenceNoise*intensity, touch.index, touch.diameter);\n        // }\n    }\n    \n    addTurbulenceNoiseAtIndex(turbulenceNoise, index, diameter) {   \n        var i = Math.floor(index);\n        var delta = index - i;\n        turbulenceNoise *= this.glottis.getNoiseModulator();\n        var thinness0 = Math.clamp(8*(0.7-diameter),0,1);\n        var openness = Math.clamp(30*(diameter-0.3), 0, 1);\n        var noise0 = turbulenceNoise*(1-delta)*thinness0*openness;\n        var noise1 = turbulenceNoise*delta*thinness0*openness;\n        this.R[i+1] += noise0/2;\n        this.L[i+1] += noise0/2;\n        this.R[i+2] += noise1/2;\n        this.L[i+2] += noise1/2;\n    }\n};\n\nexport { Tract };","Math.clamp = function(number, min, max) {\n    if (number<min) return min;\n    else if (number>max) return max;\n    else return number;\n}\n\nMath.moveTowards = function(current, target, amount) {\n    if (current<target) return Math.min(current+amount, target);\n    else return Math.max(current-amount, target);\n}\n\nMath.moveTowards = function(current, target, amountUp, amountDown) {\n    if (current<target) return Math.min(current+amountUp, target);\n    else return Math.max(current-amountDown, target);\n}\n\nMath.gaussian = function() {\n    var s = 0;\n    for (var c=0; c<16; c++) s+=Math.random();\n    return (s-8)/4;\n}\n\nMath.lerp = function(a, b, t) {\n    return a + (b - a) * t;\n}","/*\n * A speed-improved perlin and simplex noise algorithms for 2D.\n *\n * Based on example code by Stefan Gustavson (stegu@itn.liu.se).\n * Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\n * Better rank ordering method by Stefan Gustavson in 2012.\n * Converted to Javascript by Joseph Gentle.\n *\n * Version 2012-03-09\n *\n * This code was placed in the public domain by its original author,\n * Stefan Gustavson. You may use it as you see fit, but\n * attribution is appreciated.\n *\n */\n\nclass Grad {\n    constructor(x, y, z){\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    dot2(x, y){\n        return this.x*x + this.y*y;\n    }\n\n    dot3(x, y, z) {\n        return this.x*x + this.y*y + this.z*z;\n    };\n}\n\nclass Noise {\n    constructor() {\n        this.grad3 = [new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),\n                      new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),\n                      new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)];\n        this.p = [151,160,137,91,90,15,\n            131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,\n            190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,\n            88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,\n            77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,\n            102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,\n            135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,\n            5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,\n            223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,\n            129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,\n            251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,\n            49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,\n            138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];\n\n        // To remove the need for index wrapping, double the permutation table length\n        this.perm = new Array(512);\n        this.gradP = new Array(512);\n\n        this.seed(Date.now());\n    }\n\n    seed(seed) {\n        if(seed > 0 && seed < 1) {\n            // Scale the seed out\n            seed *= 65536;\n        }\n\n        seed = Math.floor(seed);\n        if(seed < 256) {\n            seed |= seed << 8;\n        }\n\n        for(var i = 0; i < 256; i++) {\n            var v;\n            if (i & 1) {\n                v = this.p[i] ^ (seed & 255);\n            } else {\n                v = this.p[i] ^ ((seed>>8) & 255);\n            }\n\n            this.perm[i] = this.perm[i + 256] = v;\n            this.gradP[i] = this.gradP[i + 256] = this.grad3[v % 12];\n        }\n    };\n\n    // 2D simplex noise\n    simplex2(xin, yin) {\n        // Skewing and unskewing factors for 2, 3, and 4 dimensions\n        var F2 = 0.5*(Math.sqrt(3)-1);\n        var G2 = (3-Math.sqrt(3))/6;\n\n        var F3 = 1/3;\n        var G3 = 1/6;\n\n        var n0, n1, n2; // Noise contributions from the three corners\n        // Skew the input space to determine which simplex cell we're in\n        var s = (xin+yin)*F2; // Hairy factor for 2D\n        var i = Math.floor(xin+s);\n        var j = Math.floor(yin+s);\n        var t = (i+j)*G2;\n        var x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\n        var y0 = yin-j+t;\n        // For the 2D case, the simplex shape is an equilateral triangle.\n        // Determine which simplex we are in.\n        var i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\n        if(x0>y0) { // lower triangle, XY order: (0,0)->(1,0)->(1,1)\n            i1=1; j1=0;\n        } else {    // upper triangle, YX order: (0,0)->(0,1)->(1,1)\n            i1=0; j1=1;\n        }\n        // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n        // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n        // c = (3-sqrt(3))/6\n        var x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n        var y1 = y0 - j1 + G2;\n        var x2 = x0 - 1 + 2 * G2; // Offsets for last corner in (x,y) unskewed coords\n        var y2 = y0 - 1 + 2 * G2;\n        // Work out the hashed gradient indices of the three simplex corners\n        i &= 255;\n        j &= 255;\n        var gi0 = this.gradP[i+this.perm[j]];\n        var gi1 = this.gradP[i+i1+this.perm[j+j1]];\n        var gi2 = this.gradP[i+1+this.perm[j+1]];\n        // Calculate the contribution from the three corners\n        var t0 = 0.5 - x0*x0-y0*y0;\n        if(t0<0) {\n            n0 = 0;\n        } else {\n            t0 *= t0;\n            n0 = t0 * t0 * gi0.dot2(x0, y0);  // (x,y) of grad3 used for 2D gradient\n        }\n        var t1 = 0.5 - x1*x1-y1*y1;\n        if(t1<0) {\n            n1 = 0;\n        } else {\n            t1 *= t1;\n            n1 = t1 * t1 * gi1.dot2(x1, y1);\n        }\n        var t2 = 0.5 - x2*x2-y2*y2;\n        if(t2<0) {\n            n2 = 0;\n        } else {\n            t2 *= t2;\n            n2 = t2 * t2 * gi2.dot2(x2, y2);\n        }\n        // Add contributions from each corner to get the final noise value.\n        // The result is scaled to return values in the interval [-1,1].\n        return 70 * (n0 + n1 + n2);\n    }\n    \n    simplex1(x){\n        return this.simplex2(x*1.2, -x*0.7);\n    }\n\n}\n\nconst singleton = new Noise();\nObject.freeze(singleton);\n\nexport default singleton;","import \"./math-extensions.js\";\n\nimport { AudioSystem } from \"./components/audio-system.js\";\nimport { Glottis } from \"./components/glottis.js\";\nimport { Tract } from \"./components/tract.js\";\nimport { TractUI } from \"./components/tract-ui.js\";\n\nclass Voice {\n    constructor(trombone, id) {\n        this.id = id;\n\n        this.glottis = new Glottis(trombone);\n        this.glottis.init();\n\n        this.tract = new Tract(trombone, this.glottis);\n        this.tract.init();\n\n        this.tractUI = new TractUI(trombone, this.tract);\n        this.tractUI.init();\n    }\n}\n\nclass PinkTrombone {\n    constructor(controller){\n        this.controller = controller;\n        \n        this.time = 0;\n        this.alwaysVoice = true;\n        this.autoWobble = true;\n        this.noiseFreq = 500;\n        this.noiseQ = 0.7;\n\n        this.voices = [];\n        for(let i = 0; i < 8; i++){\n            let voice = new Voice(this, i);\n            voice.glottis.loudness = i == 0 ? 1 : 0;\n            this.voices.push(voice);\n        }\n\n        this.audioSystem = new AudioSystem(this);\n        this.audioSystem.init();\n\n        //this.StartAudio();\n        //this.SetMute(true);\n\n        this.muted = false;\n    }\n\n    StartAudio() {\n        this.muted = false;\n        this.audioSystem.startSound();\n    }\n\n    SetMute(doMute) {\n        doMute ? this.audioSystem.mute() : this.audioSystem.unmute();\n        this.muted = doMute;\n    }\n\n    ToggleMute() {\n        this.SetMute(!this.muted);\n    }\n\n}\n\nexport { PinkTrombone, Voice };","// const words = require('cmu-pronouncing-dictionary');\n\nexport class TTSController {\n    constructor(){\n        \n    }\n\n    // GetGraphemes(str){\n    //     let zeroPunctuation = str.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g,\"\");\n    //     let wordBank = []\n    //     for(let word of zeroPunctuation.split(' ')){\n    //         wordBank.push(this.GetPronunciationForWord(word));\n    //     }\n    //     return wordBank;\n    // }\n\n    // GetPronunciationForWord(rawWord){\n    //     let word = rawWord.toLowerCase();\n    //     if (words[word]){\n    //         return words[word];\n    //     } else {\n    //         // If the word isn't in the dict, ignore it for now\n    //         return \"None\";\n    //     }\n    // }\n\n\n\n}","class ModelLoader {\n\n    /**\n     * Loads a model asynchronously. Expects an object containing\n     * the path to the object, the relative path of the OBJ file,\n     * and the relative path of the MTL file.\n     * \n     * An example:\n     * let modelInfo = {\n     *      path: \"../resources/obj/\",\n     *      objFile: \"test.obj\",\n     *      mtlFile: \"test.mtl\"\n     * }\n     */\n    static LoadOBJ(modelInfo, loadedCallback) {\n\n        var onProgress = function( xhr ) {\n            if ( xhr.lengthComputable ) {\n                var percentComplete = xhr.loaded / xhr.total * 100;\n                console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\n            }\n        };\n        var onError = function( xhr ) {\n        };\n\n        var mtlLoader = new THREE.MTLLoader();\n        mtlLoader.setPath( modelInfo.path );\n\n        mtlLoader.load( modelInfo.mtlFile, ( materials ) => {\n            materials.preload();\n            var objLoader = new THREE.OBJLoader();\n            objLoader.setMaterials( materials );\n            objLoader.setPath( modelInfo.path );\n            objLoader.load( modelInfo.objFile, ( object ) => {\n                loadedCallback(object);\n            }, onProgress, onError );\n            \n        });\n\n    }\n\n    static LoadJSON(path, loadedCallback) {\n\n        var onProgress = function( xhr ) {\n            if ( xhr.lengthComputable ) {\n                var percentComplete = xhr.loaded / xhr.total * 100;\n                console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\n            }\n        };\n        var onError = function( xhr ) {\n        };\n\n        var loader = new THREE.JSONLoader();\n        loader.load( path, ( geometry, materials ) => {\n            // Apply skinning to each material so the verts are affected by bone movement\n            for(let mat of materials){\n                mat.skinning = true;\n            }\n            let mesh = new THREE.SkinnedMesh( geometry, new THREE.MultiMaterial( materials ) );\n            mesh.name = \"Jon\";\n            loadedCallback(mesh);\n        }, onProgress, onError);\n    }\n\n    static LoadFBX(path, loadedCallback) {\n        let manager = new THREE.LoadingManager();\n        manager.onProgress = function( item, loaded, total ) {\n            console.log( item, loaded, total );\n        };\n\n        var onProgress = function( xhr ) {\n            if ( xhr.lengthComputable ) {\n                var percentComplete = xhr.loaded / xhr.total * 100;\n                console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\n            }\n        };\n        var onError = function( xhr ) {\n        };\n\n        var loader = new THREE.FBXLoader( manager );\n        loader.load( path, ( object ) => {\n            loadedCallback(object);\n        }, onProgress, onError );\n    }\n\n}\n\nexport { ModelLoader };","class StartOverlay {\n\n    constructor(container, audioContext) {\n        this.container = container\n\n        let overlay = document.createElement(\"div\")\n        this.container.appendChild(overlay)\n        overlay.style.cssText = `\n            width: 100%;\n            height: 100%;\n            text-align: center;\n            position: absolute;\n            left: 0;\n            top: 0;\n            display: block;\n            background-color: rgba(0, 0, 0, 0.5);\n        `\n\n        window.addEventListener('touchstart', () => {\n            // create empty buffer\n            var buffer = audioContext.createBuffer(1, 1, 22050)\n            var source = audioContext.createBufferSource()\n            source.buffer = buffer\n            // connect to output (your speakers)\n            source.connect(audioContext.destination)\n            // play the file\n            source.noteOn(0)\n            console.log(\"Unlocked iOS audio\")\n        }, false)\n\n    }\n\n}\n\nexport { StartOverlay }","class Detector {\n\n    //http://stackoverflow.com/questions/11871077/proper-way-to-detect-webgl-support\n    static HasWebGL() {\n        if (!!window.WebGLRenderingContext) {\n            var canvas = document.createElement(\"canvas\"),\n                    names = [\"webgl\", \"experimental-webgl\", \"moz-webgl\", \"webkit-3d\"],\n                context = false;\n\n            for(var i=0;i<4;i++) {\n                try {\n                    context = canvas.getContext(names[i]);\n                    if (context && typeof context.getParameter == \"function\") {\n                        // WebGL is enabled\n                        return true;\n                    }\n                } catch(e) {}\n            }\n\n            // WebGL is supported, but disabled\n            return false;\n        }\n        // WebGL not supported\n        return false;\n    }\n\n    static GetErrorHTML(message = null){\n        if(message == null){\n            message = `Your graphics card does not seem to support \n                        <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\">WebGL</a>. <br>\n                        Find out how to get it <a href=\"http://get.webgl.org/\">here</a>.`;\n        }\n        return `\n        <div class=\"no-webgl-support\">\n        <p style=\"text-align: center;\">${message}</p>\n        </div>\n        `\n    }\n\n}\n\nexport { Detector };"],"sourceRoot":""}